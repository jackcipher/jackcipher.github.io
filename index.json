[{"content":"åœ¨æ„å»ºåå°ç®¡ç†ç³»ç»Ÿæˆ–è¿ç»´å¹³å°æ—¶ï¼Œâ€œå®æ—¶æ—¥å¿—æŸ¥çœ‹â€æ˜¯ä¸€ä¸ªéå¸¸é«˜é¢‘çš„éœ€æ±‚ã€‚ä¼ ç»Ÿçš„åšæ³•å¾€å¾€æ˜¯å‰ç«¯é€šè¿‡Â setIntervalÂ æ¯éš”å‡ ç§’è½®è¯¢ä¸€æ¬¡æ¥å£ï¼Œè¿™ç§æ–¹å¼ä¸ä»…æ—¶æ•ˆæ€§å·®ï¼Œè€Œä¸”å¯¹æœåŠ¡å™¨é€ æˆäº†å¤§é‡æ— æ•ˆè¯·æ±‚ã€‚\nWebSockets è™½ç„¶æ˜¯å…¨åŒå·¥é€šä¿¡çš„æ ‡å‡†è§£å†³æ–¹æ¡ˆï¼Œä½†å¯¹äºâ€œæœåŠ¡å™¨åªç®¡å‘ï¼Œå‰ç«¯åªç®¡æ”¶â€çš„æ—¥å¿—åœºæ™¯æ¥è¯´ï¼Œæ˜¾å¾—è¿‡äºâ€œé‡â€äº†ï¼ˆéœ€è¦å¤„ç†å¿ƒè·³ã€æ¡æ‰‹åè®®ã€åŒå‘æ•°æ®å¸§ç­‰ï¼‰ã€‚\nä»Šå¤©æˆ‘ä»¬æ¥æ¢è®¨ä¸€ç§æ›´è½»é‡ã€æ›´ä¼˜é›…çš„æ–¹æ¡ˆï¼šServer-Sent Events (SSE)ï¼Œå¹¶ç»“åˆ Go çš„å¹¶å‘ç‰¹æ€§ï¼Œå®ç°ä¸€ä¸ªç”Ÿäº§çº§å¯ç”¨çš„æ—¥å¿—æ¨é€æœåŠ¡ã€‚\nä¸ºä»€ä¹ˆé€‰æ‹© SSE SSE æ˜¯åŸºäº HTTP åè®®çš„ä¸€ç§å•å‘é€šä¿¡æœºåˆ¶ã€‚ç›¸æ¯” WebSocketsï¼Œå®ƒæœ‰ä»¥ä¸‹æ˜¾è‘—ä¼˜åŠ¿ï¼š\nè½»é‡çº§ï¼šç›´æ¥ä½¿ç”¨ HTTP åè®®ï¼Œæ— é¡»é¢å¤–çš„æ¡æ‰‹åè®®å‡çº§ã€‚ æ–­çº¿é‡è¿ï¼šæµè§ˆå™¨åŸç”Ÿæ”¯æŒÂ EventSourceÂ APIï¼Œå†…ç½®äº†è‡ªåŠ¨é‡è¿æœºåˆ¶ã€‚ å¼€å‘ç®€å•ï¼šæœåŠ¡ç«¯åªéœ€è®¾ç½®Â Content-Type: text/event-streamï¼Œå‰ç«¯é›¶ä¾èµ–ã€‚ é˜²ç«å¢™å‹å¥½ï¼šå®Œå…¨å¤ç”¨æ ‡å‡†çš„ HTTP ç«¯å£ï¼ˆ80/443ï¼‰ã€‚ æ ¸å¿ƒæ¶æ„è®¾è®¡ ä¸ºäº†è§£è€¦â€œæ—¥å¿—ç”Ÿæˆè€…â€å’Œâ€œæ—¥å¿—æ¶ˆè´¹è€…ï¼ˆå‰ç«¯å®¢æˆ·ç«¯ï¼‰â€ï¼Œæˆ‘ä»¬é‡‡ç”¨Â Brokerï¼ˆä»£ç†äººï¼‰æ¨¡å¼ã€‚\nä¸‹é¢é€šè¿‡ä¸€ä¸ªæ—¶åºå›¾æ¥å±•ç¤ºæ•´ä¸ªæ•°æ®æµè½¬çš„è¿‡ç¨‹ï¼š\nsequenceDiagram participant Generator as Log Generator participant Broker as Broker (Go Channel) participant Client as Web Client (Browser) Note over Generator, Broker: 1. æ—¥å¿—ç”Ÿäº§é˜¶æ®µ loop Every 0.5-1.5s Generator-\u0026gt;\u0026gt;Broker: Send Log (Broadcast Chan) end Note over Broker, Client: 2. å¹¿æ’­å¤„ç†é˜¶æ®µ par Broadcast Loop Broker-\u0026gt;\u0026gt;Broker: Read from Broadcast Chan Broker-\u0026gt;\u0026gt;Broker: Save to History loop For Each Client Broker--\u0026gt;\u0026gt;Client: Try Send (Non-blocking) alt Channel Full Broker--xClient: Drop Message (Protect Server) else Channel Open Broker-\u0026gt;\u0026gt;Client: Send to Client Chan end end end Note over Client, Broker: 3. SSE æ¨é€é˜¶æ®µ Client-\u0026gt;\u0026gt;Broker: HTTP GET /events Broker--\u0026gt;\u0026gt;Client: Headers (text/event-stream) Broker--\u0026gt;\u0026gt;Client: Push History Logs loop Keep-Alive Broker-\u0026gt;\u0026gt;Client: Push Real-time Log (data: {...}) Client-\u0026gt;\u0026gt;Client: Parse JSON \u0026amp; Render DOM end 1. æ•°æ®ç»“æ„è®¾è®¡ æˆ‘ä»¬å®šä¹‰æ ¸å¿ƒçš„Â BrokerÂ ç»“æ„ä½“ï¼š\n1 2 3 4 5 6 type Broker struct { clients map[chan Log]struct{} // Set of all clients mutex sync.RWMutex // Protect clients map broadcast chan Log // Inbound log channel history []Log // Log cache for replay } è¿™é‡Œæœ‰ä¸€ä¸ªç»†èŠ‚ï¼šclientsÂ çš„ key æ˜¯Â chan Logã€‚è¿™æ„å‘³ç€æ¯ä¸ªè¿æ¥çš„å®¢æˆ·ç«¯éƒ½æœ‰ä¸€ä¸ªä¸“å±çš„ Go Channelï¼Œè¿™ä¸ºæˆ‘ä»¬åç»­å®ç°ç²¾ç»†åŒ–æ§åˆ¶å¥ å®šäº†åŸºç¡€ã€‚\n2. é¿å…â€œæ…¢æ¶ˆè´¹è€…â€é˜»å¡ç³»ç»Ÿ åœ¨å…¶å®ƒçš„å³æ—¶é€šè®¯å®ç°ä¸­ï¼Œæœ€å®¹æ˜“è¸©çš„å‘å°±æ˜¯ï¼šä¸€ä¸ªå¡é¡¿çš„å®¢æˆ·ç«¯å¯¼è‡´æ•´ä¸ªå¹¿æ’­è¿‡ç¨‹é˜»å¡ã€‚\nå¦‚æœç›´æ¥é€šè¿‡Â clientChan \u0026lt;- msgÂ å‘é€ï¼Œä¸€æ—¦æŸä¸ªå®¢æˆ·ç«¯ç½‘ç»œæ–­å¼€æˆ–è€…æ¥æ”¶ç¼“å†²æ»¡äº†ï¼Œæ•´ä¸ªÂ BrokerÂ çš„å¹¿æ’­å¾ªç¯å°±ä¼šå¡æ­»åœ¨è¿™é‡Œï¼Œå¯¼è‡´æ‰€æœ‰äººéƒ½æ”¶ä¸åˆ°æ—¥å¿—ã€‚\nè§£å†³æ–¹æ¡ˆæ˜¯åˆ©ç”¨ Go çš„Â selectÂ +Â defaultÂ ç‰¹æ€§ï¼Œé€»è¾‘å¦‚ä¸‹ï¼š\ngraph TB Start([æ–°æ—¥å¿—æ¶ˆæ¯åˆ°è¾¾]) --\u0026gt; Iterate[éå†æ‰€æœ‰å®¢æˆ·ç«¯] Iterate --\u0026gt; CheckChannel{Channel æ˜¯å¦å·²æ»¡?} CheckChannel --\u0026gt;|å¦\u0026lt;br/\u0026gt;æœ‰ç©ºé—´| SendSuccess[âœ“ å‘é€æ¶ˆæ¯æˆåŠŸ\u0026lt;br/\u0026gt;clientChan â† msg] CheckChannel --\u0026gt;|æ˜¯\u0026lt;br/\u0026gt;ç¼“å†²åŒºæ»¡| DropMsg[âœ— ä¸¢å¼ƒæ¶ˆæ¯\u0026lt;br/\u0026gt;default åˆ†æ”¯] SendSuccess --\u0026gt; HasMore{è¿˜æœ‰å…¶ä»–å®¢æˆ·ç«¯?} DropMsg --\u0026gt; HasMore HasMore --\u0026gt;|æ˜¯| Iterate HasMore --\u0026gt;|å¦| End([å¹¿æ’­å®Œæˆ]) style Start fill:#e1f5ff,stroke:#0288d1,stroke-width:2px style End fill:#e1f5ff,stroke:#0288d1,stroke-width:2px style SendSuccess fill:#c8e6c9,stroke:#388e3c,stroke-width:2px style DropMsg fill:#ffcdd2,stroke:#d32f2f,stroke-width:2px style CheckChannel fill:#fff9c4,stroke:#f57c00,stroke-width:2px style Iterate fill:#f3e5f5,stroke:#7b1fa2,stroke-width:2px æ ¸å¿ƒä»£ç å®ç°ï¼š\n1 2 3 4 5 6 7 8 9 10 11 // å¹¿æ’­é€»è¾‘ for clientChan := range b.clients { select { case clientChan \u0026lt;- msg: // å‘é€æˆåŠŸ default: // å…³é”®é€»è¾‘ï¼ // å¦‚æœ clientChan æ»¡äº†ï¼ˆå®¢æˆ·ç«¯ç”±äºç½‘ç»œåŸå› è¯»ä¸è¿‡æ¥ï¼‰ï¼Œ // æˆ‘ä»¬é€‰æ‹©ç›´æ¥è·³è¿‡ï¼ˆDropï¼‰è¿™æ¡æ¶ˆæ¯ï¼Œè€Œä¸æ˜¯é˜»å¡æ•´ä¸ªç³»ç»Ÿã€‚ } } è¿™ç§éé˜»å¡å¼å¹¿æ’­çš„è®¾è®¡ï¼Œä¿è¯äº†æœåŠ¡çš„é«˜å¯ç”¨æ€§ã€‚\næ ¸å¿ƒä»£ç è§£æ å¯åŠ¨ HTTP æœåŠ¡ åœ¨ Gin ä¸­å®ç° SSE éå¸¸ç®€å•ã€‚é‡ç‚¹åœ¨äº HTTP Header çš„è®¾ç½®å’Œ Response çš„ Flushã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 func (b *Broker) ServeHTTP(c *gin.Context) { // 1. è®¾ç½® SSE å¿…å¤‡çš„ Headers c.Writer.Header().Set(\u0026#34;Content-Type\u0026#34;, \u0026#34;text/event-stream\u0026#34;) c.Writer.Header().Set(\u0026#34;Cache-Control\u0026#34;, \u0026#34;no-cache\u0026#34;) c.Writer.Header().Set(\u0026#34;Connection\u0026#34;, \u0026#34;keep-alive\u0026#34;) // ... (çœç•¥éƒ¨åˆ†ä»£ç ) // 6. å®æ—¶æ¨é€å¾ªç¯ for { select { case msg := \u0026lt;-clientChan: // æ ¼å¼åŒ–ä¸º SSE è¦æ±‚çš„ data: ...\\n\\n æ ¼å¼ c.Writer.Write([]byte(fmt.Sprintf(\u0026#34;data: %s\\n\\n\u0026#34;, msg.String()))) c.Writer.Flush() // å¿…é¡» Flushï¼Œå¦åˆ™æ•°æ®ä¼šç§¯å‹åœ¨ç¼“å†²åŒº case \u0026lt;-c.Request.Context().Done(): return } } } JSON åºåˆ—åŒ–çš„ä¼˜åŒ– åœ¨å®æˆ˜ä¸­ï¼Œæˆ‘ä»¬å‘ç°é¢‘ç¹çš„Â json.MarshalÂ å¯èƒ½ä¼šæˆä¸º CPU çƒ­ç‚¹ã€‚æˆ‘ä»¬å¯ä»¥ç»™Â LogÂ ç»“æ„ä½“é¢„å®šä¹‰ä¸€ä¸ªÂ 1 2 3 4 5 func (l Log) String() string { // ç®€å•åœºæ™¯ä¹Ÿå¯ç”¨ strings.Builder æ‰‹åŠ¨æ‹¼æ¥ï¼Œæ€§èƒ½æ›´æè‡´ bts, _ := json.Marshal(l) return string(bts) } å‰ç«¯å®ç° å¾—ç›Šäº EventSourceï¼Œå‰ç«¯ä»£ç æå…¶ç®€æ´ï¼š\n1 2 3 4 5 6 const evtSource = new EventSource(\u0026#34;/events\u0026#34;); evtSource.onmessage = function(event) { const log = JSON.parse(event.data); appendLog(log); }; ","permalink":"https://jackcipher.github.io/go-in-action/sse-log-stream/","summary":"\u003cp\u003eåœ¨æ„å»ºåå°ç®¡ç†ç³»ç»Ÿæˆ–è¿ç»´å¹³å°æ—¶ï¼Œâ€œå®æ—¶æ—¥å¿—æŸ¥çœ‹â€æ˜¯ä¸€ä¸ªéå¸¸é«˜é¢‘çš„éœ€æ±‚ã€‚ä¼ ç»Ÿçš„åšæ³•å¾€å¾€æ˜¯å‰ç«¯é€šè¿‡Â \u003ccode\u003esetInterval\u003c/code\u003eÂ æ¯éš”å‡ ç§’è½®è¯¢ä¸€æ¬¡æ¥å£ï¼Œè¿™ç§æ–¹å¼ä¸ä»…æ—¶æ•ˆæ€§å·®ï¼Œè€Œä¸”å¯¹æœåŠ¡å™¨é€ æˆäº†å¤§é‡æ— æ•ˆè¯·æ±‚ã€‚\u003c/p\u003e","title":"Go çš„ SSE å®æ—¶æ—¥å¿—æ–¹æ¡ˆ"},{"content":"ç”¨ Obsidian ç”» Mermaid å›¾è¡¨çš„äººå¾ˆå¤šï¼Œä½†çŸ¥é“å¯ä»¥å•ç‹¬ç»™æ¯ä¸ªå›¾è¡¨è®¾ç½®ä¸»é¢˜çš„äººå¾ˆå°‘ã€‚\nä¸éœ€è¦æ’ä»¶ï¼Œä¸éœ€è¦å†™ CSSï¼Œåªè¦åœ¨ä»£ç å—å¼€å¤´åŠ ä¸€è¡Œé…ç½®ï¼Œå°±èƒ½è®©åŒä¸€ç¯‡ç¬”è®°é‡Œçš„ä¸åŒå›¾è¡¨å‘ˆç°å®Œå…¨ä¸åŒçš„é£æ ¼ã€‚\nè¿™ä¸ªåŠŸèƒ½å« Directivesï¼ˆé…ç½®æŒ‡ä»¤ï¼‰ï¼Œæ˜¯ Mermaid çš„åŸç”Ÿèƒ½åŠ›ï¼ŒObsidian å®Œç¾æ”¯æŒã€‚\nåŸºç¡€ç”¨æ³•ï¼šä¸€é”®åˆ‡æ¢ä¸»é¢˜ Mermaid å†…ç½® 5 ä¸ªä¸»é¢˜ï¼š\nä¸»é¢˜ é£æ ¼ default ç»å…¸è“è‰² neutral é»‘ç™½ç°ï¼Œé€‚åˆæ‰“å° dark æ·±è‰²æ¨¡å¼ forest æ¸…æ–°ç»¿è‰² base å¯å®Œå…¨è‡ªå®šä¹‰ åœ¨ä»£ç å—ç¬¬ä¸€è¡ŒåŠ ä¸Šé…ç½®æŒ‡ä»¤å³å¯ï¼š\n%%{init: {\u0026#39;theme\u0026#39;: \u0026#39;forest\u0026#39;}}%% graph TD A[å¼€å§‹] --\u0026gt; B{æ˜¯å¦æ»¡æ„?} B --\u0026gt;|æ˜¯| C[å®Œæˆ] B --\u0026gt;|å¦| D[è°ƒæ•´ä¸»é¢˜] æŠŠ forest æ¢æˆå…¶ä»–ä¸»é¢˜åï¼Œç«‹åˆ»ç”Ÿæ•ˆã€‚\nè¿›é˜¶ç”¨æ³•ï¼šè‡ªå®šä¹‰é…è‰² âš ï¸ åªæœ‰ base ä¸»é¢˜æ”¯æŒè‡ªå®šä¹‰é¢œè‰²ï¼Œå…¶ä»–ä¸»é¢˜æ˜¯é¢„è®¾çš„ã€‚ é€šè¿‡ themeVariables å¯ä»¥ç²¾ç¡®æ§åˆ¶æ¯ä¸€ç§é¢œè‰²ï¼š\n%%{ init: { \u0026#39;theme\u0026#39;: \u0026#39;base\u0026#39;, \u0026#39;themeVariables\u0026#39;: { \u0026#39;primaryColor\u0026#39;: \u0026#39;#ffcc00\u0026#39;, \u0026#39;primaryTextColor\u0026#39;: \u0026#39;#333\u0026#39;, \u0026#39;primaryBorderColor\u0026#39;: \u0026#39;#333\u0026#39;, \u0026#39;lineColor\u0026#39;: \u0026#39;#ff6b6b\u0026#39; } } }%% graph LR A[è‡ªå®šä¹‰é»„è‰²èŠ‚ç‚¹] --\u0026gt; B[çº¢è‰²è¿çº¿] æ ¸å¿ƒå˜é‡ä¸€è§ˆ å˜é‡ ä½œç”¨ primaryColor ä¸»è¦èŠ‚ç‚¹èƒŒæ™¯è‰² primaryTextColor ä¸»è¦èŠ‚ç‚¹æ–‡å­—é¢œè‰² primaryBorderColor ä¸»è¦èŠ‚ç‚¹è¾¹æ¡†é¢œè‰² secondaryColor æ¬¡è¦å…ƒç´ é¢œè‰² tertiaryColor ç¬¬ä¸‰çº§å…ƒç´ é¢œè‰² lineColor è¿çº¿é¢œè‰² background èƒŒæ™¯è‰² fontFamily å­—ä½“ âœ¨ å¤§éƒ¨åˆ†é¢œè‰²å˜é‡ä¼šè‡ªåŠ¨ä» primaryColor æ´¾ç”Ÿï¼Œé€šå¸¸åªéœ€è®¾ç½®å‡ ä¸ªå…³é”®å˜é‡å³å¯ã€‚ æ·±è‰²æ¨¡å¼é€‚é… å¦‚æœä½ ç”¨æ·±è‰²ä¸»é¢˜ï¼Œå¯ç”¨ darkMode è®© Mermaid è‡ªåŠ¨è°ƒæ•´å¯¹æ¯”åº¦ï¼š\n%%{ init: { \u0026#39;theme\u0026#39;: \u0026#39;base\u0026#39;, \u0026#39;themeVariables\u0026#39;: { \u0026#39;darkMode\u0026#39;: true, \u0026#39;primaryColor\u0026#39;: \u0026#39;#1e40af\u0026#39;, \u0026#39;primaryTextColor\u0026#39;: \u0026#39;#e0e7ff\u0026#39;, \u0026#39;lineColor\u0026#39;: \u0026#39;#60a5fa\u0026#39;, \u0026#39;background\u0026#39;: \u0026#39;#1e1e1e\u0026#39; } } }%% graph TD A[æ·±è‰²ä¸»é¢˜] --\u0026gt; B[è‡ªåŠ¨è®¡ç®—å¯¹æ¯”åº¦] B --\u0026gt; C[é˜…è¯»æ›´èˆ’é€‚] å›¾è¡¨ç±»å‹ä¸“å±å˜é‡ ä¸åŒç±»å‹çš„å›¾è¡¨æœ‰å„è‡ªçš„ä¸“å±å˜é‡ã€‚\næµç¨‹å›¾ %%{ init: { \u0026#39;theme\u0026#39;: \u0026#39;base\u0026#39;, \u0026#39;themeVariables\u0026#39;: { \u0026#39;primaryColor\u0026#39;: \u0026#39;#e3f2fd\u0026#39;, \u0026#39;clusterBkg\u0026#39;: \u0026#39;#fff3e0\u0026#39;, \u0026#39;clusterBorder\u0026#39;: \u0026#39;#ff9800\u0026#39; } } }%% graph TD subgraph å­å›¾åŒºåŸŸ A[èŠ‚ç‚¹A] --\u0026gt; B[èŠ‚ç‚¹B] end B --\u0026gt; C[èŠ‚ç‚¹C] å˜é‡ ä½œç”¨ clusterBkg å­å›¾èƒŒæ™¯è‰² clusterBorder å­å›¾è¾¹æ¡†è‰² defaultLinkColor è¿çº¿é¢œè‰² edgeLabelBackground è¿çº¿æ ‡ç­¾èƒŒæ™¯è‰² æ—¶åºå›¾ %%{ init: { \u0026#39;theme\u0026#39;: \u0026#39;base\u0026#39;, \u0026#39;themeVariables\u0026#39;: { \u0026#39;actorBkg\u0026#39;: \u0026#39;#e8f5e9\u0026#39;, \u0026#39;actorBorder\u0026#39;: \u0026#39;#4caf50\u0026#39;, \u0026#39;signalColor\u0026#39;: \u0026#39;#ff5722\u0026#39;, \u0026#39;activationBkgColor\u0026#39;: \u0026#39;#fff3e0\u0026#39; } } }%% sequenceDiagram participant A as ç”¨æˆ· participant B as ç³»ç»Ÿ A-\u0026gt;\u0026gt;B: å‘é€è¯·æ±‚ activate B B--\u0026gt;\u0026gt;A: è¿”å›ç»“æœ deactivate B å˜é‡ ä½œç”¨ actorBkg / actorBorder è§’è‰²æ¡†æ ·å¼ signalColor / signalTextColor ä¿¡å·çº¿æ ·å¼ activationBkgColor / activationBorderColor æ¿€æ´»æ¡†æ ·å¼ é¥¼å›¾ %%{ init: { \u0026#39;theme\u0026#39;: \u0026#39;base\u0026#39;, \u0026#39;themeVariables\u0026#39;: { \u0026#39;pie1\u0026#39;: \u0026#39;#ff6b6b\u0026#39;, \u0026#39;pie2\u0026#39;: \u0026#39;#4ecdc4\u0026#39;, \u0026#39;pie3\u0026#39;: \u0026#39;#45b7d1\u0026#39;, \u0026#39;pie4\u0026#39;: \u0026#39;#ffa07a\u0026#39; } } }%% pie title é¡¹ç›®åˆ†å¸ƒ \u0026#34;é¡¹ç›®A\u0026#34; : 35 \u0026#34;é¡¹ç›®B\u0026#34; : 25 \u0026#34;é¡¹ç›®C\u0026#34; : 20 \u0026#34;é¡¹ç›®D\u0026#34; : 20 å˜é‡ ä½œç”¨ pie1 ~ pie12 æ¯ä¸ªæ‰‡å½¢çš„é¢œè‰² pieTitleTextSize / pieTitleTextColor æ ‡é¢˜æ ·å¼ pieStrokeColor / pieStrokeWidth æ‰‡å½¢è¾¹æ¡† æ¨èé…è‰²æ–¹æ¡ˆ æ¸…æ–°å•†åŠ¡é£ 1 2 3 4 5 6 \u0026#39;primaryColor\u0026#39;: \u0026#39;#e3f2fd\u0026#39;, \u0026#39;primaryTextColor\u0026#39;: \u0026#39;#1565c0\u0026#39;, \u0026#39;primaryBorderColor\u0026#39;: \u0026#39;#1976d2\u0026#39;, \u0026#39;lineColor\u0026#39;: \u0026#39;#42a5fa\u0026#39;, \u0026#39;secondaryColor\u0026#39;: \u0026#39;#f3e5f5\u0026#39;, \u0026#39;tertiaryColor\u0026#39;: \u0026#39;#fff3e0\u0026#39; %%{ init: { \u0026#39;theme\u0026#39;: \u0026#39;base\u0026#39;, \u0026#39;themeVariables\u0026#39;: { \u0026#39;primaryColor\u0026#39;: \u0026#39;#e3f2fd\u0026#39;, \u0026#39;primaryTextColor\u0026#39;: \u0026#39;#1565c0\u0026#39;, \u0026#39;primaryBorderColor\u0026#39;: \u0026#39;#1976d2\u0026#39;, \u0026#39;lineColor\u0026#39;: \u0026#39;#42a5f5\u0026#39;, \u0026#39;secondaryColor\u0026#39;: \u0026#39;#f3e5f5\u0026#39;, \u0026#39;tertiaryColor\u0026#39;: \u0026#39;#fff3e0\u0026#39; } } }%% graph LR A[éœ€æ±‚åˆ†æ] --\u0026gt; B[æ–¹æ¡ˆè®¾è®¡] B --\u0026gt; C[å¼€å‘å®ç°] C --\u0026gt; D[æµ‹è¯•éªŒæ”¶] æ¸©æš–æ©™è‰²è°ƒ 1 2 3 4 5 \u0026#39;primaryColor\u0026#39;: \u0026#39;#fff4e6\u0026#39;, \u0026#39;primaryTextColor\u0026#39;: \u0026#39;#d84315\u0026#39;, \u0026#39;primaryBorderColor\u0026#39;: \u0026#39;#f57c00\u0026#39;, \u0026#39;lineColor\u0026#39;: \u0026#39;#ff6f00\u0026#39;, \u0026#39;secondaryColor\u0026#39;: \u0026#39;#ffe0b2\u0026#39; %%{ init: { \u0026#39;theme\u0026#39;: \u0026#39;base\u0026#39;, \u0026#39;themeVariables\u0026#39;: { \u0026#39;primaryColor\u0026#39;: \u0026#39;#fff4e6\u0026#39;, \u0026#39;primaryTextColor\u0026#39;: \u0026#39;#d84315\u0026#39;, \u0026#39;primaryBorderColor\u0026#39;: \u0026#39;#f57c00\u0026#39;, \u0026#39;lineColor\u0026#39;: \u0026#39;#ff6f00\u0026#39;, \u0026#39;secondaryColor\u0026#39;: \u0026#39;#ffe0b2\u0026#39; } } }%% graph LR A[åˆ›æ„] --\u0026gt; B[æ‰§è¡Œ] B --\u0026gt; C[è¿­ä»£] C --\u0026gt; D[äº¤ä»˜] æ³¨æ„äº‹é¡¹ ğŸ“ é¢œè‰²æ ¼å¼å¿…é¡»æ˜¯åå…­è¿›åˆ¶ï¼šç”¨ #ff0000 è€Œä¸æ˜¯ red é…ç½®å¿…é¡»æ”¾åœ¨ç¬¬ä¸€è¡Œï¼šå¦åˆ™ä¸ä¼šç”Ÿæ•ˆ JSON æ ¼å¼è¦æ­£ç¡®ï¼šæ³¨æ„å¼•å·å’Œé€—å· ","permalink":"https://jackcipher.github.io/posts/obsidian-mermaid-theme/","summary":"\u003cp\u003eç”¨ Obsidian ç”» Mermaid å›¾è¡¨çš„äººå¾ˆå¤šï¼Œä½†çŸ¥é“å¯ä»¥\u003cstrong\u003eå•ç‹¬ç»™æ¯ä¸ªå›¾è¡¨è®¾ç½®ä¸»é¢˜\u003c/strong\u003eçš„äººå¾ˆå°‘ã€‚\u003c/p\u003e\n\u003cp\u003eä¸éœ€è¦æ’ä»¶ï¼Œä¸éœ€è¦å†™ CSSï¼Œåªè¦åœ¨ä»£ç å—å¼€å¤´åŠ ä¸€è¡Œé…ç½®ï¼Œå°±èƒ½è®©åŒä¸€ç¯‡ç¬”è®°é‡Œçš„ä¸åŒå›¾è¡¨å‘ˆç°å®Œå…¨ä¸åŒçš„é£æ ¼ã€‚\u003c/p\u003e","title":"Obsidian å¦‚ä½•è®¾ç½® Mermaid ä¸»é¢˜"},{"content":"Shottr æ˜¯ä¸€æ¬¾åŠŸèƒ½å¼ºå¤§çš„ macOS æˆªå›¾è½¯ä»¶ï¼Œè™½ç„¶åŸºç¡€åŠŸèƒ½å…è´¹ï¼Œä½†è®¸å¤šå®ç”¨çš„é«˜çº§åŠŸèƒ½ï¼ˆå¦‚ backdrop èƒŒæ™¯è™šåŒ–ç­‰ï¼‰éœ€è¦ä»˜è´¹ä½¿ç”¨ã€‚\næ¿€æ´»åŸç† é€šè¿‡ Charles æŠ“åŒ…å‘ç°ï¼Œæ¯å½“åœ¨ Shottr é‡Œçš„ \u0026ldquo;License\u0026rdquo; ç•Œé¢è¿›è¡Œæ¿€æ´»æ—¶ï¼ŒApp éƒ½ä¼šå‘ shottr.cc å‘é€ä¸€ä¸ª POST è¯·æ±‚æ¥éªŒè¯æ¿€æ´»ç çš„æœ‰æ•ˆæ€§ã€‚\né€šè¿‡æŠ“åŒ…åˆ†æï¼Œä¸éš¾å‘ç°ï¼š\næ¿€æ´»éªŒè¯çš„ API ç«¯ç‚¹ä¸ºï¼šhttps://shottr.cc/licensing/verify.php æœåŠ¡å™¨è¿”å›çš„ JSON å“åº”ä¸­åŒ…å«ä¸€ä¸ªå…³é”®å­—æ®µ tier å½“ tier ä¸º 0 æ—¶è¡¨ç¤ºæœªæ¿€æ´» æ—¢ç„¶ 0 è¡¨ç¤ºæœªæ¿€æ´»ï¼Œé‚£è®¾ç½®ä¸º 1 æ˜¯ä¸æ˜¯å°±èƒ½æ¿€æ´»å‘¢ï¼Ÿ\nåŸºäºè¿™ä¸ªåŸç†ï¼Œåªéœ€è¦æ‹¦æˆªè¿™ä¸ª API è¯·æ±‚ï¼Œå¹¶è¿”å›ä¸€ä¸ªåŒ…å« \u0026quot;tier\u0026quot;: \u0026quot;1\u0026quot; çš„è™šå‡å“åº”å³å¯å®ç°æ¿€æ´»ã€‚\né€šè¿‡ Charles æ¿€æ´» é€šè¿‡ Charles å†…ç½®çš„ Map Local åŠŸèƒ½ï¼Œå°†æ¥å£è¿”å›æ•°æ®æ˜ å°„åˆ°æœ¬åœ°çš„æ–‡æœ¬æ–‡ä»¶ã€‚\nåœ¨ home ç›®å½•ï¼Œå‡†å¤‡ä»¥ä¸‹æ–‡ä»¶\n1 2 3 4 5 6 7 8 9 âœ .shottr pwd /Users/jack/.shottr âœ .shottr cat verify.txt { \u0026#34;tier\u0026#34;: \u0026#34;1\u0026#34;, \u0026#34;explanation\u0026#34;: \u0026#34;\u0026#34;, \u0026#34;hash\u0026#34;: \u0026#34;123059245fec1e5a71fbab509b6052f9c1cf6a9d08780c11f0f7aafd56c2f757b42\u0026#34; } âœ .shottr æ‰“å¼€ Charles çš„ Map Local åŠŸèƒ½ï¼Œé€‰ä¸­è¯·æ±‚çš„æ¥å£ï¼Œå¹¶å°†æ¥å£æ˜ å°„åˆ°æœ¬åœ°æ–‡æœ¬æ–‡ä»¶ã€‚è¿™æ˜¯å‘Šè¯‰ Charles å¦‚æœæ£€æµ‹åˆ°è¯¥æ¥å£çš„è¯·æ±‚ï¼Œå°±ç¯¡æ”¹è¿”å›çš„æ¶ˆæ¯ä½“ï¼Œä½¿ç”¨æœ¬åœ°çš„æ–‡æœ¬å†…å®¹ã€‚ å¼€å¯è¯¥åŠŸèƒ½åï¼Œé‡å¯ Shottrï¼Œåœ¨ License ä¸­è¾“å…¥ä»»æ„å­—ç¬¦ä¸²ï¼Œç‚¹å‡»æ¿€æ´»ï¼š é€šè¿‡æŠ“åŒ…å‘ç°ï¼Œé€šè¿‡å°† \u0026ldquo;tier\u0026rdquo; è®¾ä¸º1ï¼ŒçœŸçš„å¯ä»¥æ¿€æ´» Shottrã€‚åœ¨è½¯ä»¶ä¸­ä¹Ÿæ˜¯æ˜¾ç¤º \u0026ldquo;Thank you for activating Shottr!\u0026rdquo;.\né€šè¿‡ mitmproxy æ¿€æ´» è‡³æ­¤ï¼ŒShottr çš„æ¿€æ´»åŸç†å·²ç»çŸ¥é“äº†ã€‚å°±æ˜¯æœ‰ä¸€ä¸ªé—®é¢˜ï¼Œæ¯æ¬¡æ‰“å¼€ç”µè„‘ï¼Œæˆ–è€…é€€å‡ºäº† Shottrï¼Œæ¿€æ´»æ—¶éƒ½éœ€è¦æ‰“å¼€ Charlesï¼Œè¿™ä¸ªæ“ä½œæ¯”è¾ƒé‡ï¼Œæˆ‘ä¸æƒ³ä¸ºäº†ä¸€ç¢Ÿé†‹åŒ…äº†ä¸€ç›˜é¥ºå­ã€‚æœ‰æ²¡æœ‰ä»€ä¹ˆåŠæ³•ï¼Œåœ¨ä¸æ‰“å¼€ Charles å°±èƒ½æŠŠ Shottr ç»™æ¿€æ´»äº†å‘¢ï¼Ÿ\nè°ƒç ”äº†ä¸€ç•ªï¼Œå‘ç°æ–¹æ¡ˆè¿˜çœŸçš„æœ‰ã€‚é‚£å°±æ˜¯ä½¿ç”¨ mitmproxy.mitmproxy æœ‰ä¸‰ä¸ªç»„ä»¶åˆ†åˆ«æ˜¯,mitmproxy,mitmweb,mitmdump.æˆ‘ä»¬è¿™æ¬¡å°±æ˜¯è¦ä½¿ç”¨ mitmdump æ¥è¿›è¡Œæµé‡åŠ«æŒã€‚\nå®‰è£… mitmproxy åœ¨ macOS ä¸Šï¼Œæ¨èä½¿ç”¨ Homebrew å®‰è£…ï¼š\n1 brew install mitmproxy å®‰è£…å®Œæˆåï¼Œä½ å°†è·å¾—ä¸‰ä¸ªä¸»è¦ç»„ä»¶ï¼š\nmitmproxyï¼šäº¤äº’å¼æ§åˆ¶å°ç•Œé¢ mitmwebï¼šWeb ç•Œé¢ mitmdumpï¼šå‘½ä»¤è¡Œå·¥å…·ï¼ˆæˆ‘ä»¬ä¸»è¦ä½¿ç”¨è¿™ä¸ªï¼‰ è®¾ç½®ç³»ç»Ÿä»£ç† å¯åŠ¨ mitmproxyï¼š\n1 mitmproxy é»˜è®¤æƒ…å†µä¸‹ï¼Œmitmproxy ç›‘å¬ 8080 ç«¯å£ã€‚ç°åœ¨éœ€è¦é…ç½®ç³»ç»Ÿä»£ç†ï¼š\næ‰“å¼€ \u0026ldquo;ç³»ç»Ÿåå¥½è®¾ç½®\u0026rdquo; â†’ \u0026ldquo;ç½‘ç»œ\u0026rdquo; é€‰æ‹©å½“å‰ä½¿ç”¨çš„ç½‘ç»œè¿æ¥ ç‚¹å‡» \u0026ldquo;é«˜çº§\u0026hellip;\u0026rdquo; â†’ \u0026ldquo;ä»£ç†\u0026rdquo; å‹¾é€‰ \u0026ldquo;HTTP ä»£ç†\u0026rdquo; å’Œ \u0026ldquo;HTTPS ä»£ç†\u0026rdquo; å°†æœåŠ¡å™¨åœ°å€è®¾ç½®ä¸º 127.0.0.1ï¼Œç«¯å£è®¾ç½®ä¸º 8080 å®‰è£… SSL è¯ä¹¦ ä¸ºäº†æ‹¦æˆª HTTPS æµé‡ï¼Œéœ€è¦å®‰è£… mitmproxy çš„æ ¹è¯ä¹¦ï¼š\nåœ¨æµè§ˆå™¨ä¸­è®¿é—® mitm.it ç‚¹å‡» \u0026ldquo;Get mitmproxy-ca-cert.pem\u0026rdquo; ä¸‹è½½è¯ä¹¦ åŒå‡»ä¸‹è½½çš„ .pem æ–‡ä»¶ï¼Œå°†å…¶æ·»åŠ åˆ°é’¥åŒ™ä¸² åœ¨é’¥åŒ™ä¸²è®¿é—®ä¸­æ‰¾åˆ° \u0026ldquo;mitmproxy\u0026rdquo; è¯ä¹¦ åŒå‡»è¯ä¹¦ï¼Œå±•å¼€ \u0026ldquo;ä¿¡ä»»\u0026rdquo; é€‰é¡¹ å°† \u0026ldquo;ä½¿ç”¨æ­¤è¯ä¹¦æ—¶\u0026rdquo; è®¾ç½®ä¸º \u0026ldquo;å§‹ç»ˆä¿¡ä»»\u0026rdquo; åˆ›å»ºæ‹¦æˆªè„šæœ¬ åˆ›å»ºä¸€ä¸ªåä¸º verify.py çš„ Python è„šæœ¬ï¼Œç”¨äºç²¾å‡†æ§åˆ¶ mitmproxy æµé‡ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 from mitmproxy import http def request(flow: http.HTTPFlow) -\u0026gt; None: if flow.request.pretty_url == \u0026#34;https://shottr.cc/licensing/verify.php\u0026#34;: flow.response = http.Response.make( 200, # status code b\u0026#39;\u0026#39;\u0026#39;{ \u0026#34;tier\u0026#34;: \u0026#34;1\u0026#34;, \u0026#34;explanation\u0026#34;: \u0026#34;\u0026#34;, \u0026#34;hash\u0026#34;: \u0026#34;123059245fec1e5a71fbab509b6052f9c1cf6a9d08780c11f0f7aafd56c2f757b42\u0026#34; }\u0026#39;\u0026#39;\u0026#39;, {\u0026#34;Content-Type\u0026#34;: \u0026#34;application/json\u0026#34;} ) å¯åŠ¨åå°ç ´è§£ ä¸ºäº†æ–¹ä¾¿ç®¡ç†ï¼Œåˆ›å»ºä¸€ä¸ªå¯åŠ¨è„šæœ¬ start.sh\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 #!/bin/bash SCRIPT_DIR=\u0026#34;$(cd \u0026#34;$(dirname \u0026#34;${BASH_SOURCE[0]}\u0026#34;)\u0026#34; \u0026amp;\u0026amp; pwd)\u0026#34; SCRIPT=\u0026#34;$SCRIPT_DIR/shottr_crack.py\u0026#34; LOGFILE=\u0026#34;$SCRIPT_DIR/mitmdump.log\u0026#34; PIDFILE=\u0026#34;$SCRIPT_DIR/mitmdump.pid\u0026#34; # æ£€æŸ¥æ˜¯å¦å·²ç»è¿è¡Œ if [ -f \u0026#34;$PIDFILE\u0026#34; ] \u0026amp;\u0026amp; kill -0 $(cat \u0026#34;$PIDFILE\u0026#34;) 2\u0026gt;/dev/null; then echo \u0026#34;âŒ mitmproxy å·²åœ¨è¿è¡Œä¸­ (PID: $(cat $PIDFILE))\u0026#34; exit 1 fi # å¯åŠ¨ mitmdump echo \u0026#34;ğŸš€ æ­£åœ¨å¯åŠ¨ Shottr ç ´è§£æœåŠ¡...\u0026#34; nohup mitmdump -s \u0026#34;$SCRIPT\u0026#34; --listen-port 8080 \u0026gt; \u0026#34;$LOGFILE\u0026#34; 2\u0026gt;\u0026amp;1 \u0026amp; # ä¿å­˜è¿›ç¨‹ ID echo $! \u0026gt; \u0026#34;$PIDFILE\u0026#34; echo \u0026#34;âœ… æœåŠ¡å·²å¯åŠ¨ (PID: $(cat $PIDFILE))\u0026#34; echo \u0026#34;ğŸ“ æ—¥å¿—æ–‡ä»¶: $LOGFILE\u0026#34; echo \u0026#34;ğŸ”§ è¯·ç¡®ä¿ç³»ç»Ÿä»£ç†å·²è®¾ç½®ä¸º 127.0.0.1:8080\u0026#34; åˆ›å»ºåœæ­¢è„šæœ¬ stop.shï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 #!/bin/bash SCRIPT_DIR=\u0026#34;$(cd \u0026#34;$(dirname \u0026#34;${BASH_SOURCE[0]}\u0026#34;)\u0026#34; \u0026amp;\u0026amp; pwd)\u0026#34; PIDFILE=\u0026#34;$SCRIPT_DIR/mitmdump.pid\u0026#34; if [ -f \u0026#34;$PIDFILE\u0026#34; ]; then PID=$(cat \u0026#34;$PIDFILE\u0026#34;) if kill -0 \u0026#34;$PID\u0026#34; 2\u0026gt;/dev/null; then kill \u0026#34;$PID\u0026#34; rm \u0026#34;$PIDFILE\u0026#34; echo \u0026#34;âœ… Shottr ç ´è§£æœåŠ¡å·²åœæ­¢\u0026#34; else echo \u0026#34;âŒ è¿›ç¨‹ä¸å­˜åœ¨\u0026#34; rm \u0026#34;$PIDFILE\u0026#34; fi else echo \u0026#34;âŒ PID æ–‡ä»¶ä¸å­˜åœ¨ï¼ŒæœåŠ¡å¯èƒ½æœªè¿è¡Œ\u0026#34; fi æ¿€æ´»æµ‹è¯• è¿è¡Œå¯åŠ¨è„šæœ¬ï¼š\n1 ./start.sh æ‰“å¼€ Shottr åº”ç”¨\nè¿›å…¥ \u0026ldquo;License\u0026rdquo; è®¾ç½®é¡µé¢\nè¾“å…¥ä»»æ„å­—ç¬¦ä¸²ä½œä¸ºæ¿€æ´»ç \nç‚¹å‡»æ¿€æ´»æŒ‰é’® å¼€æœºè‡ªåŠ¨åŒ– å¦‚æœå¸Œæœ›ç³»ç»Ÿå¯åŠ¨æ—¶è‡ªåŠ¨è¿è¡Œç ´è§£æœåŠ¡ï¼Œå¯ä»¥åˆ›å»ºä¸€ä¸ª Launch Agentï¼š\nåˆ›å»ºæ–‡ä»¶ ~/Library/LaunchAgents/com.shottr.crack.plistï¼š\nxml\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 \u0026lt;?xml version=\u0026#34;1.0\u0026#34; encoding=\u0026#34;UTF-8\u0026#34;?\u0026gt; \u0026lt;!DOCTYPE plist PUBLIC \u0026#34;-//Apple//DTD PLIST 1.0//EN\u0026#34; \u0026#34;http://www.apple.com/DTDs/PropertyList-1.0.dtd\u0026#34;\u0026gt; \u0026lt;plist version=\u0026#34;1.0\u0026#34;\u0026gt; \u0026lt;dict\u0026gt; \u0026lt;key\u0026gt;Label\u0026lt;/key\u0026gt; \u0026lt;string\u0026gt;com.shottr.crack\u0026lt;/string\u0026gt; \u0026lt;key\u0026gt;ProgramArguments\u0026lt;/key\u0026gt; \u0026lt;array\u0026gt; \u0026lt;string\u0026gt;/path/to/your/start.sh\u0026lt;/string\u0026gt; \u0026lt;/array\u0026gt; \u0026lt;key\u0026gt;RunAtLoad\u0026lt;/key\u0026gt; \u0026lt;true/\u0026gt; \u0026lt;key\u0026gt;KeepAlive\u0026lt;/key\u0026gt; \u0026lt;true/\u0026gt; \u0026lt;/dict\u0026gt; \u0026lt;/plist\u0026gt; æ³¨æ„è¿™é‡Œçš„è·¯å¾„ï¼Œéœ€è¦æ”¹æˆä½ æœ¬åœ°è„šæœ¬æ‰€åœ¨çš„è·¯å¾„\nåŠ è½½æœåŠ¡ï¼š\n1 launchctl load ~/Library/LaunchAgents/com.shottr.crack.plist æ€»ç»“ é€šè¿‡ mitmproxyï¼Œæˆ‘ä»¬æˆåŠŸå®ç°äº† Shottr çš„è‡ªåŠ¨åŒ–æ¿€æ´»ï¼Œç›¸æ¯” Charles ç­‰å•†ä¸šä»£ç†è½¯ä»¶ï¼Œè¿™ä¸ªæ–¹æ¡ˆæ›´åŠ è½»é‡ã€è‡ªåŠ¨åŒ–ç¨‹åº¦æ›´é«˜ã€‚ä¸è¿‡æœ€é‡è¦çš„æ˜¯ï¼Œå¦‚æœä½ è§‰å¾— Shottr ç¡®å®å¥½ç”¨ï¼Œè¿˜æ˜¯å»ºè®®è´­ä¹°æ­£ç‰ˆæ¥æ”¯æŒå¼€å‘è€…çš„æŒç»­å¼€å‘ã€‚\n","permalink":"https://jackcipher.github.io/posts/how-to-crack-shottr/","summary":"\u003cp\u003eShottr æ˜¯ä¸€æ¬¾åŠŸèƒ½å¼ºå¤§çš„ macOS æˆªå›¾è½¯ä»¶ï¼Œè™½ç„¶åŸºç¡€åŠŸèƒ½å…è´¹ï¼Œä½†è®¸å¤šå®ç”¨çš„é«˜çº§åŠŸèƒ½ï¼ˆå¦‚ backdrop èƒŒæ™¯è™šåŒ–ç­‰ï¼‰éœ€è¦ä»˜è´¹ä½¿ç”¨ã€‚\u003c/p\u003e\n\u003ch3 id=\"æ¿€æ´»åŸç†\"\u003eæ¿€æ´»åŸç†\u003c/h3\u003e\n\u003cp\u003eé€šè¿‡ Charles æŠ“åŒ…å‘ç°ï¼Œæ¯å½“åœ¨ Shottr é‡Œçš„ \u0026ldquo;License\u0026rdquo; ç•Œé¢è¿›è¡Œæ¿€æ´»æ—¶ï¼ŒApp éƒ½ä¼šå‘ \u003ccode\u003eshottr.cc\u003c/code\u003e å‘é€ä¸€ä¸ª POST è¯·æ±‚æ¥éªŒè¯æ¿€æ´»ç çš„æœ‰æ•ˆæ€§ã€‚\u003c/p\u003e","title":"å¦‚ä½•é€šè¿‡ mitmproxy æ¿€æ´» Shottr"},{"content":"åœ¨ç®—æ³•é¢è¯•ä¸­ï¼ŒäºŒåˆ†æŸ¥æ‰¾ï¼ˆBinary Searchï¼‰ æ˜¯ä¸€ä¸ªéå¸¸é‡è¦çš„çŸ¥è¯†ç‚¹ã€‚è®¸å¤šäººåœ¨å®é™…åº”ç”¨æ—¶ä¼šé‡åˆ°è¾¹ç•Œå¤„ç†çš„é—®é¢˜ï¼Œå¯¼è‡´ç¨‹åºå‡ºç° bugã€‚æœ¬æ–‡å°†æ€»ç»“äºŒåˆ†æŸ¥æ‰¾çš„é€šç”¨æ¨¡å‹ï¼Œå¹¶åˆ†æå¸¸è§é”™è¯¯ã€‚\n1. äºŒåˆ†æŸ¥æ‰¾çš„åŸºæœ¬æ€æƒ³ äºŒåˆ†æŸ¥æ‰¾é€‚ç”¨äº æœ‰åºæ•°ç»„ï¼Œå…¶æ ¸å¿ƒæ€æƒ³æ˜¯ä¸æ–­ç¼©å°æœç´¢èŒƒå›´ï¼Œç›´åˆ°æ‰¾åˆ°ç›®æ ‡å€¼æˆ–ç¡®å®šç›®æ ‡å€¼ä¸å­˜åœ¨ã€‚\näºŒåˆ†æŸ¥æ‰¾ä¸»è¦æœ‰ä¸‰ç§å¸¸è§å½¢å¼ï¼š\næ ‡å‡†äºŒåˆ†æŸ¥æ‰¾ï¼ˆæŸ¥æ‰¾å…·ä½“å€¼ï¼‰ æœç´¢å·¦è¾¹ç•Œï¼ˆLower Boundï¼‰ æœç´¢å³è¾¹ç•Œï¼ˆUpper Boundï¼‰ 2. æ ‡å‡†äºŒåˆ†æŸ¥æ‰¾ï¼ˆæŸ¥æ‰¾å…·ä½“å€¼ï¼‰ å·¦é—­å³é—­åŒºé—´ [left, right] 1 2 3 4 5 6 7 8 9 10 11 12 13 14 func binarySearch(nums []int, target int) int { left, right := 0, len(nums)-1 for left \u0026lt;= right { mid := left + (right-left)/2 if nums[mid] == target { return mid } else if nums[mid] \u0026lt; target { left = mid + 1 } else { right = mid - 1 } } return -1 } å·¦é—­å³å¼€åŒºé—´ [left, right)ï¼ˆæ¨èï¼‰ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 func binarySearch(nums []int, target int) int { left, right := 0, len(nums) for left \u0026lt; right { mid := left + (right-left)/2 if nums[mid] == target { return mid } else if nums[mid] \u0026lt; target { left = mid + 1 } else { right = mid } } return -1 } ä¸¤ç§æ–¹å¼çš„å¯¹æ¯” æ–¹å¼ right åˆå§‹åŒ– ç»ˆæ­¢æ¡ä»¶ right æ›´æ–°æ–¹å¼ left æ›´æ–°æ–¹å¼ å·¦é—­å³é—­ [left, right] len(nums)-1 left \u0026lt;= right right = mid - 1 left = mid + 1 å·¦é—­å³å¼€ [left, right) len(nums) left \u0026lt; right right = mid left = mid + 1 æ¨èä½¿ç”¨ å·¦é—­å³å¼€ [left, right) çš„å†™æ³•ï¼Œå› ä¸ºå®ƒé¿å…äº† right = mid - 1 è¿™ç§å¯èƒ½å¯¼è‡´è¾¹ç•Œé—®é¢˜çš„æ“ä½œã€‚\n3. æœç´¢å·¦è¾¹ç•Œï¼ˆLower Boundï¼‰ ç›®æ ‡ï¼šæŸ¥æ‰¾ target åœ¨æ•°ç»„ä¸­çš„ç¬¬ä¸€ä¸ªå‡ºç°ä½ç½®ï¼Œæˆ–ç¬¬ä¸€ä¸ªå¤§äºç­‰äº target çš„å…ƒç´ ç´¢å¼•ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 func lowerBound(nums []int, target int) int { left, right := 0, len(nums) for left \u0026lt; right { mid := left + (right-left)/2 if nums[mid] \u0026gt;= target { right = mid } else { left = mid + 1 } } return left } å¸¸è§é”™è¯¯ï¼š\nright åº”è¯¥åˆå§‹åŒ–ä¸º len(nums)ï¼Œè€Œä¸æ˜¯ len(nums)-1ã€‚ right = mid è€Œä¸æ˜¯ right = mid - 1ï¼Œå¦åˆ™å¯èƒ½è·³è¿‡æ­£ç¡®ç­”æ¡ˆã€‚ 4. æœç´¢å³è¾¹ç•Œï¼ˆUpper Boundï¼‰ ç›®æ ‡ï¼šæŸ¥æ‰¾ target çš„æœ€åä¸€ä¸ªå‡ºç°ä½ç½® + 1ï¼Œæˆ–è€…ç¬¬ä¸€ä¸ªå¤§äº target çš„å…ƒç´ ç´¢å¼•ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 func upperBound(nums []int, target int) int { left, right := 0, len(nums) for left \u0026lt; right { mid := left + (right-left)/2 if nums[mid] \u0026gt; target { right = mid } else { left = mid + 1 } } return left } å¸¸è§é”™è¯¯ï¼š\nright åº”è¯¥åˆå§‹åŒ–ä¸º len(nums)ï¼Œå¦åˆ™å¯èƒ½ä¼šé—æ¼è¾¹ç•Œæƒ…å†µã€‚ right = mid è€Œä¸æ˜¯ right = mid - 1ï¼Œé˜²æ­¢è·³è¿‡æ­£ç¡®çš„ mid ä½ç½®ã€‚ 5. ç»Ÿä¸€çš„äºŒåˆ†æŸ¥æ‰¾æ¨¡æ¿ ä¸ºäº†è®©ä»£ç æ›´åŠ ç»Ÿä¸€ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ å·¦é—­å³å¼€ [left, right) çš„å½¢å¼æ¥å®ç°æ‰€æœ‰äºŒåˆ†æŸ¥æ‰¾ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 func binarySearchTemplate(nums []int, target int, isLowerBound bool) int { left, right := 0, len(nums) for left \u0026lt; right { mid := left + (right-left)/2 if nums[mid] \u0026gt; target || (isLowerBound \u0026amp;\u0026amp; nums[mid] == target) { right = mid } else { left = mid + 1 } } return left } æŸ¥æ‰¾ targetï¼šbinarySearchTemplate(nums, target, false) æŸ¥æ‰¾å·¦è¾¹ç•Œï¼šbinarySearchTemplate(nums, target, true) æŸ¥æ‰¾å³è¾¹ç•Œï¼šbinarySearchTemplate(nums, target+1, true) 6. æ€»ç»“ æŸ¥æ‰¾æ–¹å¼ é€‚ç”¨åœºæ™¯ ç»ˆæ­¢æ¡ä»¶ if é€»è¾‘ æ ‡å‡†äºŒåˆ†æŸ¥æ‰¾ æŸ¥æ‰¾ target æ˜¯å¦å­˜åœ¨ left \u0026lt; right nums[mid] == target å·¦è¾¹ç•Œï¼ˆLower Boundï¼‰ æ‰¾ target çš„ç¬¬ä¸€ä¸ªä½ç½® left \u0026lt; right nums[mid] \u0026gt;= target å³è¾¹ç•Œï¼ˆUpper Boundï¼‰ æ‰¾ target çš„æœ€åä¸€ä¸ªä½ç½®+1 left \u0026lt; right nums[mid] \u0026gt; target æ¨èï¼šç»Ÿä¸€ä½¿ç”¨ [left, right) æ–¹å¼ï¼Œé€»è¾‘æ›´æ¸…æ™°ï¼Œé”™è¯¯ç‡æ›´ä½ï¼\nå¸Œæœ›è¿™ç¯‡æ–‡ç« èƒ½å¸®åŠ©ä½ æ›´å¥½åœ°ç†è§£äºŒåˆ†æŸ¥æ‰¾ï¼ä½ åœ¨å®é™…å†™äºŒåˆ†æŸ¥æ‰¾æ—¶é‡åˆ°å“ªäº›é—®é¢˜å‘¢ï¼Ÿæ¬¢è¿ç•™è¨€äº¤æµï¼\n","permalink":"https://jackcipher.github.io/leetcode/leetcode-bisection/","summary":"\u003cp\u003eåœ¨ç®—æ³•é¢è¯•ä¸­ï¼Œ\u003cstrong\u003eäºŒåˆ†æŸ¥æ‰¾ï¼ˆBinary Searchï¼‰\u003c/strong\u003e æ˜¯ä¸€ä¸ªéå¸¸é‡è¦çš„çŸ¥è¯†ç‚¹ã€‚è®¸å¤šäººåœ¨å®é™…åº”ç”¨æ—¶ä¼šé‡åˆ°è¾¹ç•Œå¤„ç†çš„é—®é¢˜ï¼Œå¯¼è‡´ç¨‹åºå‡ºç° bugã€‚æœ¬æ–‡å°†æ€»ç»“äºŒåˆ†æŸ¥æ‰¾çš„é€šç”¨æ¨¡å‹ï¼Œå¹¶åˆ†æå¸¸è§é”™è¯¯ã€‚\u003c/p\u003e","title":"äºŒåˆ†æŸ¥æ‰¾çš„é€šç”¨æ¨¡å‹ä¸å¸¸è§é”™è¯¯"},{"content":"åœ¨ä½æ“ä½œï¼ˆBit Manipulationï¼‰çš„é¢†åŸŸé‡Œï¼Œæœ‰ä¸€äº›æŠ€å·§å› å…¶ç®€æ´å’Œé«˜æ•ˆï¼Œå¸¸å¸¸è¢«ç§°ä½œâ€œé­”æ³•â€ã€‚Kernighanâ€™s Algorithm å°±æ˜¯å…¶ä¸­æœ€ä»¤äººå°è±¡æ·±åˆ»çš„ä¸€ä¸ªã€‚\nå®ƒæ—¨åœ¨è§£å†³ä¸€ä¸ªç»å…¸é—®é¢˜ï¼šPopulation Countï¼ˆåˆç§° Hamming Weightï¼‰ï¼Œå³ï¼š\nå¦‚ä½•é«˜æ•ˆåœ°è®¡ç®—ä¸€ä¸ªæ•´æ•°çš„äºŒè¿›åˆ¶è¡¨ç¤ºä¸­ï¼Œæœ‰å¤šå°‘ä¸ª 1ï¼Ÿ\næœ´ç´ è§£æ³•çš„å±€é™ æœ€ç›´è§‚çš„è§£æ³•æ˜¯é€ä½æ£€æŸ¥ã€‚æˆ‘ä»¬é€šè¿‡å¾ªç¯å’Œç§»ä½ï¼Œä¾æ¬¡åˆ¤æ–­æ¯ä¸€ä½æ˜¯å¦ä¸º 1ã€‚\n1 2 3 4 5 6 7 8 9 func hammingWeight(n uint32) int { count := 0 for i := 0; i \u0026lt; 32; i++ { if (n \u0026amp; (1 \u0026lt;\u0026lt; i)) != 0 { count++ } } return count } è¿™ç§æ–¹æ³•çš„ç¼ºç‚¹æ˜¾è€Œæ˜“è§ï¼šå®ƒçš„æ‰§è¡Œæ—¶é—´å›ºå®šä¸º $O(n)$ï¼ˆ$n$ ä¸ºæ•´æ•°çš„ä½æ•°ï¼Œå¦‚ 32ï¼‰ã€‚æ— è®ºè¿™ä¸ªæ•°æ˜¯ 0 è¿˜æ˜¯ 0xFFFFFFFFï¼Œå®ƒéƒ½å¿…é¡»è·‘å®Œæ‰€æœ‰å¾ªç¯ã€‚å³ä¾¿æ•°å­—é‡Œåªæœ‰ä¸€ä¸ª 1ï¼Œæˆ‘ä»¬ä¹Ÿæµªè´¹äº† 31 æ¬¡å¾ªç¯åœ¨æ£€æŸ¥ 0 ä¸Šã€‚\næ ¸å¿ƒæ´å¯Ÿï¼šç²¾å‡†æ¶ˆé™¤ Kernighanâ€™s Algorithm çš„æ ¸å¿ƒæ€æƒ³éå¸¸æ€§æ„Ÿï¼šè·³è¿‡æ‰€æœ‰çš„ 0ï¼Œæ¯æ¬¡å¾ªç¯åªå¤„ç†ï¼ˆå¹¶æ¶ˆé™¤ï¼‰ä¸€ä¸ª 1ã€‚\nå®ç°è¿™ä¸€ç›®æ ‡çš„â€œé­”æ³•æŒ‡ä»¤â€åªæœ‰ä¸€è¡Œï¼š\n1 n = n \u0026amp; (n - 1) è¿™ä¸€è¡Œä»£ç çš„ä½œç”¨æ˜¯ï¼šå°† n çš„äºŒè¿›åˆ¶è¡¨ç¤ºä¸­ï¼Œæœ€å³ä¾§çš„é‚£ä¸ª 1 (The Rightmost Set Bit) å˜ä¸º 0ï¼Œè€Œä¿æŒå…¶ä»–ä½ä¸å˜ã€‚\nä¸ºä»€ä¹ˆæ˜¯ n \u0026amp; (n - 1)ï¼Ÿ æˆ‘ä»¬å¯ä»¥å°†ä»»æ„æ•´æ•° $n$ çš„äºŒè¿›åˆ¶ç»“æ„æ‹†è§£ä¸ºä¸‰éƒ¨åˆ†ï¼š\né«˜ä½éƒ¨åˆ†ï¼šæœ€å³ä¾§ 1 å·¦è¾¹çš„æ‰€æœ‰ä½ã€‚ å…³é”®ä½ï¼šæœ€å³ä¾§çš„é‚£ä¸ª 1ã€‚ ä½ä½éƒ¨åˆ†ï¼šå…³é”®ä½å³è¾¹çš„æ‰€æœ‰ 0ã€‚ å³ï¼š$n = (\\dots\\text{High}\\dots) \\ \\mathbf{1} \\ (\\dots000\\dots)$\nå½“æˆ‘ä»¬æ‰§è¡Œ n - 1 æ—¶ï¼Œå€Ÿä½æ“ä½œä¼šä»æœ€ä½ä½ä¸€ç›´å‘å·¦ä¼ å¯¼ï¼Œç›´åˆ°é‡åˆ°é‚£ä¸ªå…³é”®ä½ 1ï¼š\nå…³é”®ä½ï¼šè¢«â€œå€Ÿä½â€å˜æˆäº† 0ã€‚ ä½ä½éƒ¨åˆ†ï¼šå› ä¸ºå€Ÿä½ï¼ŒåŸæ¥çš„ 000... å…¨éƒ¨ç¿»è½¬æˆäº† 111...ã€‚ é«˜ä½éƒ¨åˆ†ï¼šä¸å—å€Ÿä½å½±å“ï¼Œä¿æŒä¸å˜ã€‚ ç°åœ¨ï¼Œæˆ‘ä»¬å°† n ä¸ n - 1 è¿›è¡Œ æŒ‰ä½ä¸ (\u0026amp;) æ“ä½œï¼š\n$$ \\begin{array}{rcccc} n \u0026amp; = \u0026amp; \\text{High} \u0026amp; \\mathbf{1} \u0026amp; 00\\dots0 \\\\ n - 1 \u0026amp; = \u0026amp; \\text{High} \u0026amp; \\mathbf{0} \u0026amp; 11\\dots1 \\\\ \\hline \\text{Result} \u0026amp; = \u0026amp; \\text{High} \u0026amp; \\mathbf{0} \u0026amp; 00\\dots0 \\end{array} $$\nç»“è®ºï¼šé«˜ä½ä¿æŒä¸å˜ï¼Œä½ä½å…¨éƒ¨å½’é›¶ï¼Œå”¯ç‹¬æœ€å³ä¾§çš„é‚£ä¸ª 1 è¢«æ¶ˆé™¤äº†ã€‚\nç®—æ³•æ¼”ç¤º åœ¨ä¸‹æ–¹è¾“å…¥ä»»æ„æ•°å­—ï¼ˆ0-255ï¼‰ï¼Œè§‚å¯Ÿæ¯æ¬¡è¿­ä»£å¦‚ä½•ç²¾å‡†åœ°æ‘˜é™¤ä¸€ä¸ª set bitã€‚\næ•°å€¼: åŠ è½½ Up Down è‡ªåŠ¨ æ…¢ å¿« n n - 1 n \u0026 (n-1) ç­‰å¾…å¼€å§‹... å½“å‰ n (åè¿›åˆ¶): - å·²æ‰¾åˆ° 1 çš„ä¸ªæ•°: 0 (ç®—æ³•è¿­ä»£æ¬¡æ•°): 0 function kernighan(n) { let count = 0; while (n \u003e 0) { // æ ¸å¿ƒ: n-1 ç¿»è½¬æœ€å³ä¾§çš„ 1 // ä¸æ“ä½œåï¼Œè¯¥ä½è¢«æ¶ˆé™¤ n = n \u0026 (n - 1); count++; } return count; } å¤æ‚åº¦åˆ†æ è¿™æ˜¯ Kernighanâ€™s Algorithm èƒ½å¤Ÿæˆä¸ºç»å…¸çš„åŸå› ï¼š\nç‰¹æ€§ æœ´ç´ è§£æ³• Kernighan\u0026rsquo;s Algorithm å¾ªç¯æ¬¡æ•° å›ºå®š $N$ æ¬¡ (32/64) $k$ æ¬¡ ($k$ ä¸º 1 çš„ä¸ªæ•°) æ—¶é—´å¤æ‚åº¦ $O(N)$ $O(k)$ ä¼˜åŠ¿åœºæ™¯ å¯†é›†å‹ (å…¨æ˜¯ 1) ç¨€ç–å‹ (1 å¾ˆå°‘) åœ¨å®é™…åº”ç”¨ä¸­ï¼Œç»å¤§å¤šæ•°æ•´æ•°çš„ 1 éƒ½æ˜¯ç¨€ç–åˆ†å¸ƒçš„ã€‚ä¾‹å¦‚å¯¹äºä¸€ä¸ª32ä½æ•´æ•°ï¼Œå¦‚æœå®ƒåªæœ‰ 3 ä¸ª 1ï¼Œè¯¥ç®—æ³•åªéœ€è¦è¿è¡Œ 3 æ¬¡å¾ªç¯ï¼Œæ€§èƒ½æå‡äº† 10 å€ä»¥ä¸Šã€‚\nä»£ç å®ç° (Go) åˆ©ç”¨è¿™ä¸€ç‰¹æ€§ï¼Œæˆ‘ä»¬å¯ä»¥å†™å‡ºæç®€çš„è®¡æ•°ä»£ç ã€‚æ³¨æ„å¾ªç¯æ¡ä»¶æ˜¯ n != 0ï¼Œè¿™æ„å‘³ç€ä¸€æ—¦æ‰€æœ‰çš„ 1 è¢«æ¶ˆé™¤ï¼Œå¾ªç¯ç«‹å³ç»ˆæ­¢ã€‚\n1 2 3 4 5 6 7 8 func hammingWeight(n uint32) int { count := 0 for n != 0 { n \u0026amp;= (n - 1) // æ¶ˆé™¤æœ€å³ä¾§çš„ 1 count++ } return count } å…¶é€»è¾‘æµç¨‹å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š\ngraph TD Start((å¼€å§‹)) --\u0026gt; Cond{n != 0 ?} Cond -- Yes --\u0026gt; Step1[\u0026#34;n = n \u0026amp; (n - 1)\u0026lt;br\u0026gt;(æ¶ˆé™¤æœ€å³ä¾§ 1)\u0026#34;] Step1 --\u0026gt; Step2[count++] Step2 --\u0026gt; Cond Cond -- No --\u0026gt; End((è¿”å› count)) style Step1 fill:#f9f,stroke:#333,stroke-width:2px ä¸¾ä¸€åä¸‰ï¼šæ›´å¤šåº”ç”¨åœºæ™¯ ç†è§£äº† n \u0026amp; (n - 1) çš„æœ¬è´¨ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥ç”¨å®ƒè§£å†³æ›´å¤šé—®é¢˜ï¼š\n1. åˆ¤æ–­ 2 çš„å¹‚ (Power of Two) 2 çš„å¹‚æœ‰ä¸€ä¸ªç‰¹å¾ï¼šäºŒè¿›åˆ¶è¡¨ç¤ºä¸­æœ‰ä¸”ä»…æœ‰ä¸€ä¸ª 1ã€‚ è¿™æ„å‘³ç€ï¼Œå¦‚æœæˆ‘ä»¬æ¶ˆé™¤æ‰è¿™å”¯ä¸€çš„ 1ï¼Œç»“æœåº”è¯¥å˜ä¸º 0ã€‚\n1 2 3 4 5 func isPowerOfTwo(n int) bool { // n \u0026gt; 0 æ’é™¤è´Ÿæ•°å’Œ 0 // (n \u0026amp; (n - 1)) == 0 è¯´æ˜æ¶ˆé™¤ä¸€ä¸ª 1 åå°±æ²¡äº† return n \u0026gt; 0 \u0026amp;\u0026amp; (n \u0026amp; (n - 1)) == 0 } 2. æ±‰æ˜è·ç¦» (Hamming Distance) æ±‰æ˜è·ç¦»å®šä¹‰ä¸ºä¸¤ä¸ªæ•°äºŒè¿›åˆ¶ä½ä¸åŒçš„ä¸ªæ•°ã€‚ æˆ‘ä»¬åªéœ€è¦å…ˆåšå¼‚æˆ– xor = x ^ yï¼ˆä¸åŒçš„ä½å˜ä¸º 1ï¼‰ï¼Œç„¶åå¯¹ xor åº”ç”¨ Kernighanâ€™s Algorithm å³å¯ã€‚\n3. ç¨€ç–ä½å›¾è¿­ä»£ åœ¨å¤„ç† BitMap æˆ– FlagSet æ—¶ï¼Œå¦‚æœæˆ‘ä»¬éœ€è¦éå†æ‰€æœ‰è¢«ç½®ä½çš„æ ‡å¿—ï¼Œä½¿ç”¨æ­¤ç®—æ³•å¯ä»¥ç›´æ¥è·³è·ƒåˆ°ä¸‹ä¸€ä¸ªç½®ä½ç‚¹ï¼Œè€Œä¸éœ€è¦é€ä¸ªæ£€æŸ¥æ¯ä¸€ä½ï¼Œåœ¨å¤§è§„æ¨¡ç¨€ç–æ•°æ®å¤„ç†ä¸­æ•ˆç‡æé«˜ã€‚\næ€»ç»“ è™½ç„¶åœ¨ç°ä»£ CPU æŒ‡ä»¤é›†ï¼ˆå¦‚ x86 çš„ POPCNTï¼‰æ”¯æŒä¸‹ï¼Œç¡¬ä»¶çº§çš„ä½è®¡æ•°å¯ä»¥è¾¾åˆ°å•æŒ‡ä»¤å‘¨æœŸå®Œæˆï¼Œä½† Kernighanâ€™s Algorithm ä¾ç„¶æ˜¯ç®—æ³•é¢è¯•å’Œè·¨å¹³å°è½¯ä»¶å®ç°ä¸­çš„æœ€ä¼˜è§£ã€‚å®ƒå±•ç¤ºäº†ä½æ“ä½œæœ€è¿·äººçš„ä¸€é¢ï¼šé€šè¿‡å¯¹äºŒè¿›åˆ¶å¾®è§‚ç»“æ„çš„æ·±åˆ»ç†è§£ï¼Œæ¢å–å®è§‚æ€§èƒ½çš„æè‡´ä¼˜åŒ–ã€‚\nç›¸å…³é¢˜ç›® LeetCode 191. Number of 1 Bits LeetCode 338. Counting Bits ","permalink":"https://jackcipher.github.io/leetcode/brian-kernighan/","summary":"\u003cp\u003eåœ¨ä½æ“ä½œï¼ˆBit Manipulationï¼‰çš„é¢†åŸŸé‡Œï¼Œæœ‰ä¸€äº›æŠ€å·§å› å…¶ç®€æ´å’Œé«˜æ•ˆï¼Œå¸¸å¸¸è¢«ç§°ä½œâ€œé­”æ³•â€ã€‚\u003cstrong\u003eKernighanâ€™s Algorithm\u003c/strong\u003e å°±æ˜¯å…¶ä¸­æœ€ä»¤äººå°è±¡æ·±åˆ»çš„ä¸€ä¸ªã€‚\u003c/p\u003e","title":"Kernighanâ€™s Algorithm ä½æ“ä½œè§£æ"},{"content":"æ•°ç»„æ±‚å’Œé—®é¢˜ï¼ˆN-Sumï¼‰æ˜¯ç®—æ³•é¢è¯•ä¸­ç»ä¹…ä¸è¡°çš„ç»å…¸é¢˜å‹ã€‚ä»æœ€åŸºç¡€çš„ Two Sum åˆ°è¿›é˜¶çš„ kSumï¼Œå…¶æ ¸å¿ƒæœ¬è´¨å¾€å¾€æ®Šé€”åŒå½’ã€‚æœ¬æ–‡å°†ä»¥èµ„æ·±å·¥ç¨‹å¸ˆçš„è§†è§’ï¼Œç³»ç»Ÿæ¢³ç† 2Sumã€3Sumã€3Sum Closest åŠ 4Sum çš„è§£é¢˜æ¼”è¿›ä¹‹è·¯ï¼Œæ¢è®¨å¦‚ä½•é€šè¿‡åŒæŒ‡é’ˆä¸å‰ªæç­–ç•¥å°†æ—¶é—´å¤æ‚åº¦å‹æ¦¨è‡³æé™ã€‚\né€šç”¨è§£é¢˜æ¨¡å¼ åœ¨æ·±å…¥å…·ä½“ä»£ç ä¹‹å‰ï¼Œæˆ‘ä»¬è¦å»ºç«‹ä¸€ä¸ªå…¨å±€è§†è§’ã€‚è¿™ç±»é—®é¢˜é€šå¸¸å¯ä»¥å½’çº³ä¸ºä»¥ä¸‹ä¸‰ç§æ¨¡å¼ï¼š\nç¡®å®šæ€§é—®é¢˜ï¼šå¦‚ Two Sumï¼Œå¯»æ‰¾ç²¾ç¡®çš„ç›®æ ‡è§£ã€‚ æœ€ä¼˜åŒ–é—®é¢˜ï¼šå¦‚ 3Sum Closestï¼Œå¯»æ‰¾ä¸ç›®æ ‡æœ€æ¥è¿‘çš„è§£ã€‚ ç»„åˆé—®é¢˜ï¼šå¦‚ 4Sumï¼Œå¯»æ‰¾æ‰€æœ‰æ»¡è¶³æ¡ä»¶çš„ä¸é‡å¤å…ƒç»„ã€‚ æ ¸å¿ƒä¼˜åŒ–æ–¹å‘æ°¸è¿œæ˜¯å›´ç»•æ—¶é—´å¤æ‚åº¦è¿›è¡Œçš„ï¼š\nç©ºé—´æ¢æ—¶é—´ï¼šåˆ©ç”¨å“ˆå¸Œè¡¨å°† $O(n)$ æŸ¥æ‰¾ä¼˜åŒ–è‡³ $O(1)$ã€‚ æ’åº + åŒæŒ‡é’ˆï¼šè¿™æ˜¯è§£å†³ N-Sum é—®é¢˜çš„â€œé“¶å¼¹â€ã€‚é€šè¿‡æ’åºå°†æ— åºæ•°ç»„è½¬åŒ–ä¸ºæœ‰åºï¼Œä»è€Œåˆ©ç”¨åŒæŒ‡é’ˆçš„å•è°ƒæ€§ï¼Œå°† $O(n^k)$ çš„å¤æ‚åº¦é™ä½è‡³ $O(n^{k-1})$ã€‚ å‰ªæï¼ˆPruningï¼‰ï¼šåœ¨æœç´¢è¿‡ç¨‹ä¸­æå‰å‰”é™¤ä¸å¯èƒ½çš„åˆ†æ”¯ï¼Œè¿™åœ¨ N \u0026gt; 2 æ—¶å°¤ä¸ºé‡è¦ã€‚ 1. Two Sumï¼šä¸‡æ³•ä¹‹æº LeetCode 1 | é“¾æ¥\nè¿™æ˜¯æ‰€æœ‰äººçš„ç®—æ³•èµ·ç‚¹ï¼Œä½†å®ƒå¼•å‡ºäº†ä¸¤ä¸ªæœ€åŸºæœ¬çš„æµæ´¾ã€‚\næ ¸å¿ƒæ€è·¯ æš´åŠ›æ³•ï¼šåŒå±‚å¾ªç¯ï¼Œæœ€ç›´è§‚ä½†æ•ˆç‡æœ€ä½ï¼Œæ—¶é—´å¤æ‚åº¦ $O(n^2)$ã€‚ å“ˆå¸Œè¡¨ï¼ˆæœ€ä¼˜è§£ï¼‰ï¼šåˆ©ç”¨ Map è®°å½•éå†è¿‡çš„å…ƒç´  {value: index}ï¼Œåœ¨éå† nums[i] æ—¶ï¼Œç›´æ¥æŸ¥æ‰¾ target - nums[i] æ˜¯å¦å­˜åœ¨ã€‚ Go æœ€ä½³å®è·µ å·¥ç¨‹ä»£ç ä¸­ï¼Œæˆ‘ä»¬ç›´æ¥é‡‡ç”¨å“ˆå¸Œè¡¨æ³•ï¼Œè¿™åœ¨è¿™ä¸€å±‚é¢ä¸Šæ˜¯æ—¶é—´æœ€ä¼˜çš„ã€‚\n1 2 3 4 5 6 7 8 9 10 11 func twoSum(nums []int, target int) []int { // é¢„åˆ†é… map ç©ºé—´å¯å¾®å®¹æ˜“å‡å°‘ rehash å¼€é”€ï¼Œè™½éå¿…é¡»ä½†ä¸ºå¥½ä¹ æƒ¯ seen := make(map[int]int, len(nums)) for i, num := range nums { if j, exists := seen[target-num]; exists { return []int{j, i} } seen[num] = i } return nil } 2. Three Sumï¼šæ’åºä¸åŒæŒ‡é’ˆçš„è‰ºæœ¯ LeetCode 15 | é“¾æ¥\nä»ä¸¤æ•°ä¹‹å’Œåˆ°ä¸‰æ•°ä¹‹å’Œï¼Œé¢˜ç›®éš¾åº¦é™¡å¢ã€‚ä¸»è¦éš¾ç‚¹åœ¨äºå»é‡ã€‚å¦‚æœæ²¿ç”¨å“ˆå¸Œè¡¨æ³•ï¼Œå»é‡é€»è¾‘ä¼šéå¸¸å¤æ‚ä¸”éš¾ä»¥ç»´æŠ¤ã€‚æ­¤æ—¶ï¼Œæ’åº + åŒæŒ‡é’ˆæˆä¸ºäº†æ ‡å‡†è§£æ³•ã€‚\næ ¸å¿ƒæ€è·¯ æ’åºï¼šé¦–å…ˆå¯¹æ•°ç»„è¿›è¡Œæ’åºã€‚è¿™æ˜¯ä½¿ç”¨åŒæŒ‡é’ˆå’Œå»é‡çš„å‰æã€‚ å›ºå®šä¸€ä½ï¼šéå†æ•°ç»„ï¼Œå›ºå®šæšä¸¾ nums[i]ã€‚ åŒæŒ‡é’ˆæ±‡èšï¼šåœ¨ i åé¢çš„åŒºé—´ [i+1, n-1] ä¸­ï¼Œè®¾ç½®å·¦å³æŒ‡é’ˆ left å’Œ rightï¼Œå¯»æ‰¾ nums[left] + nums[right] == -nums[i]ã€‚ æè‡´å‰ªæï¼š æå‰é€€å‡ºï¼šå¦‚æœ nums[i] \u0026gt; 0ï¼Œç”±äºæ•°ç»„å·²æ’åºï¼Œåç»­ä¸å¯èƒ½å†æœ‰æ•°å­—ä¹‹å’Œç­‰äº 0ã€‚ è·³è¿‡é‡å¤ï¼šæ— è®ºæ˜¯å›ºå®šçš„ iï¼Œè¿˜æ˜¯ç§»åŠ¨çš„ left å’Œ rightï¼Œé‡åˆ°ç›¸åŒæ•°å€¼å¿…é¡»è·³è¿‡ï¼Œä»¥é¿å…äº§ç”Ÿé‡å¤ç»“æœã€‚ Go å®ç° 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 func threeSum(nums []int) [][]int { sort.Ints(nums) n := len(nums) // é¢„ä¼°å®¹é‡ï¼Œé¿å…é¢‘ç¹æ‰©å®¹ result := make([][]int, 0, n/3) for i := 0; i \u0026lt; n-2; i++ { // å‰ªæ 1: æœ€å°çš„æ•°éƒ½å¤§äº 0ï¼Œæ²¡æˆäº† if nums[i] \u0026gt; 0 { break } // å‰ªæ 2: i å»é‡ if i \u0026gt; 0 \u0026amp;\u0026amp; nums[i] == nums[i-1] { continue } left, right := i+1, n-1 for left \u0026lt; right { sum := nums[i] + nums[left] + nums[right] if sum == 0 { result = append(result, []int{nums[i], nums[left], nums[right]}) // å‰ªæ 3: left å’Œ right å»é‡ for left \u0026lt; right \u0026amp;\u0026amp; nums[left] == nums[left+1] { left++ } for left \u0026lt; right \u0026amp;\u0026amp; nums[right] == nums[right-1] { right-- } left++ right-- } else if sum \u0026lt; 0 { left++ } else { right-- } } } return result } 3. Three Sum Closestï¼šæœ€ä¼˜åŒ–æœç´¢ LeetCode 16 | é“¾æ¥\nè§£é¢˜æ€è·¯ è¿™é“é¢˜æ˜¯ 3Sum çš„å˜ä½“ã€‚åŒºåˆ«åœ¨äºæˆ‘ä»¬éœ€è¦ç»´æŠ¤ä¸€ä¸ªå…¨å±€å˜é‡æ¥è®°å½•å½“å‰çš„æœ€å°å·®è·ï¼ˆgapï¼‰ã€‚æ¡†æ¶ä¾ç„¶æ˜¯ æ’åº + åŒæŒ‡é’ˆï¼Œåªæ˜¯å¾ªç¯å†…éƒ¨çš„é€»è¾‘ä¸å†æ˜¯å¯»æ‰¾ç›¸ç­‰ï¼Œè€Œæ˜¯ä¸æ–­æ›´æ–°â€œæœ€æ¥è¿‘â€çš„å€¼ã€‚\nGo å®ç° 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 func threeSumClosest(nums []int, target int) int { sort.Ints(nums) n := len(nums) // åˆå§‹åŒ–ä¸€ä¸ªè¶³å¤Ÿå¤§çš„å·®è·æˆ–è€…æ˜¯ç¬¬ä¸€æ¬¡çš„ç»“æœ closest := nums[0] + nums[1] + nums[2] for i := 0; i \u0026lt; n-2; i++ { if i \u0026gt; 0 \u0026amp;\u0026amp; nums[i] == nums[i-1] { continue } left, right := i+1, n-1 for left \u0026lt; right { sum := nums[i] + nums[left] + nums[right] // å‘ç°æ›´æ¥è¿‘çš„å€¼ï¼Œæ›´æ–°å¿«ç…§ if abs(sum-target) \u0026lt; abs(closest-target) { closest = sum } if sum == target { return sum } else if sum \u0026lt; target { left++ } else { right-- } } } return closest } func abs(x int) int { if x \u0026lt; 0 { return -x } return x } 4. Four Sumï¼šé€’å½’ä¸æ³›åŒ– LeetCode 18 | é“¾æ¥\nè§£é¢˜æ€è·¯ å››æ•°ä¹‹å’Œè™½ç„¶çœ‹èµ·æ¥æ›´å¯æ€•ï¼Œä½†æœ¬è´¨ä¸Šåªæ˜¯åœ¨ 3Sum å¤–é¢å†å¥—äº†ä¸€å±‚å¾ªç¯ã€‚å®ƒçš„æ—¶é—´å¤æ‚åº¦æ˜¯ $O(n^3)$ã€‚\né™ç»´æ€æƒ³ï¼š\n2Sum: $O(n)$ (Hash) æˆ– $O(n \\log n)$ (Sort) 3Sum: å›ºå®š 1 ä¸ªæ•° -\u0026gt; 2Sum ($O(n^2)$) 4Sum: å›ºå®š 1 ä¸ªæ•° -\u0026gt; 3Sum -\u0026gt; 2Sum ($O(n^3)$) kSum: é€’å½’é™ç»´è‡³ 2Sumã€‚ Go å®ç° 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 func fourSum(nums []int, target int) [][]int { sort.Ints(nums) n := len(nums) result := make([][]int, 0) for i := 0; i \u0026lt; n-3; i++ { // å‰ªæ 1: æœ€å°å€¼å‰ªæ if i \u0026gt; 0 \u0026amp;\u0026amp; nums[i] == nums[i-1] { continue } // å‰ªæ 2: æ•°å€¼èŒƒå›´å‰ªæï¼ˆè¿›é˜¶ä¼˜åŒ–ï¼Œå¯é€‰ï¼‰ // if nums[i] + nums[i+1] + nums[i+2] + nums[i+3] \u0026gt; target { break } // if nums[i] + nums[n-3] + nums[n-2] + nums[n-1] \u0026lt; target { continue } for j := i+1; j \u0026lt; n-2; j++ { if j \u0026gt; i+1 \u0026amp;\u0026amp; nums[j] == nums[j-1] { continue } left, right := j+1, n-1 for left \u0026lt; right { sum := nums[i] + nums[j] + nums[left] + nums[right] if sum == target { result = append(result, []int{nums[i], nums[j], nums[left], nums[right]}) for left \u0026lt; right \u0026amp;\u0026amp; nums[left] == nums[left+1] { left++ } for left \u0026lt; right \u0026amp;\u0026amp; nums[right] == nums[right-1] { right-- } left++ right-- } else if sum \u0026lt; target { left++ } else { right-- } } } } return result } æ€»ç»“ä¸æ€è€ƒ é—®é¢˜ æœ€ä½³è§£æ³• æ—¶é—´å¤æ‚åº¦ æ ¸å¿ƒè€ƒç‚¹ 2Sum å“ˆå¸Œè¡¨ $O(n)$ ç©ºé—´æ¢æ—¶é—´ 3Sum æ’åº + åŒæŒ‡é’ˆ $O(n^2)$ å»é‡ã€åŒæŒ‡é’ˆå•è°ƒæ€§ 4Sum æ’åº + åŒå±‚å¾ªç¯ + åŒæŒ‡é’ˆ $O(n^3)$ é™ç»´æ€æƒ³ã€å‰ªæ å·¥ç¨‹å¯ç¤ºï¼š åœ¨å¤„ç†æµ·é‡æ•°æ®çš„åŒ¹é…é—®é¢˜æ—¶ï¼Œæ’åºå¾€å¾€æ˜¯åŒ–ç¹ä¸ºç®€çš„ç¬¬ä¸€æ­¥ã€‚è™½ç„¶å®ƒå¸¦æ¥äº† $O(n \\log n)$ çš„å¼€é”€ï¼Œä½†å¸¦æ¥çš„æœ‰åºæ€§ä½¿å¾—åç»­çš„æŸ¥æ‰¾å’Œå»é‡æ•ˆç‡å‘ˆæŒ‡æ•°çº§ä¼˜åŒ–ã€‚æ­¤å¤–ï¼Œå‰ªææ€æƒ³åœ¨ä»»ä½•æœç´¢ç±»ç®—æ³•ä¸­éƒ½æ˜¯æå‡æ€§èƒ½çš„å…³é”®â€”â€”æ°¸è¿œä¸è¦è®¡ç®—é‚£äº›æ³¨å®šæ— æ•ˆçš„ç»“æœã€‚\n","permalink":"https://jackcipher.github.io/leetcode/leetcode-sum-topic/","summary":"\u003cp\u003eæ•°ç»„æ±‚å’Œé—®é¢˜ï¼ˆN-Sumï¼‰æ˜¯ç®—æ³•é¢è¯•ä¸­ç»ä¹…ä¸è¡°çš„ç»å…¸é¢˜å‹ã€‚ä»æœ€åŸºç¡€çš„ \u003cstrong\u003eTwo Sum\u003c/strong\u003e åˆ°è¿›é˜¶çš„ \u003cstrong\u003ekSum\u003c/strong\u003eï¼Œå…¶æ ¸å¿ƒæœ¬è´¨å¾€å¾€æ®Šé€”åŒå½’ã€‚æœ¬æ–‡å°†ä»¥èµ„æ·±å·¥ç¨‹å¸ˆçš„è§†è§’ï¼Œç³»ç»Ÿæ¢³ç† \u003cstrong\u003e2Sumã€3Sumã€3Sum Closest\u003c/strong\u003e åŠ \u003cstrong\u003e4Sum\u003c/strong\u003e çš„è§£é¢˜æ¼”è¿›ä¹‹è·¯ï¼Œæ¢è®¨å¦‚ä½•é€šè¿‡\u003cstrong\u003eåŒæŒ‡é’ˆ\u003c/strong\u003eä¸\u003cstrong\u003eå‰ªæç­–ç•¥\u003c/strong\u003eå°†æ—¶é—´å¤æ‚åº¦å‹æ¦¨è‡³æé™ã€‚\u003c/p\u003e","title":"æ•°ç»„æ±‚å’Œç³»åˆ—è¯¦è§£ä¸åˆ†æ"},{"content":"ä¸é¢‘ç‡ç›¸å…³çš„è€ƒé¢˜ 1 2 3 4 5 6 113. ç”¨é€šå¸¸çš„è°ƒé¢‘æ–¹å¼è¿›è¡Œè¯éŸ³é€šä¿¡ï¼Œå¿…è¦å¸¦å®½çº¦ä¸ºï¼šÂ [LK0123] A. 6.25kHz B. 2700Hz C. 200Hz D. 12.5kHz 1 2 3 4 5 6 0123. æˆ‘å›½åˆ†é…ç»™ä¸šä½™ä¸šåŠ¡å’Œå«æ˜Ÿä¸šä½™ä¸šåŠ¡ä¸“ç”¨çš„é¢‘æ®µæœ‰ï¼šÂ [LK0144] A. 7MHzã€14MHzã€21MHzã€28MHzã€47GHzé¢‘æ®µ B. 7MHzã€14MHzã€21MHzã€28MHzã€144MHzé¢‘æ®µ C. 3.5MHzã€14MHzã€21MHzã€28MHzã€10GHzé¢‘æ®µ D. 7MHzã€14MHzã€28MHzã€144MHzã€430MHzé¢‘æ®µ 1 2 3 4 5 6 0124. æˆ‘å›½åœ¨VHFå’ŒUHFèŒƒå›´å†…åˆ†é…ç»™ä¸šä½™ä¸šåŠ¡å’Œå«æ˜Ÿä¸šä½™ä¸šåŠ¡ä¸å…¶ä»–ä¸šåŠ¡å…±ç”¨å¹¶è®¾ä¸šåŠ¡ç±»åˆ«ä¸ºä¸»è¦ä¸šåŠ¡ä¸æ¬¡è¦ä¸šåŠ¡ï¼Œä»¥ä¸‹é‚£äº›é¢‘ç‡åˆ†é…ç»™ä¸šä½™ä¸šåŠ¡å’Œå«æ˜Ÿä¸šä½™ä¸šåŠ¡ä¸å…¶ä»–ä¸šåŠ¡å…±ç”¨å¹¶ä¸”ä¸šä½™ä¸šåŠ¡å’Œå«æ˜Ÿä¸šä½™ä¸šåŠ¡ä½œä¸ºä¸»è¦ä¸šåŠ¡ï¼šÂ [LK0146] A. 50MHzã€144MHz B. 144MHzã€430MHz C. 50MHzã€430MHz D. 220MHzã€430MHz 1 2 3 4 5 6 0125. æˆ‘å›½åˆ†é…ç»™ä¸šä½™ä¸šåŠ¡å’Œå«æ˜Ÿä¸šä½™ä¸šåŠ¡ä¸å…¶ä»–ä¸šåŠ¡å…±ç”¨ã€å¹¶ä¸”ä¸šä½™ä¸šåŠ¡å’Œå«æ˜Ÿä¸šä½™ä¸šåŠ¡ä½œä¸ºå”¯ä¸€ä¸»è¦ä¸šåŠ¡çš„é¢‘æ®µçš„ä¸ªæ•°ä»¥åŠåœ¨3GHzä»¥ä¸‹çš„è¯¥ç±»é¢‘æ®µåˆ†åˆ«ä¸ºï¼šÂ [LK0147] A. 3ä¸ªï¼Œ144-146MHz B. 4ä¸ªï¼Œ7.0-7.2MHz C. 5ä¸ªï¼Œ50-54MHz D. 5ä¸ªï¼Œ28-29.7MHz 1 2 3 4 5 6 0126. æˆ‘å›½åˆ†é…ç»™ä¸šä½™ä¸šåŠ¡å’Œå«æ˜Ÿä¸šä½™ä¸šåŠ¡ä¸å…¶ä»–ä¸šåŠ¡å…±ç”¨ã€å¹¶ä¸”ä¸šä½™ä¸šåŠ¡å’Œå«æ˜Ÿä¸šä½™ä¸šåŠ¡ä½œä¸ºæ¬¡è¦ä¸šåŠ¡çš„1200MHzä»¥ä¸‹é¢‘æ®µæœ‰ï¼šÂ [LK0148] A. 135.7kHzã€10.1MHzã€430MHz B. 3.5MHzã€7MHzã€50MHz C. 3.5MHzã€18.068MHzã€144MHz D. 10.1MHzã€24.89MHzã€430MHz 1 2 3 4 5 6 0127. ä¿—ç§°çš„6ç±³ä¸šä½™æ³¢æ®µçš„é¢‘ç‡èŒƒå›´ä»¥åŠä¸šä½™ä¸šåŠ¡å’Œå«æ˜Ÿä¸šä½™ä¸šåŠ¡çš„ä½¿ç”¨çŠ¶æ€åˆ†åˆ«ä¸ºï¼šÂ [LK0157] A. 50-54MHzï¼Œä¸»è¦ä¸šåŠ¡ B. 50-52MHzï¼Œæ¬¡è¦ä¸šåŠ¡ C. 51-54MHzï¼Œä¸“ç”¨ D. 52-56MHzï¼Œæ¬¡è¦ä¸šåŠ¡ 1 2 3 4 5 6 0128. ä¿—ç§°çš„2ç±³ä¸šä½™æ³¢æ®µçš„é¢‘ç‡èŒƒå›´ä»¥åŠæˆ‘å›½ä¸šä½™ä¸šåŠ¡å’Œå«æ˜Ÿä¸šä½™ä¸šåŠ¡çš„ä½¿ç”¨çŠ¶æ€åˆ†åˆ«ä¸ºï¼šÂ [LK0158] A. 144-148MHzï¼›å…¶ä¸­144-146MHzä¸ºå”¯ä¸€ä¸»è¦ä¸šåŠ¡ï¼Œ146-148MHzä¸ºä¸å…¶ä»–ä¸šåŠ¡å…±åŒä½œä¸ºä¸»è¦ä¸šåŠ¡ B. 144-146MHzï¼›ä¸“ç”¨ C. 144-148MHzï¼›å…¶ä¸­144-146MHzä¸ºä¸“ç”¨ï¼Œ146-148MHzä¸ºæ¬¡è¦ä¸šåŠ¡ D. 144-148MHzï¼›æ¬¡è¦ä¸šåŠ¡ 1 2 3 4 5 6 0129. ä¿—ç§°çš„0.7ç±³ä¸šä½™æ³¢æ®µçš„é¢‘ç‡èŒƒå›´ä»¥åŠä¸šä½™ä¸šåŠ¡å’Œå«æ˜Ÿä¸šä½™ä¸šåŠ¡çš„ä½¿ç”¨çŠ¶æ€åˆ†åˆ«ä¸ºï¼šÂ [LK0159] A. 430-440MHzï¼Œæ¬¡è¦ä¸šåŠ¡ B. 430-440MHzï¼Œä¸»è¦ä¸šåŠ¡ C. 430-440MHzï¼Œä¸“ç”¨ D. 420-470MHzï¼Œæ¬¡è¦ä¸šåŠ¡ 1 2 3 4 5 6 0130. åœ¨æˆ‘å›½å’Œå¤šæ•°å…¶ä»–å›½å®¶çš„é¢‘ç‡åˆ†é…ä¸­ï¼Œä¸šä½™ä¸šåŠ¡åœ¨430-440MHzé¢‘æ®µä¸­ä½œä¸ºæ¬¡è¦ä¸šåŠ¡ä¸å…¶ä»–ä¸šåŠ¡å…±ç”¨ã€‚è¿™ä¸ªé¢‘æ®µä¸­æˆ‘å›½åˆ†é…çš„ä¸»è¦ä¸šåŠ¡æ˜¯ï¼šÂ [LK0160] A. æ— çº¿ç”µå®šä½å’Œèˆªç©ºæ— çº¿ç”µå¯¼èˆª B. å›ºå®šä¸šåŠ¡ C. ç§»åŠ¨ä¸šåŠ¡ D. æ°´ä¸Šç§»åŠ¨å’Œèˆªç©ºç§»åŠ¨ 1 2 3 4 5 6 0131. VHFä¸šä½™æ— çº¿ç”µå°åœ¨144MHzé¢‘æ®µè¿›è¡Œæœ¬åœ°è”ç»œæ—¶åº”é¿å…å ç”¨çš„é¢‘ç‡ä¸ºï¼šÂ [LK0171] A. 144-144.035MHzå’Œ145.8-146MHz B. 144.035-145.8MHz C. 144.050-144.053MHzå’Œ145.100-145.750MHz D. 144.035-144.053MHzå’Œ145.550-145.750MHz 1 2 3 4 5 6 0132. UHFä¸šä½™æ— çº¿ç”µå°åœ¨430MHzé¢‘æ®µè¿›è¡Œæœ¬åœ°è”ç»œæ—¶åº”é¿å…å ç”¨çš„é¢‘ç‡ä¸ºï¼šÂ [LK0172] A. 431.9-432.240MHzå’Œ435-438MHz B. 430-431.9MHzå’Œ432.240-435MHz C. 431-432MHzå’Œ438-440MHz D. 430-431.2MHzå’Œ435-436MHz ","permalink":"https://jackcipher.github.io/radio/radio-frequency-exam/","summary":"\u003ch2 id=\"ä¸é¢‘ç‡ç›¸å…³çš„è€ƒé¢˜\"\u003eä¸é¢‘ç‡ç›¸å…³çš„è€ƒé¢˜\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e113. ç”¨é€šå¸¸çš„è°ƒé¢‘æ–¹å¼è¿›è¡Œè¯éŸ³é€šä¿¡ï¼Œå¿…è¦å¸¦å®½çº¦ä¸ºï¼šÂ [LK0123]\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eA. 6.25kHz\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eB. 2700Hz\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eC. 200Hz\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eD. 12.5kHz\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e0123. æˆ‘å›½åˆ†é…ç»™ä¸šä½™ä¸šåŠ¡å’Œå«æ˜Ÿä¸šä½™ä¸šåŠ¡ä¸“ç”¨çš„é¢‘æ®µæœ‰ï¼šÂ [LK0144]\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eA. 7MHzã€14MHzã€21MHzã€28MHzã€47GHzé¢‘æ®µ\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eB. 7MHzã€14MHzã€21MHzã€28MHzã€144MHzé¢‘æ®µ\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eC. 3.5MHzã€14MHzã€21MHzã€28MHzã€10GHzé¢‘æ®µ\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eD. 7MHzã€14MHzã€28MHzã€144MHzã€430MHzé¢‘æ®µ\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e0124. æˆ‘å›½åœ¨VHFå’ŒUHFèŒƒå›´å†…åˆ†é…ç»™ä¸šä½™ä¸šåŠ¡å’Œå«æ˜Ÿä¸šä½™ä¸šåŠ¡ä¸å…¶ä»–ä¸šåŠ¡å…±ç”¨å¹¶è®¾ä¸šåŠ¡ç±»åˆ«ä¸ºä¸»è¦ä¸šåŠ¡ä¸æ¬¡è¦ä¸šåŠ¡ï¼Œä»¥ä¸‹é‚£äº›é¢‘ç‡åˆ†é…ç»™ä¸šä½™ä¸šåŠ¡å’Œå«æ˜Ÿä¸šä½™ä¸šåŠ¡ä¸å…¶ä»–ä¸šåŠ¡å…±ç”¨å¹¶ä¸”ä¸šä½™ä¸šåŠ¡å’Œå«æ˜Ÿä¸šä½™ä¸šåŠ¡ä½œä¸ºä¸»è¦ä¸šåŠ¡ï¼šÂ [LK0146]\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eA. 50MHzã€144MHz\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eB. 144MHzã€430MHz\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eC. 50MHzã€430MHz\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eD. 220MHzã€430MHz\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e0125. æˆ‘å›½åˆ†é…ç»™ä¸šä½™ä¸šåŠ¡å’Œå«æ˜Ÿä¸šä½™ä¸šåŠ¡ä¸å…¶ä»–ä¸šåŠ¡å…±ç”¨ã€å¹¶ä¸”ä¸šä½™ä¸šåŠ¡å’Œå«æ˜Ÿä¸šä½™ä¸šåŠ¡ä½œä¸ºå”¯ä¸€ä¸»è¦ä¸šåŠ¡çš„é¢‘æ®µçš„ä¸ªæ•°ä»¥åŠåœ¨3GHzä»¥ä¸‹çš„è¯¥ç±»é¢‘æ®µåˆ†åˆ«ä¸ºï¼šÂ [LK0147]\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eA. 3ä¸ªï¼Œ144-146MHz\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eB. 4ä¸ªï¼Œ7.0-7.2MHz\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eC. 5ä¸ªï¼Œ50-54MHz\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eD. 5ä¸ªï¼Œ28-29.7MHz\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e0126. æˆ‘å›½åˆ†é…ç»™ä¸šä½™ä¸šåŠ¡å’Œå«æ˜Ÿä¸šä½™ä¸šåŠ¡ä¸å…¶ä»–ä¸šåŠ¡å…±ç”¨ã€å¹¶ä¸”ä¸šä½™ä¸šåŠ¡å’Œå«æ˜Ÿä¸šä½™ä¸šåŠ¡ä½œä¸ºæ¬¡è¦ä¸šåŠ¡çš„1200MHzä»¥ä¸‹é¢‘æ®µæœ‰ï¼šÂ [LK0148]\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eA. 135.7kHzã€10.1MHzã€430MHz\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eB. 3.5MHzã€7MHzã€50MHz\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eC. 3.5MHzã€18.068MHzã€144MHz\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eD. 10.1MHzã€24.89MHzã€430MHz\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e0127. ä¿—ç§°çš„6ç±³ä¸šä½™æ³¢æ®µçš„é¢‘ç‡èŒƒå›´ä»¥åŠä¸šä½™ä¸šåŠ¡å’Œå«æ˜Ÿä¸šä½™ä¸šåŠ¡çš„ä½¿ç”¨çŠ¶æ€åˆ†åˆ«ä¸ºï¼šÂ [LK0157]\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eA. 50-54MHzï¼Œä¸»è¦ä¸šåŠ¡\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eB. 50-52MHzï¼Œæ¬¡è¦ä¸šåŠ¡\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eC. 51-54MHzï¼Œä¸“ç”¨\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eD. 52-56MHzï¼Œæ¬¡è¦ä¸šåŠ¡\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e0128. ä¿—ç§°çš„2ç±³ä¸šä½™æ³¢æ®µçš„é¢‘ç‡èŒƒå›´ä»¥åŠæˆ‘å›½ä¸šä½™ä¸šåŠ¡å’Œå«æ˜Ÿä¸šä½™ä¸šåŠ¡çš„ä½¿ç”¨çŠ¶æ€åˆ†åˆ«ä¸ºï¼šÂ [LK0158]\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eA. 144-148MHzï¼›å…¶ä¸­144-146MHzä¸ºå”¯ä¸€ä¸»è¦ä¸šåŠ¡ï¼Œ146-148MHzä¸ºä¸å…¶ä»–ä¸šåŠ¡å…±åŒä½œä¸ºä¸»è¦ä¸šåŠ¡\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eB. 144-146MHzï¼›ä¸“ç”¨\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eC. 144-148MHzï¼›å…¶ä¸­144-146MHzä¸ºä¸“ç”¨ï¼Œ146-148MHzä¸ºæ¬¡è¦ä¸šåŠ¡\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eD. 144-148MHzï¼›æ¬¡è¦ä¸šåŠ¡\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e0129. ä¿—ç§°çš„0.7ç±³ä¸šä½™æ³¢æ®µçš„é¢‘ç‡èŒƒå›´ä»¥åŠä¸šä½™ä¸šåŠ¡å’Œå«æ˜Ÿä¸šä½™ä¸šåŠ¡çš„ä½¿ç”¨çŠ¶æ€åˆ†åˆ«ä¸ºï¼šÂ [LK0159]\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eA. 430-440MHzï¼Œæ¬¡è¦ä¸šåŠ¡\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eB. 430-440MHzï¼Œä¸»è¦ä¸šåŠ¡\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eC. 430-440MHzï¼Œä¸“ç”¨\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eD. 420-470MHzï¼Œæ¬¡è¦ä¸šåŠ¡\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e0130. åœ¨æˆ‘å›½å’Œå¤šæ•°å…¶ä»–å›½å®¶çš„é¢‘ç‡åˆ†é…ä¸­ï¼Œä¸šä½™ä¸šåŠ¡åœ¨430-440MHzé¢‘æ®µä¸­ä½œä¸ºæ¬¡è¦ä¸šåŠ¡ä¸å…¶ä»–ä¸šåŠ¡å…±ç”¨ã€‚è¿™ä¸ªé¢‘æ®µä¸­æˆ‘å›½åˆ†é…çš„ä¸»è¦ä¸šåŠ¡æ˜¯ï¼šÂ [LK0160]\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eA. æ— çº¿ç”µå®šä½å’Œèˆªç©ºæ— çº¿ç”µå¯¼èˆª\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eB. å›ºå®šä¸šåŠ¡\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eC. ç§»åŠ¨ä¸šåŠ¡\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eD. æ°´ä¸Šç§»åŠ¨å’Œèˆªç©ºç§»åŠ¨\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e0131. VHFä¸šä½™æ— çº¿ç”µå°åœ¨144MHzé¢‘æ®µè¿›è¡Œæœ¬åœ°è”ç»œæ—¶åº”é¿å…å ç”¨çš„é¢‘ç‡ä¸ºï¼šÂ [LK0171]\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eA. 144-144.035MHzå’Œ145.8-146MHz\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eB. 144.035-145.8MHz\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eC. 144.050-144.053MHzå’Œ145.100-145.750MHz\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eD. 144.035-144.053MHzå’Œ145.550-145.750MHz\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e0132. UHFä¸šä½™æ— çº¿ç”µå°åœ¨430MHzé¢‘æ®µè¿›è¡Œæœ¬åœ°è”ç»œæ—¶åº”é¿å…å ç”¨çš„é¢‘ç‡ä¸ºï¼šÂ [LK0172]\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eA. 431.9-432.240MHzå’Œ435-438MHz\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eB. 430-431.9MHzå’Œ432.240-435MHz\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eC. 431-432MHzå’Œ438-440MHz\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eD. 430-431.2MHzå’Œ435-436MHz\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e","title":"æ— çº¿ç”µè€ƒè¯•ä¸­é¢‘ç‡ç›¸å…³çš„è€ƒé¢˜"},{"content":"é—®é¢˜å¤ç° æœ€è¿‘åœ¨ Code Review æ—¶å‘ç°äº†ä¸€ä¸ªæœ‰è¶£çš„æ¡ˆä¾‹ã€‚ä»£ç é€»è¾‘æ¸…æ™°ï¼Œæµ‹è¯•ä¹Ÿè¦†ç›–äº†ä¸»è¦åˆ†æ”¯,ä½†åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ errors.Is çš„è¡Œä¸ºä¸é¢„æœŸä¸ç¬¦:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 type Error struct { ErrorCode int Message string } func (e Error) Error() string { return e.Message } var ErrTest = Error{ErrorCode: 100301, Message: \u0026#34;è¯·æ±‚å¤±è´¥\u0026#34;} func getErr() error { return ErrTest } func main() { err := getErr() if errors.Is(err, ErrTest) { fmt.Println(\u0026#34;ok\u0026#34;) } else { fmt.Println(\u0026#34;failed\u0026#34;) // å®é™…è¾“å‡º } } é¢„æœŸè¾“å‡º \u0026ldquo;ok\u0026rdquo;,å®é™…å´è¾“å‡º \u0026ldquo;failed\u0026rdquo;ã€‚è¿™ä¸ªé—®é¢˜æš´éœ²äº† Go é”™è¯¯å¤„ç†æœºåˆ¶ä¸­ä¸€ä¸ªå¸¸è¢«å¿½è§†çš„ç»†èŠ‚ã€‚\næ ¹å› åˆ†æ errors.Is çš„æ¯”è¾ƒè¯­ä¹‰ errors.Is çš„å®ç°éµå¾ªä»¥ä¸‹ä¼˜å…ˆçº§:\nå¼•ç”¨ç›¸ç­‰æ€§æ£€æŸ¥: ä½¿ç”¨ - è¿ç®—ç¬¦æ¯”è¾ƒ err å’Œ target è‡ªå®šä¹‰ç›¸ç­‰æ€§: å¦‚æœ err å®ç°äº† Is(error) bool æ–¹æ³•,å§”æ‰˜ç»™è¯¥æ–¹æ³• é”™è¯¯é“¾éå†: å¦‚æœ err å®ç°äº† Unwrap() error,é€’å½’æ£€æŸ¥åŒ…è£…çš„é”™è¯¯ å…³é”®åœ¨äºç¬¬ä¸€æ­¥çš„ - æ¯”è¾ƒã€‚å¯¹äºæ¥å£ç±»å‹,- è¿ç®—ç¬¦çš„è¯­ä¹‰æ˜¯:\nåŠ¨æ€ç±»å‹å¿…é¡»ç›¸åŒ åŠ¨æ€å€¼å¿…é¡»å¯æ¯”è¾ƒä¸”ç›¸ç­‰ å€¼ç±»å‹ä¸æ¥å£çš„äº¤äº’ é—®é¢˜çš„æ ¹æºåœ¨äº å€¼ç±»å‹èµ‹å€¼ç»™æ¥å£æ—¶çš„å¤åˆ¶è¯­ä¹‰:\n1 2 3 4 5 var ErrTest = Error{...} // å€¼ç±»å‹ func getErr() error { return ErrTest // å‘ç”Ÿå€¼å¤åˆ¶,åˆ›å»ºæ–°å®ä¾‹ } å½“å€¼ç±»å‹èµ‹å€¼ç»™æ¥å£æ—¶:\nGo ä¼šåˆ›å»ºè¯¥å€¼çš„å‰¯æœ¬ å‰¯æœ¬è¢«å°è£…åœ¨æ¥å£çš„åŠ¨æ€å€¼ä¸­ è™½ç„¶å†…å®¹ç›¸åŒ,ä½†åœ¨å†…å­˜ä¸­æ˜¯ä¸¤ä¸ªä¸åŒçš„å®ä¾‹ å› æ­¤ errors.Is(err, ErrTest) æ¯”è¾ƒçš„æ˜¯:\nerr ä¸­çš„å‰¯æœ¬ å…¨å±€å˜é‡ ErrTest çš„åŸå§‹å€¼ ç”±äºå®ƒä»¬æ˜¯ä¸åŒçš„å®ä¾‹,æ¯”è¾ƒå¤±è´¥ã€‚\nè§£å†³æ–¹æ¡ˆ æ–¹æ¡ˆä¸€:ä½¿ç”¨æŒ‡é’ˆç±»å‹(æ¨è) 1 2 3 4 5 var ErrTest = \u0026amp;Error{ErrorCode: 100301, Message: \u0026#34;è¯·æ±‚å¤±è´¥\u0026#34;} func getErr() error { return ErrTest // è¿”å›åŒä¸€ä¸ªæŒ‡é’ˆ } ä¼˜åŠ¿:\næŒ‡é’ˆèµ‹å€¼ç»™æ¥å£æ—¶,åŠ¨æ€å€¼æ˜¯æŒ‡é’ˆæœ¬èº«,ä¸ä¼šåˆ›å»ºæ–°å®ä¾‹ å¤šæ¬¡è¿”å›åŒä¸€ä¸ªé”™è¯¯å˜é‡æ—¶,éƒ½æŒ‡å‘åŒä¸€ä¸ªå†…å­˜åœ°å€ ç¬¦åˆ Go æ ‡å‡†åº“çš„æƒ¯ç”¨æ¨¡å¼(å¦‚ io.EOF, sql.ErrNoRows) æ–¹æ¡ˆäºŒ:å®ç° Is æ–¹æ³• 1 2 3 4 5 6 7 func (e Error) Is(target error) bool { t, ok := target.(Error) if !ok { return false } return e.ErrorCode == t.ErrorCode } é€‚ç”¨åœºæ™¯:\néœ€è¦è‡ªå®šä¹‰ç›¸ç­‰æ€§è¯­ä¹‰(å¦‚åªæ¯”è¾ƒé”™è¯¯ç ) éœ€è¦æ”¯æŒé”™è¯¯ç çš„èŒƒå›´åŒ¹é… å‘åå…¼å®¹å·²æœ‰çš„å€¼ç±»å‹é”™è¯¯å®šä¹‰ æ³¨æ„äº‹é¡¹:\nå¿…é¡»åŒæ—¶å¤„ç†å€¼ç±»å‹å’ŒæŒ‡é’ˆç±»å‹çš„ target éœ€è¦æ˜ç¡®å®šä¹‰\u0026quot;ç›¸ç­‰\u0026quot;çš„ä¸šåŠ¡è¯­ä¹‰ errors.As çš„æ­£ç¡®ä½¿ç”¨ ç±»å‹æ–­è¨€çš„è¯­ä¹‰ errors.As çš„å‡½æ•°ç­¾åæ˜¯:\n1 func As(err error, target interface{}) bool target å¿…é¡»æ˜¯æŒ‡å‘é”™è¯¯ç±»å‹çš„æŒ‡é’ˆ,å³ *E æˆ– *interface{}ã€‚\næ­£ç¡®ç”¨æ³• 1 2 3 4 var customErr *Error if errors.As(err, \u0026amp;customErr) { fmt.Printf(\u0026#34;ErrorCode: %d\\n\u0026#34;, customErr.ErrorCode) } è¿™é‡Œ \u0026amp;customErr çš„ç±»å‹æ˜¯ **Error,Go å†…éƒ¨ä¼š:\néå†é”™è¯¯é“¾,æŸ¥æ‰¾ç±»å‹ä¸º *Error çš„å€¼ å°†æ‰¾åˆ°çš„å€¼èµ‹ç»™ customErr å¸¸è§é”™è¯¯ 1 2 3 4 5 6 7 // é”™è¯¯ç”¨æ³• 1: ä¸ä¼ é€’æŒ‡é’ˆ var customErr Error errors.As(err, customErr) // ç¼–è¯‘é”™è¯¯ // é”™è¯¯ç”¨æ³• 2: ç±»å‹ä¸åŒ¹é… var customErr Error errors.As(err, \u0026amp;customErr) // æŸ¥æ‰¾ Error å€¼ç±»å‹,ä½†é“¾ä¸­åªæœ‰ *Error æœ€ä½³å®è·µ å“¨å…µé”™è¯¯ä½¿ç”¨æŒ‡é’ˆç±»å‹\n1 var ErrNotFound = \u0026amp;NotFoundError{...} é”™è¯¯ç±»å‹å®ç° Is æ–¹æ³•æ—¶è€ƒè™‘å€¼å’ŒæŒ‡é’ˆä¸¤ç§æƒ…å†µ\n1 2 3 4 5 6 7 8 9 10 11 12 func (e *Error) Is(target error) bool { t, ok := target.(*Error) if !ok { // å°è¯•å€¼ç±»å‹ if tv, ok := target.(Error); ok { t = \u0026amp;tv } else { return false } } return e.ErrorCode == t.ErrorCode } ä½¿ç”¨ errors.As æ—¶æ˜ç¡®ç›®æ ‡ç±»å‹\n1 2 3 4 5 // æ¸…æ™°æ˜ç¡® var netErr *net.OpError if errors.As(err, \u0026amp;netErr) { // å¤„ç†ç½‘ç»œé”™è¯¯ } é¿å…åœ¨æ¥å£æ–¹æ³•ä¸­è¿”å›å…·ä½“çš„é”™è¯¯å€¼\n1 2 3 4 5 6 7 8 9 // ä¸æ¨è func (s *Service) Process() error { return ErrorValue // æ¯æ¬¡è¿”å›éƒ½æ˜¯æ–°å‰¯æœ¬ } // æ¨è func (s *Service) Process() error { return ErrPointer // å§‹ç»ˆæ˜¯åŒä¸€ä¸ªå®ä¾‹ } æ€»ç»“ Go çš„é”™è¯¯å¤„ç†æœºåˆ¶çœ‹ä¼¼ç®€å•,ä½†æ¶‰åŠåˆ°æ¥å£ã€å€¼è¯­ä¹‰ã€æŒ‡é’ˆè¯­ä¹‰çš„äº¤äº’æ—¶,å®¹æ˜“äº§ç”Ÿåç›´è§‰çš„è¡Œä¸ºã€‚ç†è§£ errors.Is å’Œ errors.As çš„åº•å±‚å®ç°é€»è¾‘,èƒ½å¤Ÿå¸®åŠ©æˆ‘ä»¬:\næ­£ç¡®è®¾è®¡é”™è¯¯ç±»å‹ é¿å…é”™è¯¯æ¯”è¾ƒå¤±è´¥çš„é—®é¢˜ ç¼–å†™æ›´å¥å£®çš„é”™è¯¯å¤„ç†ä»£ç  å…³é”®è¦è®°ä½:åœ¨ Go ä¸­,å“¨å…µé”™è¯¯åº”è¯¥ç”¨æŒ‡é’ˆ,é”™è¯¯æ¯”è¾ƒä¸ä»…ä»…æ˜¯å€¼ç›¸ç­‰ã€‚\n","permalink":"https://jackcipher.github.io/go-in-action/go-error-handling-value-semantics/","summary":"\u003ch2 id=\"é—®é¢˜å¤ç°\"\u003eé—®é¢˜å¤ç°\u003c/h2\u003e\n\u003cp\u003eæœ€è¿‘åœ¨ Code Review æ—¶å‘ç°äº†ä¸€ä¸ªæœ‰è¶£çš„æ¡ˆä¾‹ã€‚ä»£ç é€»è¾‘æ¸…æ™°ï¼Œæµ‹è¯•ä¹Ÿè¦†ç›–äº†ä¸»è¦åˆ†æ”¯,ä½†åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ \u003ccode\u003eerrors.Is\u003c/code\u003e çš„è¡Œä¸ºä¸é¢„æœŸä¸ç¬¦:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e16\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e17\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e18\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e19\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e20\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e21\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e22\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e23\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-go\" data-lang=\"go\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003etype\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nx\"\u003eError\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"kd\"\u003estruct\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nx\"\u003eErrorCode\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nx\"\u003eMessage\u003c/span\u003e\u003cspan class=\"w\"\u003e   \u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"kd\"\u003efunc\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ee\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nx\"\u003eError\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nf\"\u003eError\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"k\"\u003ereturn\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nx\"\u003ee\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eMessage\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"kd\"\u003evar\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nx\"\u003eErrTest\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nx\"\u003eError\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"nx\"\u003eErrorCode\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"mi\"\u003e100301\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nx\"\u003eMessage\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;è¯·æ±‚å¤±è´¥\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"kd\"\u003efunc\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nf\"\u003egetErr\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"kt\"\u003eerror\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"k\"\u003ereturn\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nx\"\u003eErrTest\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"kd\"\u003efunc\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nf\"\u003emain\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nx\"\u003eerr\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e:=\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nf\"\u003egetErr\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"k\"\u003eif\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nx\"\u003eerrors\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eIs\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eerr\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nx\"\u003eErrTest\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e        \u003c/span\u003e\u003cspan class=\"nx\"\u003efmt\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003ePrintln\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;ok\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eelse\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e        \u003c/span\u003e\u003cspan class=\"nx\"\u003efmt\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003ePrintln\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;failed\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"c1\"\u003e// å®é™…è¾“å‡º\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eé¢„æœŸè¾“å‡º \u0026ldquo;ok\u0026rdquo;,å®é™…å´è¾“å‡º \u0026ldquo;failed\u0026rdquo;ã€‚è¿™ä¸ªé—®é¢˜æš´éœ²äº† Go é”™è¯¯å¤„ç†æœºåˆ¶ä¸­ä¸€ä¸ªå¸¸è¢«å¿½è§†çš„ç»†èŠ‚ã€‚\u003c/p\u003e","title":"Go errors.Is å¤±æ•ˆé—®é¢˜çš„æœ¬è´¨å‰–æ"},{"content":"èƒŒæ™¯ åœ¨ office-gateway ä¸‰æœŸä¼˜åŒ–è¿‡ç¨‹ä¸­ï¼Œå¯¹ä»»åŠ¡æ•°æ®å®ç°äº†ç¼“å­˜æœºåˆ¶ï¼Œæ—¨åœ¨æé«˜æŸ¥è¯¢æ€§èƒ½ã€‚è€ƒè™‘åˆ°æ•°æ®å†™æ“ä½œé¢‘ç¹ï¼Œä¸”å½“å‰ä»…æœ‰ä¸€ä¸ªæ¥å£è´Ÿè´£è¯»å–ï¼Œå±äºå…¸å‹çš„å†™å¤šè¯»å°‘åœºæ™¯ã€‚äºæ˜¯å†³å®šé€‰ç”¨ GORM çš„ Hook æœºåˆ¶æ¥æ›´æ–°ç¼“å­˜ã€‚\nå®ç°æ–¹æ¡ˆ åœ¨ Model ç»“æ„ä½“ä¸Šå®ç° GORM çš„ AfterUpdate å’Œ AfterCreate æ–¹æ³•ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 func (c *GatewayTasks) AfterUpdate(tx *gorm.DB) error { err := invokerbase.TaskCache.SetMainTaskCache(context.Background(), c.TaskID, c.TaskType, c.Bytes()) if err != nil { elog.Error(\u0026#34;hook.GatewayTasks.SetCache.failed\u0026#34;, l.E(err)) } return nil } func (c *GatewayTasks) AfterCreate(tx *gorm.DB) error { err := invokerbase.TaskCache.SetMainTaskCache(context.Background(), c.TaskID, c.TaskType, c.Bytes()) if err != nil { elog.Error(\u0026#34;hook.GatewayTasks.SetCache.failed\u0026#34;, l.E(err)) } return nil } é—®é¢˜è¯Šæ–­ ä»£ç å‘å¸ƒåï¼Œæˆ‘ä»¬å‘ç°äº†ä»¥ä¸‹å¼‚å¸¸ï¼š\nç¼“å­˜æ›´æ–°ä»…åœ¨åˆ›å»ºæ•°æ®æ—¶ç”Ÿæ•ˆ æ›´æ–°æ•°æ®è¡¨æ—¶è™½ç„¶è§¦å‘äº† Hook å‡½æ•°ï¼Œä½†å†™å…¥çš„æ•°æ®ä¸æ­£ç¡® æµ‹è¯•åé¦ˆè·å–è¿›åº¦éå¸¸ç¼“æ…¢ï¼Œä¸è®ºæ–‡ä»¶å¤§å°ï¼Œè€—æ—¶å‡çº¦ 5s é—®é¢˜åˆ†æ é€šè¿‡è§‚å¯Ÿå‘ç°ï¼š\næ–°éƒ¨ç½²æœºå™¨è§„æ ¼è¾ƒé«˜ï¼Œè½¬ç æ—¶é—´å¾ˆå¿« ç¼“å­˜è¿‡æœŸæ—¶é—´ä¸º 5s æ–‡ä»¶å¤§å°ä¸åŒï¼Œè½¬ç è€—æ—¶å´ä¿æŒä¸€è‡´ è¿™äº›ç°è±¡å¼ºçƒˆæš—ç¤ºå¯èƒ½å­˜åœ¨ç¼“å­˜è„æ•°æ®é—®é¢˜ï¼Œå¯¼è‡´æµç¨‹æ— æ³•æ­£å¸¸ç»“æŸã€‚ä»…åœ¨ç¼“å­˜è¿‡æœŸåï¼Œç³»ç»Ÿæ‰èƒ½ç©¿é€åˆ°æ•°æ®è¡¨è·å–æœ€ç»ˆç»“æœã€‚\næºç åˆ†æ GORM å›è°ƒæœºåˆ¶ç®€è¿° GORM çš„ Update æ–¹æ³•å®è´¨ä¸Šæ˜¯è§¦å‘ä¸€ç³»åˆ—å›è°ƒå‡½æ•°ï¼Œè€Œéç›´æ¥æ‰§è¡Œ SQLï¼š\n1 2 3 4 5 6 // Update updates column with value using callbacks. Reference: \u0026lt;https://gorm.io/docs/update.html#Update-Changed-Fieldsfunc\u0026gt; (db *DB) Update(column string, value interface{}) (tx *DB) { tx = db.getInstance() tx.Statement.Dest = map[string]interface{}{column: value} return tx.callbacks.Update().Execute(tx) } å›è°ƒæ³¨å†Œä¸æ‰§è¡Œ gorm.Open æ—¶ä¼šåˆå§‹åŒ– Dialecter Dialecter åˆå§‹åŒ–æ—¶é€šè¿‡ RegisterDefaultCallbacks æ³¨å†Œé»˜è®¤å›è°ƒå‡½æ•° after_update å°±æ˜¯åœ¨è¿™é‡Œåˆå§‹åŒ–çš„ æ‰§è¡Œé¡ºåºç”± sortCallbacks å†³å®šå›è°ƒæ‰§è¡Œé¡ºåº ä¸åŒç±»å‹çš„å›è°ƒï¼ˆå¦‚ before_updateã€after_updateï¼‰åœ¨æ•°æ®åº“æ“ä½œçš„ä¸åŒé˜¶æ®µè¢«è§¦å‘ AfterUpdate å®šä¹‰ é€šè¿‡ AfterUpdate æ¥çœ‹ï¼Œä¼ ç»™è‡ªå®šä¹‰å›è°ƒå‡½æ•°ä¸­çš„ Model æœ¬è´¨ä¸Šæ˜¯å‚æ•° iï¼Œè€Œ i çš„å€¼æ˜¯ callmethod é€šè¿‡ value ç»™çš„ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 // AfterUpdate after update hooksfunc AfterUpdate(db *gorm.DB) { if db.Error == nil \u0026amp;\u0026amp; db.Statement.Schema != nil \u0026amp;\u0026amp; !db.Statement.SkipHooks \u0026amp;\u0026amp; (db.Statement.Schema.AfterSave || db.Statement.Schema.AfterUpdate) { callMethod(db, func(value interface{}, tx *gorm.DB) (called bool) { if db.Statement.Schema.AfterUpdate { if i, ok := value.(AfterUpdateInterface); ok { called = true db.AddError(i.AfterUpdate(tx)) } } if db.Statement.Schema.AfterSave { if i, ok := value.(AfterSaveInterface); ok { called = true db.AddError(i.AfterSave(tx)) } } return called }) } } å†çœ‹ callmethod æ–¹æ³•çš„å®šä¹‰ï¼Œä¸éš¾å‘ç°ï¼Œdb.Statement.ReflectValue æœ€ç»ˆä¼šå½±å“ value çš„å€¼ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 func callMethod(db *gorm.DB, fc func(value interface{}, tx *gorm.DB) bool) { tx := db.Session(\u0026amp;gorm.Session{NewDB: true}) if called := fc(db.Statement.ReflectValue.Interface(), tx); !called { switch db.Statement.ReflectValue.Kind() { case reflect.Slice, reflect.Array: db.Statement.CurDestIndex = 0 for i := 0; i \u0026lt; db.Statement.ReflectValue.Len(); i++ { if value := reflect.Indirect(db.Statement.ReflectValue.Index(i)); value.CanAddr() { fc(value.Addr().Interface(), tx) } else { db.AddError(gorm.ErrInvalidValue) return } db.Statement.CurDestIndex++ } case reflect.Struct: if db.Statement.ReflectValue.CanAddr() { fc(db.Statement.ReflectValue.Addr().Interface(), tx) } else { db.AddError(gorm.ErrInvalidValue) } } } } ç»§ç»­è¿½è¸ªæºç å‘ç°ï¼ŒUpdate çš„ ReflectValue æ˜¯é€šè¿‡ SetupUpdateReflectValue è¿™ä¸ª Hook å‡½æ•°å®ç°çš„ï¼Œæœ€ç»ˆæ˜¯æ¥è‡ª db.Statement.Model\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 func SetupUpdateReflectValue(db *gorm.DB) { if db.Error == nil \u0026amp;\u0026amp; db.Statement.Schema != nil { if !db.Statement.ReflectValue.CanAddr() || db.Statement.Model != db.Statement.Dest { db.Statement.ReflectValue = reflect.ValueOf(db.Statement.Model) for db.Statement.ReflectValue.Kind() == reflect.Ptr { db.Statement.ReflectValue = db.Statement.ReflectValue.Elem() } if dest, ok := db.Statement.Dest.(map[string]interface{}); ok { for _, rel := range db.Statement.Schema.Relationships.BelongsTo { if _, ok := dest[rel.Name]; ok { db.AddError(rel.Field.Set(db.Statement.Context, db.Statement.ReflectValue, dest[rel.Name])) } } } } } } å…³é”®ç‚¹åœ¨äº db.Statement.Model çš„èµ‹å€¼æœºåˆ¶ï¼š\nModel æ–¹æ³•é€šå¸¸ä¼ å…¥ä¸€ä¸ªç©ºç»“æ„ä½“ï¼šdb.Model(\u0026amp;GatewayTasks{}) Update å›è°ƒåœ¨ä¸æ•°æ®åº“äº¤äº’åä¼šæ›´æ–° db.Statement.Model AfterUpdate Hook ä¸­çš„ tx å‚æ•°å³æ˜¯è¿™ä¸ªæ›´æ–°åçš„ Statement æ ¹æœ¬åŸå›  é—®é¢˜çš„æ ¹æºåœ¨äº Update è°ƒç”¨æ—¶ä»…æ›´æ–°éƒ¨åˆ†å­—æ®µï¼ˆå¦‚ taskStatusï¼‰ï¼Œè€ŒæœªåŒ…å«æ„å»ºç¼“å­˜æ‰€éœ€çš„ taskID å’Œ taskTypeã€‚è¿™å¯¼è‡´ Hook å‡½æ•°è™½ç„¶æ‰§è¡Œï¼Œä½†æ— æ³•æ­£ç¡®è®¾ç½®ç¼“å­˜ã€‚ è€Œ Create æ—¶ï¼ŒåŒ…å«äº†è¿™äº›å­—æ®µï¼Œå¯¼è‡´åœ¨ Create é˜¶æ®µäº§ç”Ÿäº†ç¼“å­˜ï¼Œåç»­çš„æ›´æ–°æ“ä½œæœªæ›´æ–°ç¼“å­˜ï¼Œå¯¼è‡´äº†è„æ•°æ®ã€‚\nè§£å†³æ–¹æ³• é€šè¿‡åˆ†æä¸šåŠ¡ä»£ç å‘ç°ï¼Œæ›´æ–°ä»»åŠ¡ä¹‹å‰ï¼Œéƒ½ä¼šå…ˆæ‹¿åˆ°ä»»åŠ¡ä¿¡æ¯ï¼Œéƒ½å…·å¤‡è·å–åˆ° Model ç»“æ„ä½“ã€‚ è°ƒæ•´æ›´æ–°é€»è¾‘ï¼š\næ›´æ–°å‰è·å–å®Œæ•´ä»»åŠ¡ä¿¡æ¯ ç›´æ¥ä¿®æ”¹ Model ä¸­éœ€è¦å˜æ›´çš„å€¼ ä½¿ç”¨å®Œæ•´ Model æ‰§è¡Œ Update æ“ä½œ æ€»ç»“ GORM ä¸ä¼šå‡­ç©ºäº§ç”Ÿæ•°æ®ï¼Œå¹¶ä¸å…·å¤‡ç±»ä¼¼ binlog çš„èƒ½åŠ› GORM Hook ä¸­çš„ Model çš„æ•°æ®ï¼Œæ˜¯ä» Update æ–¹æ³•ä¸­è§£æå‡ºæ¥çš„ åœ¨ä½¿ç”¨ Hook æ—¶ï¼Œä¸€å®šè¦æ¸…æ¥š Model ä¸­å“ªäº›å­—æ®µèƒ½å¤Ÿæ‹¿åˆ°ï¼Œå“ªäº›æ‹¿ä¸åˆ° ","permalink":"https://jackcipher.github.io/go-in-action/gorm-hook/","summary":"\u003ch1 id=\"èƒŒæ™¯\"\u003eèƒŒæ™¯\u003c/h1\u003e\n\u003cp\u003eåœ¨ office-gateway ä¸‰æœŸä¼˜åŒ–è¿‡ç¨‹ä¸­ï¼Œå¯¹ä»»åŠ¡æ•°æ®å®ç°äº†ç¼“å­˜æœºåˆ¶ï¼Œæ—¨åœ¨æé«˜æŸ¥è¯¢æ€§èƒ½ã€‚è€ƒè™‘åˆ°æ•°æ®å†™æ“ä½œé¢‘ç¹ï¼Œä¸”å½“å‰ä»…æœ‰ä¸€ä¸ªæ¥å£è´Ÿè´£è¯»å–ï¼Œå±äºå…¸å‹çš„å†™å¤šè¯»å°‘åœºæ™¯ã€‚äºæ˜¯å†³å®šé€‰ç”¨ GORM çš„ Hook æœºåˆ¶æ¥æ›´æ–°ç¼“å­˜ã€‚\u003c/p\u003e","title":"GORM Hook ä½¿ç”¨è¯¯åŒº"},{"content":"ä¼ ç»Ÿçš„é”™è¯¯å¤„ç†æ–¹å¼ åœ¨ GORM çš„ä½¿ç”¨è¿‡ç¨‹ä¸­ï¼Œgorm.ErrNotFound æ˜¯æœ€åŸºç¡€ä¸”ä½¿ç”¨æœ€å¹¿æ³›çš„é”™è¯¯ç±»å‹ã€‚ä½œä¸ºå¼€å‘è€…ï¼Œæˆ‘ä»¬ä¹ æƒ¯æ€§åœ°ä½¿ç”¨è¿™ç§æ–¹å¼æ¥å¤„ç†æŸ¥è¯¢æœªæ‰¾åˆ°è®°å½•çš„æƒ…å†µï¼š\n1 2 3 if errors.Is(err, gorm.ErrNotFound) { // å¤„ç†è®°å½•æœªæ‰¾åˆ°çš„æƒ…å†µ } è¿™ç§é”™è¯¯å¤„ç†æ–¹å¼ç®€å•ç›´æ¥ï¼Œå·²ç»æˆä¸ºäº† GORM ç”¨æˆ·çš„ä¸€ç§å¸¸è§„å®è·µã€‚\nv1.25 ç‰ˆæœ¬çš„æ–°å˜åŒ– æ–°å¢çš„ ErrDuplicateKey åœ¨ v1.25 ç‰ˆæœ¬ä¸­ï¼ŒGORM å¼•å…¥äº†æ–°çš„é”™è¯¯ç±»å‹ ErrDuplicateKeyï¼Œç”¨äºå¤„ç†å”¯ä¸€é”®å†²çªçš„åœºæ™¯ã€‚è¿™æœ¬åº”è¯¥æ˜¯ä¸€ä¸ªå—æ¬¢è¿çš„æ”¹è¿›ï¼Œä½†å®é™…ä½¿ç”¨ä¸­å´å­˜åœ¨ä¸€äº›é—®é¢˜ã€‚\nç ”å‘åŒå­¦åœ¨å‡çº§äº† GORM ä¹‹åï¼Œå‘ç° GORM æ”¯æŒäº† ErrDuplicateKey è¿™ä¸ª errorï¼Œäºæ˜¯ç›´æ¥åœ¨é¡¹ç›®ä¸­ä½¿ç”¨\n1 2 3 4 5 6 7 if err!=nil { if errors.Is(err, gorm.ErrDuplicateKey) { // ä¸šåŠ¡å¤„ç† } else { // é”™è¯¯æ—¥å¿— } } åœ¨å®é™…è¿è¡Œä¸­ï¼Œå´èµ°åˆ°äº† else åˆ†æ”¯ä¸­ï¼Œå¯¼è‡´äº†ä¸€äº›ä¸šåŠ¡å¼‚å¸¸ã€‚\nå†å²èƒŒæ™¯ åœ¨æ­¤ä¹‹å‰ï¼Œå¼€å‘è€…éœ€è¦åˆ¤æ–­å”¯ä¸€é”®å†²çªæ—¶ï¼Œéœ€è¦è¿›è¡Œå¦‚ä¸‹å¤„ç†ï¼š\n1 2 3 4 5 var mysqlErr *mysql.MySQLError if errors.As(err, \u0026amp;mysqlErr) \u0026amp;\u0026amp; mysqlErr.Number == 1062 { // å¤„ç†å”¯ä¸€é”®å†²çª } è¿™ä¸ªé—®é¢˜åœ¨ GitHub Issue #4037 ä¸­è¢«æå‡ºå¹¶è®¨è®ºã€‚\nTranslate æœºåˆ¶ åœ¨ #PR 6004 ä¸­ï¼Œæœ‰è´¡çŒ®è€…åœ¨ GORM ä¸­æ–°å¢äº† ErrDuplicateKeyï¼Œå¹¶æŠ½è±¡å‡º ErrorTranslate æ¥å£ã€‚å½“å¯¹åº”çš„ driver ä¸­å½“å‡ºç° dialect é”™è¯¯å¹¶ä¸”å¼€å¯ TranslateError é…ç½®åï¼Œä¼šå°è¯•è½¬æˆ GORM å†…éƒ¨çš„é”™è¯¯ã€‚\nå®ç°åŸç† åœ¨æ¯ä¸ª driver ä¸­å®ç°ä¸€ä¸ª Translate æ–¹æ³•ï¼Œåœ¨ MySQL driver çš„å®ç°ä¸­ï¼Œåˆ™æ˜¯ç»´æŠ¤ä¸€ä¸ª errCodes mapï¼Œç”¨äºå°† mysql æ ‡å‡†çš„é”™è¯¯ç æ˜ å°„æˆ GORM çš„å†…éƒ¨ error.\nä»¥ MySQL ä¸ºä¾‹ï¼Œæ”¯æŒ Translate çš„ MySQL é”™è¯¯ç ä¸º:\n1062 1451 1452 å…·ä½“å®šä¹‰è§ https://github.com/go-gorm/mysql/blob/master/error_translator.go\nTranslateError é…ç½®çš„å¼•å…¥ PR 6004 ä¸­æåˆ°ï¼Œä¸ºè§£å†³åŸå§‹é”™è¯¯ä¿¡æ¯å¯èƒ½ä¸¢å¤±çš„é—®é¢˜ï¼ŒGORM å¼•å…¥äº† TranslateError é…ç½®é¡¹ã€‚è¿™å¯¼è‡´äº†ä¸€ä¸ªç°è±¡ï¼š\nå¦‚æœæ²¡æœ‰å¯ç”¨è¯¥é…ç½®é¡¹ï¼Œä»¥ä¸‹åˆ¤æ–­å°†æ— æ³•ç”Ÿæ•ˆ\n1 errors.Is(err, gorm.ErrDuplicateKey) ä½¿ç”¨ ErrDuplicateKey éœ€è¦æ˜¾ç¤ºå¯åŠ¨ TranslateError é…ç½®ï¼š\n1 2 3 db, err := gorm.Open(mysql.Open(dsn), \u0026amp;gorm.Config{ TranslateError: true }) å¸¦æ¥çš„å›°æ‰° è¿™ç§è®¾è®¡ç»™ GORM çš„è€ç”¨æˆ·å¸¦æ¥äº†å›°æ‰°ï¼š\nè¿åäº†ç”¨æˆ·ç›´è§‰ - ç”¨æˆ·ä¹ æƒ¯äº†ç›´æ¥ä½¿ç”¨ errors.Is æ¥åˆ¤æ–­ GORM çš„é”™è¯¯ éœ€è¦é¢å¤–çš„é…ç½® - å¿…é¡»æ˜¾å¼å¯ç”¨ TranslateError æ‰èƒ½ä½¿ç”¨æ–°çš„é”™è¯¯ç±»å‹ ä¸ä¸€è‡´çš„ä½“éªŒ - ErrNotFound å’Œ ErrDuplicateKey çš„ä½¿ç”¨æ–¹å¼ä¸åŒ å¼€å¯é…ç½®åï¼Œä¼šç›´æ¥è¯»å– map ä¸­çš„ errorï¼Œå¯¼è‡´åŸå§‹ error ä¸¢å¤± ","permalink":"https://jackcipher.github.io/go-in-action/gorm-v1.25/","summary":"\u003ch2 id=\"ä¼ ç»Ÿçš„é”™è¯¯å¤„ç†æ–¹å¼\"\u003eä¼ ç»Ÿçš„é”™è¯¯å¤„ç†æ–¹å¼\u003c/h2\u003e\n\u003cp\u003eåœ¨ GORM çš„ä½¿ç”¨è¿‡ç¨‹ä¸­ï¼Œ\u003ccode\u003egorm.ErrNotFound\u003c/code\u003e æ˜¯æœ€åŸºç¡€ä¸”ä½¿ç”¨æœ€å¹¿æ³›çš„é”™è¯¯ç±»å‹ã€‚ä½œä¸ºå¼€å‘è€…ï¼Œæˆ‘ä»¬ä¹ æƒ¯æ€§åœ°ä½¿ç”¨è¿™ç§æ–¹å¼æ¥å¤„ç†æŸ¥è¯¢æœªæ‰¾åˆ°è®°å½•çš„æƒ…å†µï¼š\u003c/p\u003e","title":"GORM v1.25 é”™è¯¯å¤„ç†æœºåˆ¶çš„å˜åŒ–"},{"content":"åŠ¨æ€è§„åˆ’ï¼ˆDynamic Programmingï¼‰å¾€å¾€æ˜¯ç®—æ³•é¢è¯•ä¸­çš„ä¸€é“åã€‚å®ƒçš„æ ¸å¿ƒæ€æƒ³å…¶å®å¹¶ä¸å¤æ‚ï¼Œä½†éš¾ç‚¹åœ¨äºå¦‚ä½•æŠŠä¸€ä¸ªå¤§é—®é¢˜æ‹†è§£æˆçŠ¶æ€è½¬ç§»å…¬å¼ã€‚\nä»Šå¤©æˆ‘ä»¬è¦è®¨è®ºçš„æ˜¯ä¸€é“ç»å…¸çš„å®Œå…¨èƒŒåŒ…å˜ä½“é—®é¢˜ï¼šé›¶é’±å…‘æ¢ II (Coin Change 2)ã€‚\né—®é¢˜æè¿° ç»™ä½ ä¸€ç»„ä¸åŒé¢å€¼çš„ç¡¬å¸ï¼ˆcoinsï¼‰ï¼Œä»¥åŠä¸€ä¸ªç›®æ ‡é‡‘é¢ï¼ˆamountï¼‰ã€‚å‡è®¾æ¯ç§ç¡¬å¸çš„æ•°é‡æ˜¯æ— é™çš„ï¼Œè¯·é—®ï¼šå‡‘å‡ºè¯¥ç›®æ ‡é‡‘é¢ï¼Œä¸€å…±æœ‰å¤šå°‘ç§ä¸åŒçš„ç»„åˆæ–¹å¼ï¼Ÿ\næ³¨æ„ï¼Œè¿™é‡Œæ±‚çš„æ˜¯ç»„åˆ (Combinations)ï¼Œé¡ºåºæ˜¯ä¸é‡è¦çš„ã€‚æ¯”å¦‚ 1 + 2 å’Œ 2 + 1 åœ¨è¿™é‡Œè¢«è§†ä¸ºåŒä¸€ç§æ–¹æ¡ˆï¼Œå› ä¸ºå®ƒä»¬æœ€ç»ˆæ„æˆçš„â€œé’±åŒ…â€é‡Œéƒ½æ˜¯ä¸€æš1å…ƒå’Œä¸€æš2å…ƒã€‚\nä¸¾ä¸ªä¾‹å­ å‡è®¾æˆ‘ä»¬æ‰‹å¤´æœ‰ä¸‰ç§ç¡¬å¸ï¼Œé¢å€¼åˆ†åˆ«æ˜¯ [1, 2, 5]ï¼Œç›®æ ‡æ˜¯å‡‘å‡º 5 å…ƒã€‚\nç¨å¾®åˆ—ä¸¾ä¸€ä¸‹ï¼Œæˆ‘ä»¬ä¼šå‘ç°ä¸€å…±æœ‰ 4 ç§å‡‘æ³•ï¼š\n1 2 3 4 1. **5** (ç›´æ¥æ‹¿ä¸€å¼ 5å…ƒ) 2. **2 + 2 + 1** 3. **2 + 1 + 1 + 1** 4. **1 + 1 + 1 + 1 + 1** æ‰€ä»¥ï¼Œç­”æ¡ˆæ˜¯ 4ã€‚\næ ¸å¿ƒæ€ç»´ï¼šå¡«è¡¨æ³• å¦‚æœä¸ä½¿ç”¨é€’å½’å›æº¯ï¼Œè€Œæ˜¯ä½¿ç”¨åŠ¨æ€è§„åˆ’ï¼Œæœ¬è´¨ä¸Šå°±æ˜¯ä¸€å¼ è¡¨æ ¼çš„å¡«ç©ºæ¸¸æˆã€‚\næˆ‘ä»¬å®šä¹‰ä¸€ä¸ªä¸€ç»´æ•°ç»„ dpï¼Œå…¶ä¸­ dp[i] çš„å«ä¹‰æ˜¯ï¼šå‡‘å‡ºé‡‘é¢ iï¼Œä¸€å…±æœ‰å¤šå°‘ç§æ–¹æ¡ˆã€‚\nä¸€å¼€å§‹ï¼Œé™¤äº† dp[0] = 1ï¼ˆå‡‘å‡º0å…ƒåªæœ‰ä¸€ç§æ–¹æ³•ï¼šä»€ä¹ˆéƒ½ä¸æ‹¿ï¼‰ï¼Œå…¶ä»–æ ¼å­éƒ½åˆå§‹åŒ–ä¸º 0ã€‚ç„¶åï¼Œæˆ‘ä»¬ä¸€æšç¡¬å¸ã€ä¸€æšç¡¬å¸åœ°å»æ›´æ–°è¿™å¼ è¡¨æ ¼ã€‚\nçŠ¶æ€è½¬ç§»çš„é€»è¾‘ å‡è®¾æˆ‘ä»¬ç°åœ¨å¼€å§‹å¤„ç†é¢å€¼ä¸º 2 çš„ç¡¬å¸ã€‚å½“æˆ‘ä»¬è¦å‡‘å‡ºé‡‘é¢ 5 æ—¶ï¼Œæ‘†åœ¨æˆ‘ä»¬é¢å‰çš„åªæœ‰ä¸¤ç§é€‰æ‹©ï¼š\nä¸ä½¿ç”¨è¿™æš2å…ƒç¡¬å¸ã€‚ é‚£ä¹ˆæ–¹æ¡ˆæ•°å°±ç­‰äºâ€œåœ¨æ²¡æœ‰2å…ƒç¡¬å¸å‚ä¸çš„æƒ…å†µä¸‹ï¼Œå‡‘å‡º5å…ƒçš„æ–¹æ¡ˆæ•°â€ã€‚è¿™ä¸ªæ•°å€¼å…¶å®å°±æ˜¯è¡¨æ ¼é‡Œæ—§çš„ dp[5]ã€‚\nä½¿ç”¨è¿™æš2å…ƒç¡¬å¸ã€‚ æ—¢ç„¶ç¡®å®šç”¨äº†ä¸€æš2å…ƒï¼Œé‚£ä¹ˆå‰©ä¸‹çš„ä»»åŠ¡å°±æ˜¯å‡‘å‡º 3 å…ƒï¼ˆ5 - 2 = 3ï¼‰ã€‚è¿™æœ‰å¤šå°‘ç§æ–¹æ³•å‘¢ï¼Ÿç›´æ¥æŸ¥çœ‹è¡¨æ ¼é‡Œçš„ dp[3] å°±å¯ä»¥äº†ã€‚\næŠŠè¿™ä¸¤ç§æƒ…å†µåŠ èµ·æ¥ï¼Œå°±æ˜¯æ–°çš„ dp[5] çš„å€¼ã€‚\nè¿™å°±å¾—åˆ°äº†æˆ‘ä»¬çš„çŠ¶æ€è½¬ç§»æ–¹ç¨‹ï¼š\n1 dp[i] = dp[i] (æ—§æ–¹æ¡ˆï¼šä¸é€‰å½“å‰ç¡¬å¸) + dp[i - coin] (æ–°æ–¹æ¡ˆï¼šé€‰å½“å‰ç¡¬å¸) æ­¥éª¤æ¼”ç¤º è®©æˆ‘ä»¬æ¨¡æ‹Ÿä¸€ä¸‹æ•´ä¸ªè¿‡ç¨‹ã€‚\nåˆå§‹çŠ¶æ€ï¼šdp[0] = 1ï¼Œå…¶ä½™ä¸º 0ã€‚ ç¬¬ä¸€è½®ï¼šå¤„ç†ç¡¬å¸ 1ã€‚ éå†æ•´ä¸ªè¡¨æ ¼ï¼Œä½ ä¼šå‘ç°å‡‘å‡ºä»»ä½•é‡‘é¢éƒ½åªæœ‰ 1 ç§æ–¹æ³•ï¼ˆå…¨ç”¨1å…ƒï¼‰ã€‚è¡¨æ ¼è¢«å¡«æ»¡ä¸ºå…¨ 1ã€‚ ç¬¬äºŒè½®ï¼šå¤„ç†ç¡¬å¸ 2ã€‚ åœ¨åˆšæ‰çš„åŸºç¡€ä¸Šï¼Œçœ‹çœ‹èƒ½ä¸èƒ½é€šè¿‡â€œåŠ å…¥2å…ƒâ€äº§ç”Ÿæ–°æ–¹æ¡ˆã€‚æ¯”å¦‚å‡‘ 2 å…ƒï¼ŒåŸæœ¬æœ‰ 1+1ï¼Œç°åœ¨å¤šäº† 2ï¼Œæ–¹æ¡ˆæ•°å˜ä¸º 2ã€‚ ç¬¬ä¸‰è½®ï¼šå¤„ç†ç¡¬å¸ 5ã€‚ ç»§ç»­å åŠ ã€‚ è¿™é‡Œæœ‰ä¸€ä¸ªå…³é”®ç‚¹ï¼šæˆ‘ä»¬å¿…é¡»å…ˆéå†ç¡¬å¸ï¼Œå†éå†é‡‘é¢ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå…ˆå¤„ç†å®Œ 1 çš„æ‰€æœ‰æƒ…å†µï¼Œå†å¤„ç† 2ã€‚è¿™æ ·å°±ä¿è¯äº†æˆ‘ä»¬æ°¸è¿œæ˜¯â€œåœ¨ 1 çš„åŸºç¡€ä¸ŠåŠ  2â€ï¼Œè€Œä¸ä¼šå‡ºç°â€œåœ¨ 2 çš„åŸºç¡€ä¸ŠåŠ  1â€è¿™ç§å›å¤´è·¯ï¼Œä»è€Œå®Œç¾é¿å¼€äº†æ’åˆ—é‡å¤çš„é—®é¢˜ã€‚\näº¤äº’å¼æ¼”ç¤º Created by Gemini\né€šè¿‡ä¸‹é¢çš„åŠ¨ç”»ï¼Œç›´è§‚åœ°çœ‹åˆ°è¿™ä¸ªå¡«è¡¨è¿‡ç¨‹ã€‚æ³¨æ„è§‚å¯Ÿå½“åˆ‡æ¢ä¸‹ä¸€æšç¡¬å¸æ—¶ï¼Œè¡¨æ ¼æ˜¯å¦‚ä½•åœ¨æ—§å€¼çš„åŸºç¡€ä¸Šè¿›è¡Œå åŠ æ›´æ–°çš„ã€‚\nç¡¬å¸: é‡‘é¢: åŠ è½½ ä¸Šä¸€æ­¥ ä¸‹ä¸€æ­¥ è‡ªåŠ¨ æ…¢ å¿« ç­‰å¾…å¼€å§‹... å½“å‰ç¡¬å¸ (Coin): - å½“å‰é‡‘é¢ (j): - è®¡ç®—å…¬å¼: dp[j] += dp[j-coin] function change(amount, coins) { let dp = new Array(amount + 1).fill(0); dp[0] = 1; for (let coin of coins) { for (let j = coin; j \u003c= amount; j++) { // ç»„åˆæ•°ç´¯åŠ  dp[j] += dp[j - coin]; } } return dp[amount]; } ä»£ç å®ç° è½¬åŒ–ä¸ºä»£ç éå¸¸ç®€æ´ã€‚æˆ‘ä»¬ä½¿ç”¨äº† Go è¯­è¨€ä½œä¸ºç¤ºä¾‹ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 func change(amount int, coins []int) int { // 1. åˆå§‹åŒ– DP æ•°ç»„ dp := make([]int, amount+1) dp[0] = 1 // 2. å¤–å±‚å¾ªç¯ï¼šéå†ç¡¬å¸ for _, coin := range coins { // 3. å†…å±‚å¾ªç¯ï¼šéå†é‡‘é¢ // æ³¨æ„ï¼šj ä» coin å¼€å§‹ï¼Œå› ä¸ºæ¯” coin å°çš„é‡‘é¢æ— æ³•ä½¿ç”¨è¿™æšç¡¬å¸ for j := coin; j \u0026lt;= amount; j++ { dp[j] += dp[j-coin] } } return dp[amount] } å¤æ‚åº¦åˆ†æ æ—¶é—´å¤æ‚åº¦ï¼š$O(\\text{amount} \\times N)$ã€‚æˆ‘ä»¬éœ€è¦å¯¹æ¯ä¸€æšç¡¬å¸ï¼Œéƒ½å®Œæ•´åœ°éå†ä¸€æ¬¡ DP æ•°ç»„ã€‚ ç©ºé—´å¤æ‚åº¦ï¼š$O(\\text{amount})$ã€‚å¾—ç›Šäºæ»šåŠ¨æ•°ç»„çš„æ€æƒ³ï¼Œæˆ‘ä»¬åªéœ€è¦ä¸€ä¸ªä¸€ç»´æ•°ç»„å°±èƒ½å°†å…¶æ‹¿ä¸‹ã€‚ è¿›é˜¶ï¼šå¾ªç¯é¡ºåºçš„å¥¥ç§˜ åœ¨å®Œå…¨èƒŒåŒ…é—®é¢˜ä¸­ï¼Œå¾ªç¯çš„åµŒå¥—é¡ºåºæ˜¯ä¸€ä¸ªéå¸¸ç»å…¸çš„é¢è¯•è€ƒå¯Ÿç‚¹ï¼šå¦‚æœæˆ‘ä»¬äº¤æ¢å†…å¤–å±‚å¾ªç¯ï¼ˆå…ˆéå†é‡‘é¢ï¼Œå†éå†ç¡¬å¸ï¼‰ï¼Œç»“æœä¼šå˜æˆä»€ä¹ˆï¼Ÿ\nç»“æœæ˜¯ï¼šæˆ‘ä»¬ä¼šç®—å‡ºæ’åˆ—æ•°ï¼Œè€Œä¸æ˜¯ç»„åˆæ•°ã€‚\nå…ˆéå†ç¡¬å¸ (Coins First)ï¼šè¿™å°±åƒæˆ‘ä»¬åœ¨å…œé‡ŒæŠ“é’±ï¼Œå…ˆæŠŠ 1 å…ƒçš„éƒ½æ‹¿å®Œï¼Œå†å»æ‹¿ 2 å…ƒçš„ã€‚ç¡¬å¸ 1 æ°¸è¿œåœ¨ç¡¬å¸ 2 ä¹‹å‰è¢«è€ƒè™‘ï¼Œæ‰€ä»¥ç»“æœæ˜¯æ— åºçš„é›†åˆï¼Œå³ç»„åˆã€‚ å…ˆéå†é‡‘é¢ (Amount First)ï¼šè¿™å°±åƒçˆ¬æ¥¼æ¢¯ï¼Œæ¯æ¬¡è¿ˆæ­¥éƒ½å¯ä»¥é€‰ 1 é˜¶æˆ– 2 é˜¶ã€‚åœ¨å‡‘ 3 å…ƒæ—¶ï¼Œå…ˆæ‹¿ 1 å†æ‹¿ 2ï¼Œå’Œå…ˆæ‹¿ 2 å†æ‹¿ 1ï¼Œä¼šè¢«è§†ä¸ºä¸¤ä¸ªä¸åŒçš„åŠ¨ä½œåºåˆ—ï¼Œå³æ’åˆ—ã€‚ ä¸‹å›¾æ¸…æ™°åœ°å±•ç¤ºäº†è¿™ä¸¤ç§è·¯å¾„çš„åŒºåˆ«ï¼š\ngraph TB %% ===================== %% ç»„åˆæ•°ï¼ˆCombinationsï¼‰ %% ===================== subgraph Comb[\u0026#34;ğŸ¯ ç»„åˆæ•° Combinations\u0026lt;br/\u0026gt;\u0026lt;br/\u0026gt;ç‰¹ç‚¹ï¼šå…ˆéå†ç¡¬å¸ï¼Œé¿å…é‡å¤è®¡æ•°\u0026#34;] direction TB C1[\u0026#34;ğŸ’° ç¡¬å¸ 1\u0026lt;br/\u0026gt;coin[0]\u0026#34;] C2[\u0026#34;ğŸ’° ç¡¬å¸ 2\u0026lt;br/\u0026gt;coin[1]\u0026#34;] C3[\u0026#34;ğŸ’° ç¡¬å¸ 3\u0026lt;br/\u0026gt;coin[2]\u0026#34;] C1 ==\u0026gt;|\u0026#34;å¤„ç†å®Œæ‰€æœ‰é‡‘é¢\u0026#34;| C2 C2 ==\u0026gt;|\u0026#34;åªåœ¨ç¡¬å¸1çš„åŸºç¡€ä¸Šç´¯åŠ \u0026#34;| C3 R1[\u0026#34;âœ… ç»“æœç¤ºä¾‹\u0026lt;br/\u0026gt;{1,2} â‰¡ {2,1}\u0026lt;br/\u0026gt;åªè®¡æ•°ä¸€æ¬¡\u0026#34;] C3 -.-\u0026gt; R1 Note1[\u0026#34;âš ï¸ åé¢çš„ç¡¬å¸\u0026lt;br/\u0026gt;ä¸ä¼šå›å¤´ä½¿ç”¨å‰é¢çš„\u0026#34;] C2 -.-\u0026gt;|\u0026#34;å•å‘å¤„ç†\u0026#34;| Note1 end %% ===================== %% æ’åˆ—æ•°ï¼ˆPermutationsï¼‰ %% ===================== subgraph Perm[\u0026#34;ğŸ”„ æ’åˆ—æ•° Permutations\u0026lt;br/\u0026gt;\u0026lt;br/\u0026gt;ç‰¹ç‚¹ï¼šå…ˆéå†é‡‘é¢ï¼Œå…è®¸ä¸åŒé¡ºåº\u0026#34;] direction TB A1[\u0026#34;ğŸ’µ å½“å‰é‡‘é¢ i\u0026lt;br/\u0026gt;amount = i\u0026#34;] P1[\u0026#34;ğŸ’° ç¡¬å¸ 1\u0026#34;] P2[\u0026#34;ğŸ’° ç¡¬å¸ 2\u0026#34;] P3[\u0026#34;ğŸ’° ç¡¬å¸ 3\u0026#34;] A1 ==\u0026gt;|\u0026#34;å°è¯•æ‰€æœ‰ç¡¬å¸\u0026#34;| P1 A1 ==\u0026gt;|\u0026#34;å°è¯•æ‰€æœ‰ç¡¬å¸\u0026#34;| P2 A1 ==\u0026gt;|\u0026#34;å°è¯•æ‰€æœ‰ç¡¬å¸\u0026#34;| P3 R2[\u0026#34;âœ… ç»“æœç¤ºä¾‹\u0026lt;br/\u0026gt;{1,2} â‰  {2,1}\u0026lt;br/\u0026gt;åˆ†åˆ«è®¡æ•°\u0026#34;] Next[\u0026#34;â¡ï¸ é€’å½’åˆ°ä¸‹ä¸€ä¸ªé‡‘é¢\u0026lt;br/\u0026gt;amount = i - coin[j]\u0026#34;] P1 -.-\u0026gt; Next P2 -.-\u0026gt; Next P3 -.-\u0026gt; Next Next -.-\u0026gt; R2 end %% ===================== %% æ ·å¼å®šä¹‰ %% ===================== classDef coinStyle fill:#4A90E2,stroke:#2E5C8A,stroke-width:2px,color:#fff classDef amountStyle fill:#50C878,stroke:#2E7D4E,stroke-width:2px,color:#fff classDef resultStyle fill:#FFB84D,stroke:#CC8A3D,stroke-width:3px,color:#000 classDef noteStyle fill:#E8E8E8,stroke:#999,stroke-width:2px,color:#333,stroke-dasharray: 5 5 class C1,C2,C3,P1,P2,P3 coinStyle class A1 amountStyle class R1,R2 resultStyle class Note1,Next noteStyle å¯¹äºæœ¬é¢˜ï¼ˆæ±‚ç»„åˆæ•°ï¼‰ï¼Œè¯·åŠ¡å¿…è®°ä½ï¼šå…ˆéå†ç¡¬å¸ï¼Œå†éå†é‡‘é¢ã€‚\n","permalink":"https://jackcipher.github.io/leetcode/coin-change/","summary":"\u003cp\u003eåŠ¨æ€è§„åˆ’ï¼ˆDynamic Programmingï¼‰å¾€å¾€æ˜¯ç®—æ³•é¢è¯•ä¸­çš„ä¸€é“åã€‚å®ƒçš„æ ¸å¿ƒæ€æƒ³å…¶å®å¹¶ä¸å¤æ‚ï¼Œä½†éš¾ç‚¹åœ¨äºå¦‚ä½•æŠŠä¸€ä¸ªå¤§é—®é¢˜æ‹†è§£æˆçŠ¶æ€è½¬ç§»å…¬å¼ã€‚\u003c/p\u003e","title":"é›¶é’±å…‘æ¢ II (Coin Change 2)"},{"content":" è½¬è½½äºå…¬å¸æŠ€æœ¯å§”å‘˜ä¼š\nMarkdown Markdown Guide\nCheat Sheet Basic Syntax Extended Syntax Recommended Apps, Tools, Markdown Tables Generator GitHub Flavored Markdown\nEWiki https://ewiki.baijiashilian.com/\nå†…éƒ¨é“¾æ¥ã€æ ‡é¢˜é“¾æ¥ 1 2 3 4 [æŠ€æœ¯è§„èŒƒ](./index.md) [é¦–é¡µ](../index.md) [æŠ€æœ¯åˆ†äº«](../æŠ€æœ¯åŸ¹è®­/æŠ€æœ¯åˆ†äº«è®¡åˆ’\u0026amp;è®°å½•.md) [Markdown](#markdown) æ£€æŸ¥å·¥å…· EWiki å†…åµŒå®æ—¶æ£€æŸ¥å·¥å…· æ‰‹åŠ¨æ£€æŸ¥å·¥å…· https://lint-md.baijiashilian.com/ ç›¸å…³æ–‡æ¡£ï¼ŒChromeã€VS Code æ’ä»¶ https://github.com/lint-md/lint-md\nä¸­è‹±æ–‡æ··æ’ æ¼¢å­¸å®¶ç¨±é€™å€‹ç©ºç™½å­—å…ƒç‚ºã€Œç›¤å¤ä¹‹ç™½ã€ï¼Œå› ç‚ºå®ƒåŠˆé–‹äº†å…¨å½¢å­—å’ŒåŠå½¢å­—ä¹‹é–“çš„æ··æ²Œã€‚å¦æœ‰ç ”ç©¶é¡¯ç¤ºï¼Œæ‰“å­—çš„æ™‚å€™ä¸å–œæ­¡åœ¨ä¸­æ–‡å’Œè‹±æ–‡ä¹‹é–“åŠ ç©ºæ ¼çš„äººï¼Œæ„Ÿæƒ…è·¯éƒ½èµ°å¾—å¾ˆè¾›è‹¦ï¼Œæœ‰ä¸ƒæˆçš„æ¯”ä¾‹æœƒåœ¨ 34 æ­²çš„æ™‚å€™è·Ÿè‡ªå·±ä¸æ„›çš„äººçµå©šï¼Œè€Œå…¶é¤˜ä¸‰æˆçš„äººæœ€å¾Œåªèƒ½æŠŠéºç”¢ç•™çµ¦è‡ªå·±çš„è²“ã€‚ç•¢ç«Ÿæ„›æƒ…è·Ÿæ›¸å¯«éƒ½éœ€è¦é©æ™‚åœ°ç•™ç™½ã€‚\nâ€”â€” vinta/pangu.js\nä»¥ä¸‹å†…å®¹ä¸»è¦æ‘˜å½•è‡ª ä¸­æ–‡æŠ€æœ¯æ–‡æ¡£å†™ä½œé£æ ¼æŒ‡å— | PDFï¼Œå¹¶åšäº†ä¸€äº›å½’çº³ã€æ€»ç»“ã€‚\næ•°å­—\nå•ä½ç¬¦å·\nå¸¸ç”¨ä¸­æ–‡æ ‡ç‚¹ç¬¦å·\nä¸­æ–‡æ ‡ç‚¹ä½¿ç”¨\nä¸­è‹±æ–‡æ··ç”¨æ—¶æ ‡ç‚¹ç¬¦å·ç”¨æ³•\nä¸­è‹±æ–‡æ··æ’æ—¶æœ€çªå‡ºçš„å‡ ä¸ªé—®é¢˜ï¼š\nç©ºç™½ æ ‡ç‚¹ç¬¦å· å¤§å°å†™ ç¿»è¯‘ ç©ºç™½ ç©ºæ ¼ï¼š\nç©ºæ ¼ä¸€å¾‹ä½¿ç”¨åŠè§’ï¼Œç¦æ­¢ä½¿ç”¨å…¨è§’ç©ºæ ¼\nè‹±æ–‡ä¸­ï¼š\nè‹±æ–‡å•è¯/æ•°å­—ä¹‹é—´ã€å¥å­ä¹‹é—´ä½¿ç”¨åŠè§’ç©ºæ ¼ æ•°å­—å’Œå•ä½ä¹‹é—´è¦æœ‰ç©ºæ ¼ï¼Œä¾‹å¦‚ 7 kgã€8 MBã€10 GBï¼Œä½† 60Â°ã€37Â°Cã€1/4ã€100%ã€4â€²5â€³ å›ºå®šå†™æ³•é™¤å¤– é€—å·ã€å¥å·ã€é—®å·ã€å¹å·ã€çœç•¥å·ç­‰å¸¸è§„æ ‡ç‚¹ç¬¦å·å·¦ä¾§æ²¡æœ‰ç©ºæ ¼ã€å³ä¾§ä½¿ç”¨åŠè§’ç©ºæ ¼ å„ç§å¼•å·ã€æ‹¬å·ã€ä¹¦åå·å†…ä¾§æ²¡æœ‰ç©ºæ ¼ã€å¤–ä¾§ä½¿ç”¨åŠè§’ç©ºæ ¼ è¿å­—ç¬¦ã€ç®€å†™å•è¯ä¸­çš„å•å¼•å·ã€è¡¨ç¤ºæˆ–/é™¤æ³•/åˆ†æ•°çš„æ–œçº¿ã€ä¸Šé¢å•ä½ç”¨åˆ°çš„ç¬¦å·ç­‰ä¸¤ä¾§ä¸ä½¿ç”¨ç©ºæ ¼ æ®µè½å¼€å¤´å’Œæœ«å°¾ä¸ä½¿ç”¨ç©ºæ ¼ ç‰¹åˆ«æ³¨æ„è‹±æ–‡å•è¯/æ•°å­—ï¼Œåœ¨ä¸æ±‰å­—ç›¸é‚»æ—¶ä¸­é—´å¿…é¡»ä½¿ç”¨åŠè§’ç©ºæ ¼ï¼Œä½†ä¸å…¨è§’æ ‡ç‚¹ç¬¦å·ä¹‹é—´ï¼ˆæ— è®ºå‰åï¼‰ä¸ä½¿ç”¨ç©ºæ ¼\nä¸­æ–‡å­—ç¬¦ï¼ˆåŒ…æ‹¬æ±‰å­—å’Œæ ‡ç‚¹ç¬¦å·ï¼‰ä¹‹é—´ç¦æ­¢ä½¿ç”¨åŠè§’ç©ºæ ¼\nMarkdown\né™¤è¡¨ç¤ºç¼©è¿›ã€åˆ—è¡¨çº§åˆ«ã€ä»£ç å—ä¸­å›ºæœ‰ç©ºæ ¼ã€è¡¨æ ¼ä¸­çš„ç©ºæ ¼å¤–ï¼Œç¦æ­¢è¿ç»­å‡ºç°ä¸¤ä¸ªåŠä»¥ä¸Šçš„åŠè§’ç©ºæ ¼ï¼Œä½¿ç”¨ \u0026lt;br /\u0026gt; æ›¿ä»£ä¸¤ä¸ªç©ºæ ¼ä½œä¸ºæ¢è¡Œç¬¦ï¼ˆè¡Œå°¾ä¸¤ä¸ªç©ºæ ¼çš„æ¢è¡Œæ–¹å¼ç¼–è¾‘æ—¶çœ‹ä¸å‡ºæ¥ï¼Œå®¹æ˜“å‡ºé”™ï¼‰ ç¦æ­¢ä½¿ç”¨ Tabï¼ˆåˆ¶è¡¨ç¬¦ï¼‰ ä¸­æ–‡ä¸ä¸­æ–‡é“¾æ¥ä¹‹é—´æ˜¯å¦æœ‰ç©ºæ ¼å­˜åœ¨äº‰è®®ï¼Œè¿™é‡Œå»ºè®®ç»Ÿä¸€ä½¿ç”¨ç©ºæ ¼ï¼ˆä¸­è‹±æ–‡ä¹‹é—´æŒ‰ä¸Šé¢è§„èŒƒï¼Œä¹Ÿè¦æœ‰ç©ºæ ¼ï¼‰ é“¾æ¥ä¸æ–‡å­—ç›¸é‚»å¤„ï¼Œå¦‚æœæ²¡æœ‰æ ‡ç‚¹ç¬¦å·åˆ™ä½¿ç”¨ç©ºæ ¼ï¼š ä¸­æ–‡ é“¾æ¥ ä¸­æ–‡ ä¸­æ–‡ link ä¸­æ–‡ English link English é“¾æ¥ä¸æ–‡å­—ç›¸é‚»å¤„ï¼Œå¦‚æœæœ‰æ ‡ç‚¹ç¬¦å·åˆ™ä¸ä½¿ç”¨ç©ºæ ¼ï¼š ã€Šä¹¦åå·ã€‹é“¾æ¥ã€‚ å†’å·ï¼šé“¾æ¥ã€‚ å†’å·ï¼šlinkã€‚ ç²—ä½“ã€æ–œä½“ã€åˆ é™¤çº¿ã€é«˜äº®ã€inline ä»£ç å—ç­‰ï¼Œè§„åˆ™ä¸é“¾æ¥ä¸€æ · æ¢è¡Œï¼š\nä¸åŒæ’ç‰ˆæ ¼å¼ä¹‹é—´ã€æ®µè½ä¹‹é—´å»ºè®®ä½¿ç”¨ä¸€ä¸ªç©ºè¡Œéš”å¼€ ç¦æ­¢è¿ç»­å‡ºç°ä¸¤ä¸ªåŠä»¥ä¸Šçš„ç©ºè¡Œ Markdown æœ«å°¾è¦æœ‰ä¸€ä¸ªç©ºè¡Œ æ ‡ç‚¹ç¬¦å· å…¨è§’/åŠè§’é€‰æ‹©ï¼š\næ±‰å­—æ ‡ç‚¹ç¬¦å·åŸºæœ¬éƒ½ä½¿ç”¨å…¨è§’å­—ç¬¦ï¼Œèµ·è¿æ¥ä½œç”¨çš„çŸ­çº¿ã€è¡¨ç¤ºæˆ–/é™¤æ³•çš„æ–œçº¿é™¤å¤– æ‰€æœ‰è‹±æ–‡å­—æ¯ã€é˜¿æ‹‰ä¼¯æ•°å­—ã€è‹±æ–‡ç¬¦å·ã€è‹±æ–‡æ ‡ç‚¹ç¬¦å·ã€ç©ºæ ¼ç­‰å‡ä½¿ç”¨åŠè§’å­—ç¬¦ æ‹¬å· æ‹¬å·é‡Œå…¨ä¸ºè‹±æ–‡/æ•°å­—æ—¶ä½¿ç”¨åŠè§’æ‹¬å·ï¼Œå¹¶åœ¨æ‹¬å·å‰åå„ç©ºä¸€ä¸ªåŠè§’ç©ºæ ¼ï¼Œæ‹¬å·å’Œæ‹¬å·å†…çš„è‹±æ–‡ä¹‹é—´ä¸éœ€è¦ç©ºæ ¼ æ‹¬å·é‡ŒåŒ…å«ä»»ä½•ä¸­æ–‡ï¼ˆæ— è®ºæ˜¯å¦åŒ…å«è‹±æ–‡ã€æ— è®ºä¸­æ–‡æ˜¯å¦ä¸æ‹¬å·ç›¸é‚»ï¼‰æ—¶ä½¿ç”¨å…¨è§’æ‹¬å·ï¼Œæ‹¬å·å‰åä¸ç©ºæ ¼ ä¸¥ç¦æ±‰å­—å’Œè‹±æ–‡æ ‡ç‚¹ç¬¦å·æ··æ’\nå¸¸ç”¨ä¸­æ–‡æ ‡ç‚¹ç¬¦å·ï¼š\næ³¨æ„ä¸­æ–‡çš„ é¡¿å· â€œã€â€ å’Œé€—å· â€œï¼Œâ€ çš„åŒºåˆ«ï¼Œè‹±æ–‡æ²¡æœ‰é¡¿å·ï¼Œä½¿ç”¨é€—å·æˆ–å¥å·\nè¿æ¥å·\nâ€œâ€”â€ï¼šä¸€å­—çº¿ã€å…¨è§’ã€ç ´æŠ˜å·çš„ä¸€åŠï¼Œè¡¨ç¤ºåºæ•°èµ·æ­¢ã€æ—¶é—´èµ·æ­¢ã€ç©ºé—´èµ·æ­¢æˆ–èµ°å‘ç­‰ï¼Œä¾‹å¦‚ç¬¬ 50â€”100 æ¡ã€é²è¿…ï¼ˆ1881â€”1936ï¼‰ã€2016â€”2020 å¹´ã€åŒ—äº¬â€”ä¸Šæµ·ç‰¹å¿«åˆ—è½¦ã€ç§¦å²­â€”æ·®æ²³çº¿ â€œ-â€ï¼šçŸ­æ¨ªçº¿ã€åŠè§’ã€è‹±æ–‡å‡å·ã€ä¸¤è¾¹ä¸åŠ ç©ºæ ¼ï¼Œèµ·è¿æ¥ä½œç”¨ï¼Œä¾‹å¦‚ 2-1-201 å®¤ã€å›¾ 2-1ã€è¡¨ 3-4ã€2020-09-30ã€åé²ç•ª-å“ˆå¯†ç›†åœ° â€œï½â€ï¼šæ³¢æµªçº¿ã€å…¨è§’ï¼Œè¡¨ç¤ºæ•°å€¼èŒƒå›´ï¼Œä¾‹å¦‚ 1 ï½ 3 gã€2 ï½ 4 ç±³ã€3 ï½ 7 å¹´å†… æ–œçº¿\nè¡¨ç¤ºé™¤æ³•ï¼Œåœ¨ä¸­æ–‡è¯­å¢ƒä¸åŠ ç©ºæ ¼ï¼Œä½†å¯¹ç ”å‘åŒå­¦æ¥è¯´ä¸€èˆ¬å°†å…¶è§†ä¸ºä»£ç ç‰‡æ®µï¼Œä»£ç ä¸­æ–œçº¿ä¸¤è¾¹éœ€è¦åŠ ç©ºæ ¼ï¼Œå¦‚ 120 / 60 = 2 è¡¨ç¤ºå•ä½ï¼ˆé™¤æ³•çš„å˜å½¢ï¼‰ï¼Œä¸¤è¾¹ä¸åŠ ç©ºæ ¼ï¼Œå¦‚ 60 km/h è¡¨ç¤ºâ€œæˆ–â€ï¼Œä¸¤è¾¹ä¸åŠ ç©ºæ ¼ï¼Œè¡¨ç¤ºå¤šä¸ªå¹¶åˆ—é¡¹å»ºè®®ä½¿ç”¨é¡¿å·ï¼Œä¾‹å¦‚ä»–/å¥¹ï¼›ä½ ã€æˆ‘æˆ–ä»– ç¦æ­¢è¿ç»­å¤šä¸ªçš„å¥å·ã€é—®å·å’Œæ„Ÿå¹å·\nå¤§å°å†™ æ™®é€šçš„å•è¯å’Œè¯ç»„å…¨å°å†™ï¼Œæ— è®ºæ˜¯å¦åœ¨å¼€å¤´ï¼Œä¾‹å¦‚â€œargument label å’Œ parameter name çš„åŒºåˆ«æ˜¯â€¦â€¦â€\næ•´ä¸ªå¥å­å’Œè‹±æ–‡åŸæ–‡ä¿æŒä¸€è‡´ï¼Œç¬¬ä¸€ä¸ªå•è¯çš„é¦–å­—æ¯è¦å¤§å†™ï¼Œä¾‹å¦‚ä¹”å¸ƒæ–¯æ›¾è¿™æ ·è¯„ä»·å¾®è½¯ï¼šâ€œThe only problem with Microsoft is they just have no taste. They have absolutely no taste.â€\nä¸“æœ‰åè¯ä¿æŒå›ºæœ‰æ ·å¼ï¼Œä¾‹å¦‚\niPhoneã€iPadã€MacBook Proã€iOSã€iPadOSã€macOS JSONã€Gson JavaScriptã€MySQL å¯ä»¥çœ‹å®˜ç½‘æˆ–è€… Wikipediaï¼Œå¦‚æœä¸€ä¸ªåè¯å‡ºç°åœ¨æ ‡é¢˜ï¼ˆæ ‡é¢˜ä½¿ç”¨å…¨å¤§å†™ç­‰ç‰¹æ®Šæ ·å¼çš„é™¤å¤–ï¼‰å’Œæ­£æ–‡ä¸­é—´ä½ç½®ï¼ˆä¸æ˜¯å¥å­çš„ç¬¬ä¸€ä¸ªå•è¯ï¼‰æ—¶çš„æ ·å¼ç›¸åŒï¼Œé‚£ä¹ˆå®ƒå°±æ˜¯ä¸“æœ‰å½¢å¼\nç¼©å†™æœ‰å¤šç§å½¢å¼ï¼Œä¾‹å¦‚\nå–æ¯ä¸ªå•è¯é¦–å­—æ¯ä½œä¸ºç¼©å†™çš„ä¸€èˆ¬å…¨éƒ¨å¤§å†™ï¼Œä¾‹å¦‚ Software Development Kit ç¼©å†™ä¸º SDKã€Federal Bureau of Investigation ç¼©å†™ä¸º FBI å–å‰å‡ ä¸ªå­—æ¯ä½œä¸ºç¼©å†™çš„ï¼Œå¤§å°å†™ä¸æ­£å¸¸å•è¯ä¸€ç›´ï¼Œä¾‹å¦‚ Application ç¼©å†™ä¸º Appã€applications ç¼©å†™ä¸º apps æŠŠä¸­é—´ N ä¸ªå­—æ¯æ›¿æ¢ä¸ºæ•°å­—çš„ç¼©å†™ï¼Œé¦–å°¾å­—æ¯ä¸æ­£å¸¸å•è¯ä¸€è‡´ï¼Œä¾‹å¦‚ Internationalization ç¼©å†™ä¸º I18nã€localization ç¼©å†™ä¸º l10n æœ‰äº›ç¼©å†™æœ‰ç‰¹æ®Šçš„å½¢å¼å¯è§†ä¸ºä¸“æœ‰åè¯ï¼Œä¿æŒå›ºæœ‰æ ·å¼ï¼Œä¾‹å¦‚ SaaS, PaaS, N/A, e.g., i.e. æ ‡é¢˜ä¸­ä¸»è¦å•è¯é¦–å­—æ¯å¤§å†™ï¼Œä¾‹å¦‚ Type Safety and Type Inference\nMarkdown çš„ code ä¸­ä¿æŒä»£ç æœ¬èº«æ ·å¼ï¼Œä¾‹å¦‚ classã€Intã€propertyWrapper\ncode ä¸åº”è¿‡å¤šä½¿ç”¨ï¼Œä¸€èˆ¬åªæœ‰çœŸæ­£çš„ä»£ç æ‰ç”¨ï¼Œä¾‹å¦‚ä¸€èˆ¬è¯­å¥ä¸­çš„ class å¯ä»¥ç›´æ¥ç¿»è¯‘ä¸ºâ€œç±»â€ï¼Œåªæœ‰åœ¨ä½œä¸ºå…³é”®å­—ä½¿ç”¨æ—¶æ‰éœ€è¦ç”¨åˆ° codeï¼Œä¾‹å¦‚â€œä½¿ç”¨ class å…³é”®å­—å®šä¹‰ç±»â€\nç¿»è¯‘ ä¸€èˆ¬ä¸­æ–‡ä¸­è¾ƒä¸ºæ™®åŠçš„å•è¯è¦ç¿»è¯‘æˆä¸­æ–‡ï¼Œä¾‹å¦‚ \u0026ldquo;When you define a function, you can \u0026hellip;\u0026rdquo; éœ€è¦ç¿»è¯‘æˆâ€œå®šä¹‰å‡½æ•°æ—¶ï¼Œå¯ä»¥â€¦â€¦â€\næ–°çš„ã€å†·é—¨çš„æ¦‚å¿µæˆ–å®¹æ˜“å¼•å‘æ­§ä¹‰çš„å•è¯å»ºè®®ä¸ç¿»è¯‘ï¼Œä¾‹å¦‚ \u0026ldquo;Each function parameter has both an argument label and a parameter name.\u0026rdquo; å¯ä»¥ç¿»è¯‘æˆâ€œå‡½æ•°çš„æ¯ä¸ªå‚æ•°éƒ½æœ‰ä¸€ä¸ª argument label å’Œä¸€ä¸ª parameter nameã€‚â€\nä¸“æœ‰åè¯å¾ˆæ™®åŠçš„ä½¿ç”¨ä¸­æ–‡ï¼Œä¸æ™®åŠä½†æœ‰å®˜æ–¹è¯‘åçš„å¯ä»¥ä½¿ç”¨ä¸­æ–‡åç§°ï¼Œå…¶å®ƒä½¿ç”¨åŸæ–‡ä¸”ä½¿ç”¨æ­£ç¡®çš„å¤§å°å†™å½¢å¼ï¼Œä¾‹å¦‚å¾®è½¯ã€è‹¹æœã€æˆ´å§†å‹’ (Daimler)ã€GitHubã€MySQL\nå‚è€ƒ ä¸­æ–‡å‡ºç‰ˆç‰©å¤¹ç”¨è‹±æ–‡çš„ç¼–è¾‘æ ‡å‡† | è¡Œä¸šæ ‡å‡†ï¼ˆå†…å®¹ï¼‰ å¤¹ç”¨è‹±æ–‡çš„ä¸­æ–‡æ–‡æœ¬çš„æ ‡ç‚¹ç¬¦å·ç”¨æ³•ï¼ˆè‰æ¡ˆï¼‰ ä¸­æ–‡æŠ€æœ¯æ–‡æ¡£å†™ä½œé£æ ¼æŒ‡å— ä¸­æ–‡æ–‡æ¡ˆæ’ç‰ˆæŒ‡åŒ— æ–‡æ¡ˆé£æ ¼æŒ‡å— ä½™å…‰ä¸­ï¼šæ€æ ·æ”¹è¿›è‹±å¼ä¸­æ–‡ï¼Ÿ- è®ºä¸­æ–‡çš„å¸¸æ€ä¸å˜æ€ æµè§ˆå™¨æ’ä»¶ï¼šç‚ºä»€éº¼ä½ å€‘å°±æ˜¯ä¸èƒ½åŠ å€‹ç©ºæ ¼å‘¢ï¼Ÿ ä¼˜ç§€èŒƒä¾‹ è‹¹æœ â€”â€” æ•´ä¸ªç½‘ç«™å‡ ä¹æ— å¯æŒ‘å‰”ï¼ˆå‡ ä¹ï¼šå¤šå¹´ä»¥æ¥åªæœ‰ä¸€æ¬¡å‘ç°é”™äº†ä¸€ä¸ªå¥å·ï¼‰ï¼šhttps://www.apple.com.cn/\nçˆ±èŒƒå„¿ï¼šhttps://www.ifanr.com/\nAdobeï¼šhttps://www.adobe.com/cn/\nå¾®è½¯ï¼šhttps://www.microsoft.com/zh-cn\nç‰¹æ–¯æ‹‰ï¼šhttps://www.tesla.cn/blog\nåé¢æ•™æ ç™¾åº¦ï¼šhttps://www.baidu.com/duty/ é˜¿é‡Œï¼šhttps://www.taobao.com/tbhome/page/about/taobao?spm=a21bo.9614792.103.1.741658c7VEbA9T# è…¾è®¯ï¼šhttps://www.tencent.com/zh-cn/service-agreement.html å¤´æ¡ï¼šhttps://www.toutiao.com/privacy_protection/ ç¾å›¢ï¼šhttps://about.meituan.com/details/desc æ»´æ»´ï¼šhttps://www.didiglobal.com/contact/platform æ•™è‚²éƒ¨ï¼šhttps://www.moe.gov.cn/ æ–°é—»å‡ºç‰ˆç½²ï¼šhttps://www.nppa.gov.cn/ ","permalink":"https://jackcipher.github.io/posts/standards-for-documentation/","summary":"\u003cblockquote\u003e\n\u003cp\u003eè½¬è½½äºå…¬å¸æŠ€æœ¯å§”å‘˜ä¼š\u003c/p\u003e\u003c/blockquote\u003e\n\u003ch2 id=\"markdown\"\u003eMarkdown\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ca href=\"https://www.markdownguide.org/getting-started/\"\u003eMarkdown Guide\u003c/a\u003e\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://www.markdownguide.org/cheat-sheet/\"\u003eCheat Sheet\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://www.markdownguide.org/basic-syntax/\"\u003eBasic Syntax\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://www.markdownguide.org/extended-syntax/\"\u003eExtended Syntax\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://www.markdownguide.org/getting-started/#documents\"\u003eRecommended Apps\u003c/a\u003e, \u003ca href=\"https://www.markdownguide.org/tools/\"\u003eTools\u003c/a\u003e, \u003ca href=\"https://www.tablesgenerator.com/markdown_tables\"\u003eMarkdown Tables Generator\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ca href=\"https://guides.github.com/features/mastering-markdown/\"\u003eGitHub Flavored Markdown\u003c/a\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"ewiki\"\u003eEWiki\u003c/h2\u003e\n\u003cp\u003e\u003ca href=\"https://ewiki.baijiashilian.com/\"\u003ehttps://ewiki.baijiashilian.com/\u003c/a\u003e\u003c/p\u003e\n\u003c!--\n- [EWiki æ•°æ®ä»“åº“](https://git.baijiashilian.com/web/ewiki-repo)\n\n- [EWiki ä»£ç ä»“åº“](https://git.baijiashilian.com/web/ewiki)\n--\u003e\n\u003cul\u003e\n\u003cli\u003eå†…éƒ¨é“¾æ¥ã€æ ‡é¢˜é“¾æ¥\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-md\" data-lang=\"md\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e[\u003cspan class=\"nt\"\u003eæŠ€æœ¯è§„èŒƒ\u003c/span\u003e](\u003cspan class=\"na\"\u003e./index.md\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e[\u003cspan class=\"nt\"\u003eé¦–é¡µ\u003c/span\u003e](\u003cspan class=\"na\"\u003e../index.md\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e[\u003cspan class=\"nt\"\u003eæŠ€æœ¯åˆ†äº«\u003c/span\u003e](\u003cspan class=\"na\"\u003e../æŠ€æœ¯åŸ¹è®­/æŠ€æœ¯åˆ†äº«è®¡åˆ’\u0026amp;è®°å½•.md\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e[\u003cspan class=\"nt\"\u003eMarkdown\u003c/span\u003e](\u003cspan class=\"na\"\u003e#markdown\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch2 id=\"æ£€æŸ¥å·¥å…·\"\u003eæ£€æŸ¥å·¥å…·\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003eEWiki å†…åµŒå®æ—¶æ£€æŸ¥å·¥å…·\u003c/li\u003e\n\u003cli\u003eæ‰‹åŠ¨æ£€æŸ¥å·¥å…· \u003ca href=\"https://lint-md.baijiashilian.com/\"\u003ehttps://lint-md.baijiashilian.com/\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://ewiki.baijiashilian.com/BTC/%E6%8A%80%E6%9C%AF%E8%A7%84%E8%8C%83/CICD/MarkDown%20Lint%20%E8%AF%B4%E6%98%8E%E6%96%87%E6%A1%A3.md\"\u003eç›¸å…³æ–‡æ¡£ï¼ŒChromeã€VS Code æ’ä»¶\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cblockquote\u003e\n\u003cp\u003e\u003ca href=\"https://github.com/lint-md/lint-md\"\u003ehttps://github.com/lint-md/lint-md\u003c/a\u003e\u003c/p\u003e","title":"æ–‡æ¡£ç¼–å†™è§„èŒƒ"},{"content":"åœ¨é“¾è¡¨æ“ä½œä¸­ï¼Œå¿«æ…¢æŒ‡é’ˆ (Fast \u0026amp; Slow Pointers) æ˜¯ä¸€ç§æå…¶ç»å…¸ä¸”ä¼˜é›…çš„æŠ€å·§ã€‚å®ƒä¸»è¦ç”¨äºè§£å†³é“¾è¡¨ä¸­çš„ç¯è·¯æ£€æµ‹ã€ä¸­ç‚¹å¯»æ‰¾ç­‰é—®é¢˜ã€‚å…¶èƒŒåçš„ç†è®ºåŸºç¡€é€šå¸¸è¢«ç§°ä¸º Floyd åˆ¤åœˆç®—æ³• (Floyd\u0026rsquo;s Cycle-Finding Algorithm)ï¼Œæœ‰æ—¶ä¹Ÿå½¢è±¡åœ°è¢«ç§°ä¸ºâ€œé¾Ÿå…”èµ›è·‘ç®—æ³•â€ã€‚\næœ¬æ–‡å°†ä»åŸç†ã€å¯è§†åŒ–æ¼”ç¤ºåˆ°æ•°å­¦è¯æ˜ï¼Œå…¨é¢è§£æè¯¥ç®—æ³•åœ¨ä¸åŒåœºæ™¯ä¸‹çš„åº”ç”¨ã€‚\næ ¸å¿ƒåŸç† ç®—æ³•çš„æ ¸å¿ƒæ€æƒ³éå¸¸ç®€å•ï¼šåˆå§‹åŒ–ä¸¤ä¸ªæŒ‡é’ˆ slow å’Œ fast æŒ‡å‘é“¾è¡¨å¤´éƒ¨ã€‚\nslowï¼šæ¯æ¬¡ç§»åŠ¨ä¸€æ­¥ ($step = 1$) fastï¼šæ¯æ¬¡ç§»åŠ¨ä¸¤æ­¥ ($step = 2$) å¦‚æœé“¾è¡¨ä¸­ä¸å­˜åœ¨ç¯ï¼Œfast æŒ‡é’ˆå°†ç‡å…ˆåˆ°è¾¾é“¾è¡¨å°¾éƒ¨ (null)ï¼›å¦‚æœé“¾è¡¨ä¸­å­˜åœ¨ç¯ï¼Œç”±äº fast çš„é€Ÿåº¦å¿«äº slowï¼Œå®ƒæœ€ç»ˆä¼šåœ¨ç¯å†…â€œè¿½ä¸Šâ€ slow æŒ‡é’ˆã€‚\nå¤æ‚åº¦åˆ†æ æ—¶é—´å¤æ‚åº¦ï¼š$O(N)$ã€‚åœ¨æ²¡æœ‰ç¯çš„æƒ…å†µä¸‹ï¼Œéå†ä¸€æ¬¡é“¾è¡¨ï¼›åœ¨æœ‰ç¯çš„æƒ…å†µä¸‹ï¼Œä¸¤è€…å…¥ç¯åï¼Œfast æœ€å¤šç»•ç¯ä¸€åœˆå³å¯è¿½ä¸Š slowã€‚ ç©ºé—´å¤æ‚åº¦ï¼š$O(1)$ã€‚ä»…ä½¿ç”¨äº†ä¸¤ä¸ªæŒ‡é’ˆï¼Œæœªä½¿ç”¨é¢å¤–çš„å“ˆå¸Œè¡¨å­˜å‚¨èŠ‚ç‚¹ã€‚ äº¤äº’å¼ç®—æ³•æ¼”ç¤º æ¯ç‡¥çš„æ–‡å­—ä¸å¦‚ç›´è§‚çš„åŠ¨ç”»ã€‚ä¸‹æ–¹çš„æ¼”ç¤ºå±•ç¤ºäº†ä¸€ä¸ªå¸¦æœ‰ç¯çš„é“¾è¡¨ï¼ˆç¯å…¥å£ä¸ºèŠ‚ç‚¹ 3ï¼‰ã€‚\né˜¶æ®µä¸€ (Phase 1)ï¼šç‚¹å‡»â€œå•æ­¥æ‰§è¡Œâ€ï¼Œè§‚å¯Ÿå¿«æ…¢æŒ‡é’ˆå¦‚ä½•ç§»åŠ¨å¹¶åœ¨ç¯å†…ç›¸é‡ã€‚ é˜¶æ®µäºŒ (Phase 2)ï¼šç›¸é‡åï¼Œç®—æ³•å¦‚ä½•åˆ©ç”¨â€œç›¸é‡ç‚¹â€å’Œâ€œæ–°æŒ‡é’ˆâ€æ‰¾åˆ°ç¯çš„ç²¾ç¡®å…¥å£ã€‚ å•æ­¥æ‰§è¡Œ é‡ç½® æ…¢æŒ‡é’ˆ (x1) å¿«æŒ‡é’ˆ (x2) ç‚¹å‡»â€œå•æ­¥æ‰§è¡Œâ€å¼€å§‹æ¼”ç¤º å…¸å‹åº”ç”¨åœºæ™¯ 1. åˆ¤æ–­é“¾è¡¨æ˜¯å¦æœ‰ç¯ è¿™æ˜¯æœ€åŸºç¡€çš„åº”ç”¨ã€‚åªéœ€åˆ¤æ–­ fast å’Œ slow æ˜¯å¦ä¼šé‡åˆã€‚\nLeetCode 141. Linked List Cycle ä»£ç é€»è¾‘ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 func hasCycle(head *ListNode) bool { if head == nil || head.Next == nil { return false } slow, fast := head, head for fast != nil \u0026amp;\u0026amp; fast.Next != nil { slow = slow.Next fast = fast.Next.Next if slow == fast { return true } } return false } 2. å¯»æ‰¾ç¯çš„å…¥å£èŠ‚ç‚¹ ç›¸é‡åªæ˜¯ç¬¬ä¸€æ­¥ï¼Œæ›´é«˜çº§çš„åº”ç”¨æ˜¯æ‰¾åˆ°ç¯çš„èµ·å§‹èŠ‚ç‚¹ã€‚è¿™ä¹Ÿæ˜¯é¢è¯•ä¸­çš„é«˜é¢‘è€ƒç‚¹ã€‚\nLeetCode 142. Linked List Cycle II æ•°å­¦æ¨å¯¼ å‡è®¾é“¾è¡¨å¤´åˆ°ç¯å…¥å£çš„è·ç¦»ä¸º $a$ï¼Œç¯å…¥å£åˆ°ç›¸é‡ç‚¹çš„è·ç¦»ä¸º $b$ï¼Œç›¸é‡ç‚¹å†å›åˆ°ç¯å…¥å£çš„è·ç¦»ä¸º $c$ã€‚ä¹Ÿå°±æ˜¯ç¯çš„æ€»é•¿åº¦ $L = b + c$ã€‚\nå½“ä¸¤è€…ç›¸é‡æ—¶ï¼š\nslow èµ°è¿‡çš„è·¯ç¨‹ï¼š$S_{slow} = a + b$ fast èµ°è¿‡çš„è·¯ç¨‹ï¼š$S_{fast} = a + n(b + c) + b = a + nL + b$ ï¼ˆ$n$ ä¸º fast åœ¨ç¯å†…ç»•çš„åœˆæ•°ï¼Œé€šå¸¸ $n \\ge 1$ï¼‰ åˆ©ç”¨é€Ÿåº¦å…³ç³»ï¼š ç”±äº fast çš„é€Ÿåº¦æ˜¯ slow çš„ 2 å€ï¼Œæ‰€ä»¥ $S_{fast} = 2 \\cdot S_{slow}$ã€‚ ä»£å…¥å…¬å¼ï¼š $$ a + nL + b = 2(a + b) $$ $$ a + nL + b = 2a + 2b $$ åŒ–ç®€å¾—ï¼š $$ a = (n - 1)L + c $$\næ ¸å¿ƒç»“è®ºï¼š å½“ $n=1$ æ—¶ï¼ˆé€šå¸¸æƒ…å†µï¼‰ï¼Œå…¬å¼ç®€åŒ–ä¸º $a = c$ã€‚ è¿™æ„å‘³ç€ï¼šä»â€œé“¾è¡¨å¤´â€åˆ°â€œç¯å…¥å£â€çš„è·ç¦»ï¼Œç­‰äºä»â€œç›¸é‡ç‚¹â€ç»§ç»­å‘å‰èµ°åˆ°â€œç¯å…¥å£â€çš„è·ç¦»ã€‚\nç®—æ³•å®ç° åŸºäºä¸Šè¿°æ¨å¯¼ï¼Œæˆ‘ä»¬åªéœ€åœ¨é€šè¿‡é˜¶æ®µä¸€æ‰¾åˆ°ç›¸é‡ç‚¹åï¼š\nä¿æŒ slow åœåœ¨ç›¸é‡ç‚¹ã€‚ åˆå§‹åŒ–ä¸€ä¸ªæ–°çš„æŒ‡é’ˆï¼ˆæˆ–ç›´æ¥å¤ç”¨ headï¼‰å‘½åä¸º finderï¼Œæ”¾åœ¨é“¾è¡¨å¤´éƒ¨ã€‚ è®© slow å’Œ finder åŒæ—¶ç§»åŠ¨ï¼Œæ¯æ¬¡éƒ½åªèµ°ä¸€æ­¥ã€‚ å®ƒä»¬å†æ¬¡ç›¸é‡çš„èŠ‚ç‚¹ï¼Œå³ä¸ºç¯çš„å…¥å£ã€‚ 3. å¯»æ‰¾é“¾è¡¨/ç¯çš„é•¿åº¦ ç¯çš„é•¿åº¦ï¼šåœ¨æ‰¾åˆ°ç›¸é‡ç‚¹åï¼Œå¯ä»¥è®© slow ä¸åŠ¨ï¼Œç”¨å¦ä¸€ä¸ªæŒ‡é’ˆç»•ç¯ä¸€åœˆå›åˆ° slowï¼Œç»Ÿè®¡æ­¥æ•°å³å¯ã€‚ é“¾è¡¨é•¿åº¦ï¼šå¦‚æœå­˜åœ¨ç¯ï¼Œé“¾è¡¨é•¿åº¦é€šå¸¸å®šä¹‰ä¸º $a + L$ã€‚ 4. å¯»æ‰¾é‡å¤æ•° (æ•°ç»„åº”ç”¨) æœ‰äº›æ•°ç»„é—®é¢˜å¯ä»¥è½¬åŒ–ä¸ºé“¾è¡¨åˆ¤åœˆé—®é¢˜ã€‚ä¾‹å¦‚ï¼Œæ•°ç»„ä¸­åŒ…å« $n+1$ ä¸ªæ•´æ•°ï¼Œæ•°å€¼èŒƒå›´åœ¨ $[1, n]$ ä¹‹é—´ï¼Œå¿…å®šå­˜åœ¨è‡³å°‘ä¸€ä¸ªé‡å¤æ•°ã€‚\nLeetCode 287. Find the Duplicate Number æˆ‘ä»¬å¯ä»¥å°†æ•°ç»„ä¸‹æ ‡ i è§†ä¸ºèŠ‚ç‚¹ï¼Œnums[i] è§†ä¸º next æŒ‡é’ˆæŒ‡å‘çš„èŠ‚ç‚¹ã€‚ç”±äºå­˜åœ¨é‡å¤æ•°ï¼Œæ„å‘³ç€æœ‰å¤šä¸ªä¸‹æ ‡æŒ‡å‘åŒä¸€ä¸ªå€¼ï¼ˆå³å¤šä¸ªèŠ‚ç‚¹æŒ‡å‘åŒä¸€ä¸ª nextï¼‰ï¼Œè¿™å°±å½¢æˆäº†ç¯ã€‚é‡å¤çš„é‚£ä¸ªæ•°å­—ï¼Œæ­£æ˜¯ç¯çš„å…¥å£ã€‚\nç¯çš„ç§»é™¤ åœ¨æŸäº›å·¥ç¨‹åœºæ™¯ä¸‹ï¼ˆå¦‚å†…å­˜å›æ”¶ã€é˜²æ­¢æ— é™é€’å½’ï¼‰ï¼Œæˆ‘ä»¬ä¸ä»…è¦æ£€æµ‹ç¯ï¼Œè¿˜è¦ä»é€»è¾‘ä¸Šæ‰“ç ´ç¯ã€‚ ç­–ç•¥æ˜¯ï¼šæ‰¾åˆ°ç¯çš„å…¥å£èŠ‚ç‚¹çš„å‰é©±èŠ‚ç‚¹ï¼Œå°†å…¶ next æŒ‡å‘ nullã€‚\nåˆ©ç”¨ä¸Šè¿°ç®—æ³•æ‰¾åˆ°ç¯å…¥å£ã€‚ ç”±äºæˆ‘ä»¬å·²çŸ¥å…¥å£èŠ‚ç‚¹ï¼Œåªéœ€éå†ç¯ä¸€åœˆï¼Œæ‰¾åˆ°é‚£ä¸ªæŒ‡å‘å…¥å£èŠ‚ç‚¹çš„èŠ‚ç‚¹ï¼ˆå³å°¾èŠ‚ç‚¹ï¼‰ã€‚ å°†å°¾èŠ‚ç‚¹çš„ next ç½®ç©ºã€‚ 1 2 3 4 5 6 7 8 9 10 11 // ä¼ªä»£ç ç¤ºä¾‹ entry := detectCycleEntry(head) if entry != nil { // æ‰¾åˆ°æŒ‡å‘ entry çš„é‚£ä¸ªèŠ‚ç‚¹ curr := entry for curr.Next != entry { curr = curr.Next } // æ–­å¼€ç¯ curr.Next = nil } æ€»ç»“ å¿«æ…¢æŒ‡é’ˆæ˜¯è§£å†³å…·æœ‰â€œå¾ªç¯â€æˆ–â€œä»æœ«å°¾å€’æ•°â€æ€§è´¨é—®é¢˜çš„åˆ©å™¨ã€‚é™¤äº†åˆ¤åœˆï¼Œå®ƒä¹Ÿå¸¸ç”¨äºï¼š\nå¯»æ‰¾é“¾è¡¨çš„ä¸­ç‚¹ï¼ˆå½’å¹¶æ’åºé“¾è¡¨æ—¶å¸¸ç”¨ï¼‰ã€‚ å¯»æ‰¾é“¾è¡¨å€’æ•°ç¬¬ $k$ ä¸ªèŠ‚ç‚¹ï¼ˆç­‰è·åŒæŒ‡é’ˆï¼‰ã€‚ æŒæ¡ $a=c$ è¿™ä¸€æ•°å­¦æ¨å¯¼ï¼Œæ˜¯ç†è§£è¯¥å·¥å…·ä¸Šé™çš„å…³é”®ã€‚\n","permalink":"https://jackcipher.github.io/leetcode/fast-slow-pointer/","summary":"\u003cp\u003eåœ¨é“¾è¡¨æ“ä½œä¸­ï¼Œ\u003cstrong\u003eå¿«æ…¢æŒ‡é’ˆ (Fast \u0026amp; Slow Pointers)\u003c/strong\u003e æ˜¯ä¸€ç§æå…¶ç»å…¸ä¸”ä¼˜é›…çš„æŠ€å·§ã€‚å®ƒä¸»è¦ç”¨äºè§£å†³é“¾è¡¨ä¸­çš„ç¯è·¯æ£€æµ‹ã€ä¸­ç‚¹å¯»æ‰¾ç­‰é—®é¢˜ã€‚å…¶èƒŒåçš„ç†è®ºåŸºç¡€é€šå¸¸è¢«ç§°ä¸º \u003cstrong\u003eFloyd åˆ¤åœˆç®—æ³• (Floyd\u0026rsquo;s Cycle-Finding Algorithm)\u003c/strong\u003eï¼Œæœ‰æ—¶ä¹Ÿå½¢è±¡åœ°è¢«ç§°ä¸ºâ€œé¾Ÿå…”èµ›è·‘ç®—æ³•â€ã€‚\u003c/p\u003e","title":"æ·±å…¥ç†è§£å¿«æ…¢æŒ‡é’ˆï¼šFloyd åˆ¤åœˆç®—æ³•"},{"content":"CI/CD å˜é‡æ˜¯ç¯å¢ƒå˜é‡çš„ä¸€ç§ï¼Œé€šè¿‡è®¾ç½® CI/CD å˜é‡å¯ä»¥ï¼š\næ§åˆ¶ job ä¸ pipeline çš„è¡Œä¸º\nå­˜å‚¨æƒ³å¤ç”¨çš„å˜é‡\né¿å…åœ¨ .gitlab-ci.yml æ–‡ä»¶ä¸­ç¡¬ç¼–ç \nCD/CD çš„å˜é‡å®šä¹‰ä¸»è¦é€šè¿‡ä¸¤ç§æ–¹å¼ï¼š\né€šè¿‡é…ç½®æ–‡ä»¶\né€šè¿‡é¡¹ç›®è®¾ç½®\n1. é€šè¿‡é…ç½®æ–‡ä»¶ åœ¨ .gitlab-ci.yml æ–‡ä»¶ä¸­ï¼Œä½¿ç”¨ variables å…³é”®è¯å¯ä»¥å®šä¹‰å˜é‡ã€‚\n1.1 å˜é‡ä½œç”¨åŸŸ åœ¨ .gitlab-ci.yml ä¸­ï¼Œå˜é‡çš„ä½œç”¨åŸŸæœ‰ä¸¤ç§ï¼Œä¸€ç§æ˜¯ job å¯è®¿é—®ï¼Œå¦ä¸€ç§æ˜¯å…¨å±€å¯è®¿é—®ã€‚\nå¦‚æœåœ¨é…ç½®æ–‡ä»¶çš„é¡¶éƒ¨åŒºåŸŸå®šä¹‰å˜é‡ï¼Œé‚£ä¹ˆè¯¥å˜é‡åœ¨å½“å‰ CI ä¸­çš„æ‰€æœ‰ job å‡å¯è®¿é—®ã€‚åŒç†ï¼Œå¦‚æœåœ¨ä¸€ä¸ªå•ç‹¬çš„ job ä¸­å®šä¹‰å˜é‡ï¼Œåˆ™è¯¥å˜é‡ä»…åœ¨è¯¥ job ä¸­å¯è®¿é—®ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 variables: TEST_VAR: \u0026#34;All jobs can use this variable\u0026#39;s value\u0026#34; job1: variables: TEST_VAR_JOB: \u0026#34;Only job1 can use this variable\u0026#39;s value\u0026#34; script: - echo \u0026#34;$TEST_VAR\u0026#34; and \u0026#34;$TEST_VAR_JOB\u0026#34; .gitlab-ci.yml ä»…å­˜å‚¨éæ•æ„Ÿé…ç½® (non-sensitive configuration)\næ•æ„Ÿé…ç½® (sensitive configuration) è¯·é€šè¿‡é¡¹ç›®è®¾ç½®è¿›è¡Œé…ç½®\n1.2 å¿½ç•¥å…¨å±€å˜é‡ åœ¨ä¸€ä¸ª job ä¸­ï¼Œå¦‚æœä¸æƒ³ä½¿ç”¨å…¨å±€çš„å˜é‡ï¼Œéœ€è¦å°† variables è®¾ç½®ä¸º {}:\n1 2 3 4 5 6 job1: variables: {} script: - echo This job does not need any variables 1.3 å˜é‡ä¸­ä½¿ç”¨å˜é‡ å˜é‡å¯ä»¥åœ¨å…¶ä»–å˜é‡ä¸­ä½¿ç”¨:\n1 2 3 4 5 6 7 8 9 10 job: variables: FLAGS: \u0026#34;-al\u0026#34; LS_CMD: \u0026#39;ls \u0026#34;$FLAGS\u0026#34;\u0026#39; script: - \u0026#39;eval \u0026#34;$LS_CMD\u0026#34;\u0026#39; # Executes \u0026#39;ls -al\u0026#39; 1.4 å˜é‡ä¸­çš„è½¬ä¹‰ç¬¦å· é»˜è®¤æƒ…å†µä¸‹ï¼Œ$ ä¼šè¢«è®¤ä¸ºæ˜¯å˜é‡çš„è¯†åˆ«ç¬¦ï¼Œå¦‚æœæƒ³ä½œä¸ºå¸¸é‡ä½¿ç”¨ï¼Œéœ€è¦ä½¿ç”¨ $$ è¿›è¡Œè½¬ä¹‰ï¼š\n1 2 3 4 5 6 7 8 9 10 job: variables: FLAGS: \u0026#34;-al\u0026#34; LS_CMD: \u0026#39;ls \u0026#34;$FLAGS\u0026#34; $$TMP_DIR\u0026#39; script: - \u0026#39;eval \u0026#34;$LS_CMD\u0026#34;\u0026#39; # Executes \u0026#39;ls -al $TMP_DIR\u0026#39; 2. é€šè¿‡é¡¹ç›®è®¾ç½® CI/CD çš„å˜é‡ä¹Ÿå¯ä»¥åœ¨é¡¹ç›®è®¾ç½®ä¸­è¿›è¡Œé…ç½®ã€‚åªæœ‰é¡¹ç›®çš„ Maintainer æ‹¥æœ‰æ·»åŠ å’Œæ›´æ–° CI/CD å˜é‡çš„æƒé™ã€‚\nåœ¨é¡¹ç›®ä¸­ç»´æŠ¤å˜é‡çš„æ­¥éª¤ï¼š\nè¿›å…¥åˆ°é¡¹ç›®çš„ Settings \u0026gt; CI/CDï¼Œå±•å¼€ Variables éƒ¨åˆ†\nç‚¹å‡» Add variable æ·»åŠ å®Œå˜é‡åï¼Œå°±å¯ä»¥ç›´æ¥åœ¨ .gitlab-ci.yml ä¸­è®¿é—®äº†ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 test_variable: stage: test script: - echo \u0026#34;$CI_JOB_STAGE\u0026#34; # calls a predefined variable - echo \u0026#34;$TEST\u0026#34; # calls a custom variable of type `env_var` - echo \u0026#34;$GREETING\u0026#34; # calls a custom variable of type `file` that contains the path to the temp file - cat \u0026#34;$GREETING\u0026#34; # the temp file itself contains the variable value é¢„è®¾çš„å˜é‡ ä¸ºäº†æ›´å¥½åœ°äº†è§£å½“å‰ä»»åŠ¡çš„æ‰§è¡Œæƒ…å†µï¼ŒGitLab ä¼šæŠŠå¾ˆå¤šå…³é”®ä¿¡æ¯æ‰“åŒ…æˆé¢„è®¾å˜é‡ï¼Œå¦‚å½“å‰ Pipeline æ˜¯å“ªä¸ªåˆ†æ”¯æäº¤è§¦å‘çš„ï¼Œcommit hash æ˜¯å¤šå°‘ï¼Œè°æäº¤ï¼Œæœ‰æ²¡æœ‰å‘èµ· Merge Request ç­‰ã€‚åœ¨æ¯ä¸€ä¸ª Pipeline ä¸­éƒ½å¯ä»¥ç›´æ¥ä½¿ç”¨é¢„è®¾å˜é‡ã€‚\nå¸¸ç”¨çš„é¢„è®¾å€¼ä¸»è¦æ˜¯ï¼š\nå˜é‡ å¤‡æ³¨ CI_COMMIT_BRANCH æäº¤çš„åˆ†æ”¯ CI_COMMIT_MESSAGE æäº¤çš„ä¿¡æ¯ CI_COMMIT_SHA æäº¤çš„ hash å€¼ CI_COMMIT_TAG å‘å¸ƒçš„ tag CI_COMMIT_AUTHOR æäº¤çš„äºº CI_MERGE_REQUEST_ID MergeRequest ID å‚è€ƒæ–‡æ¡£ https://docs.gitlab.com/ee/ci/variables/\nhttps://docs.gitlab.com/ee/ci/variables/predefined_variables.html\n","permalink":"https://jackcipher.github.io/devops/gitlab-ci-variable/","summary":"\u003cp\u003eCI/CD å˜é‡æ˜¯ç¯å¢ƒå˜é‡çš„ä¸€ç§ï¼Œé€šè¿‡è®¾ç½® CI/CD å˜é‡å¯ä»¥ï¼š\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003e\n\u003cp\u003eæ§åˆ¶ job ä¸ pipeline çš„è¡Œä¸º\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eå­˜å‚¨æƒ³å¤ç”¨çš„å˜é‡\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eé¿å…åœ¨ .gitlab-ci.yml æ–‡ä»¶ä¸­ç¡¬ç¼–ç \u003c/p\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003eCD/CD çš„å˜é‡å®šä¹‰ä¸»è¦é€šè¿‡ä¸¤ç§æ–¹å¼ï¼š\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003eé€šè¿‡é…ç½®æ–‡ä»¶\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eé€šè¿‡é¡¹ç›®è®¾ç½®\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"1-é€šè¿‡é…ç½®æ–‡ä»¶\"\u003e1. é€šè¿‡é…ç½®æ–‡ä»¶\u003c/h2\u003e\n\u003cp\u003eåœ¨ \u003ccode\u003e.gitlab-ci.yml\u003c/code\u003e æ–‡ä»¶ä¸­ï¼Œä½¿ç”¨ \u003ccode\u003evariables\u003c/code\u003e å…³é”®è¯å¯ä»¥å®šä¹‰å˜é‡ã€‚\u003c/p\u003e","title":"GitLab CI/CD å˜é‡çš„ç”¨æ³•"},{"content":"èƒŒæ™¯ è¿‡å»ï¼Œæˆ‘ä¸€ç›´åœ¨ä½¿ç”¨ x86_64 æ¶æ„çš„ MacBook Pro è¿›è¡Œå¼€å‘ï¼ŒæœåŠ¡å™¨ç¯å¢ƒåˆ™æ˜¯ x86_64 æ¶æ„çš„ CentOSï¼Œå› æ­¤ä»æœªæ‹…å¿ƒè¿‡å¤šæ¶æ„çš„ Docker é•œåƒæ„å»ºé—®é¢˜ã€‚\nç„¶è€Œï¼Œå…¬å¸æœ€è¿‘æ›´æ–°äº†ä¸€æ‰¹ M1 MacBook Proã€‚\nåœ¨ x86 ç³»ç»Ÿä¸Šè¿è¡Œä¸º ARM/M1 æ¶æ„æ„å»ºçš„é•œåƒæ—¶ï¼Œå¯èƒ½ä¼šé‡åˆ°ä»¥ä¸‹é”™è¯¯ï¼š\n1 standard_init_linux.go:211: exec user process caused \u0026#34;exec format error\u0026#34; è¿™æ„å‘³ç€å®¹å™¨ä¸­çš„äºŒè¿›åˆ¶æ–‡ä»¶å¹¶éä¸ºå½“å‰ CPU æ¶æ„æ„å»ºçš„ã€‚\né‚£ä¹ˆï¼Œå¦‚ä½•æ„å»ºä¸€ä¸ªå¤šæ¶æ„çš„ Docker é•œåƒå‘¢ï¼Ÿ\næœ¬æ–‡å°†ä»‹ç»ä¸¤ç§æ–¹æ³•ï¼šé€šè¿‡ manifest å’Œ buildx æ„å»ºå¤šæ¶æ„é•œåƒã€‚\næ–¹æ³•ä¸€ï¼š ä½¿ç”¨ manifest 1.1 ä»€ä¹ˆæ˜¯ Docker manifest Docker manifest æ˜¯é•œåƒçš„å…ƒæ•°æ®åˆ—è¡¨ï¼ŒåŒ…å«é•œåƒçš„å¤§å°ã€å±‚æ•°ï¼ˆlayersï¼‰ã€digestã€æ“ä½œç³»ç»Ÿã€CPU æ¶æ„ç­‰ä¿¡æ¯ã€‚é€šè¿‡ manifestï¼Œæˆ‘ä»¬å¯ä»¥ä¸ºä¸åŒ CPU æ¶æ„æä¾›å…¼å®¹çš„é•œåƒï¼Œå®ç°ã€Œbuild once, run anywhereã€ã€‚\n1.2 åˆ›å»º manifest åœ¨åˆ›å»º manifest å‰ï¼Œå…ˆæ„å»ºå‡ºæ‰€éœ€çš„é•œåƒã€‚ä»¥ä¸‹ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬ä» Docker Hub æ‹‰å–ä¸¤ä¸ªä¸åŒæ¶æ„çš„é•œåƒï¼ˆalpine:3.19ï¼‰ï¼Œå¹¶å°†å…¶åˆ†åˆ«æ ‡è®°ä¸º arm-v6 å’Œ amd64ï¼š\né•œåƒåç§° CPU æ¶æ„ harbor.baijiayun.com/proxy/alpine3.19 arm-v6 harbor.baijiayun.com/proxy/alpine3.19 amd64 ä½¿ç”¨ manifest å‰ï¼Œéœ€ç¡®ä¿ç›®æ ‡é•œåƒå·²æ¨é€è‡³ä»“åº“ï¼Œmanifest å‘½ä»¤ä»…é€‚ç”¨äºä»“åº“ä¸­çš„é•œåƒã€‚\nåœ¨ Harbor ä¸­å¯ä»¥çœ‹åˆ°ä¸¤ä¸ªä¸åŒæ¶æ„çš„é•œåƒã€‚æ¥ä¸‹æ¥ï¼Œé€šè¿‡ä»¥ä¸‹å‘½ä»¤åˆ›å»º manifestï¼š\n1 2 3 4 5 6 7 8 9 # åˆ›å»º manifest docker manifest create harbor.baijiayun.com/proxy/alpine:3.19 harbor.baijiayun.com/proxy/alpine3.19:arm-v6 harbor.baijiayun.com/proxy/alpine3.19:amd64 # æ·»åŠ æ³¨è§£ docker manifest annotate harbor.baijiayun.com/proxy/alpine:3.19 harbor.baijiayun.com/proxy/alpine3.19:arm-v6 --os linux --arch arm64 docker manifest annotate harbor.baijiayun.com/proxy/alpine:3.19 harbor.baijiayun.com/proxy/alpine3.19:amd64 --os linux --arch amd64 # æ¨é€ manifest è‡³ Harbor docker manifest push harbor.baijiayun.com/proxy/alpine:3.19 æ¨é€å®Œæˆåï¼ŒHarbor ä¸­å°†æ˜¾ç¤ºä¸€ä¸ªåŒ…å«ä¸åŒæ¶æ„çš„é•œåƒã€‚æ­¤ manifest é•œåƒæ”¯æŒè‡ªåŠ¨é€‚é…ç³»ç»Ÿï¼ŒDocker Engine ä¼šæ ¹æ®å½“å‰ç³»ç»Ÿé€‰æ‹©åˆé€‚çš„é•œåƒã€‚å¯é€šè¿‡ docker manifest inspect æŸ¥çœ‹è¯¦ç»†çš„å…ƒæ•°æ®ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 âœ ~ docker manifest inspect harbor.baijiayun.com/proxy/alpine:3.19 { \u0026#34;schemaVersion\u0026#34;: 2, \u0026#34;mediaType\u0026#34;: \u0026#34;application/vnd.docker.distribution.manifest.list.v2+json\u0026#34;, \u0026#34;manifests\u0026#34;: [ { \u0026#34;mediaType\u0026#34;: \u0026#34;application/vnd.docker.distribution.manifest.v2+json\u0026#34;, \u0026#34;size\u0026#34;: 528, \u0026#34;digest\u0026#34;: \u0026#34;sha256:13b7e62e8df80264dbb747995705a986aa530415763a6c58f84a3ca8af9a5bcd\u0026#34;, \u0026#34;platform\u0026#34;: { \u0026#34;architecture\u0026#34;: \u0026#34;amd64\u0026#34;, \u0026#34;os\u0026#34;: \u0026#34;linux\u0026#34; } }, { \u0026#34;mediaType\u0026#34;: \u0026#34;application/vnd.docker.distribution.manifest.v2+json\u0026#34;, \u0026#34;size\u0026#34;: 528, \u0026#34;digest\u0026#34;: \u0026#34;sha256:45eeb55d6698849eb12a02d3e9a323e3d8e656882ef4ca542d1dda0274231e84\u0026#34;, \u0026#34;platform\u0026#34;: { \u0026#34;architecture\u0026#34;: \u0026#34;arm64\u0026#34;, \u0026#34;os\u0026#34;: \u0026#34;linux\u0026#34;, \u0026#34;variant\u0026#34;: \u0026#34;v6\u0026#34; } } ] } æ‰“å¼€ Harbor æ‰¾åˆ°å¯¹åº”çš„é•œåƒï¼Œåˆ‡åˆ° Artifacts é¡µé¢ï¼ŒæŸ¥çœ‹çš„ç»“æœå¦‚ä¸‹ï¼š\n1.3 manifest çš„ä¼˜åŠ¿ ç»Ÿä¸€é•œåƒè®¿é—®ï¼šè·¨å¹³å°å…¼å®¹æ€§æ›´å¥½ï¼Œæ”¯æŒå¤šæ¶æ„å’Œå¤šæ“ä½œç³»ç»Ÿã€‚ ç®€åŒ–é•œåƒç®¡ç†ï¼šç»Ÿä¸€æ¨é€å’Œæ‹‰å–é•œåƒã€‚ é«˜æ•ˆåˆ†å‘ï¼šè‡ªåŠ¨åŒ¹é…ç³»ç»Ÿçš„æ­£ç¡®é•œåƒã€‚ æ–¹æ³•äºŒï¼šä½¿ç”¨ buildx åœ¨ 19.03 ä¹‹åçš„ Docker ç‰ˆæœ¬ä¸­ï¼Œä¸ºæ”¹å–„æ„å»ºé€Ÿåº¦ï¼ŒDocker image æ„å»ºå¼•æ“è¢«é‡å†™ï¼Œè¿™ä¹Ÿæ˜¯åæ¥ç†ŸçŸ¥çš„ BuildKitã€‚BuildKit æ˜¯ Docker é•œåƒæ„å»ºå¼•æ“çš„ä¸€æ¬¡å½»åº•é‡å†™ï¼Œå®ƒä¿ç•™äº†ä¹‹å‰çš„æ‰€æœ‰åŠŸèƒ½ï¼ŒåŒæ—¶å¢åŠ äº†ä¸€äº›å¾ˆæ£’çš„æ–°ç‰¹æ€§ï¼Œä»¥ç”Ÿæˆæ›´å¥½çš„ OCI é•œåƒï¼Œä¾‹å¦‚:\nå¯ä»¥ä¸º COPY æŒ‡ä»¤æ·»åŠ  --chown #34263 çœŸæ­£çš„å¹¶è¡ŒåŒ–å¤šé˜¶æ®µé•œåƒæ„å»º,åªåœ¨éœ€è¦ä¾èµ–é¡¹æ—¶æ‰ç­‰å¾… æˆ‘å»ºè®®å³ä½¿åªæ„å»ºå•æ¶æ„é•œåƒ,ä¹Ÿè¦æ€»æ˜¯å¯ç”¨ Buildkit,å› ä¸ºå®ƒè‡³å°‘å¯ä»¥æé«˜æ„å»ºé€Ÿåº¦ã€‚\nåœ¨åé¢çš„ç‰ˆæœ¬ä¸­ï¼ŒBuildKit æ€»æ˜¯é»˜è®¤å¼€å¯çš„ã€‚éœ€è¦æ‰‹åŠ¨å¼€å¯æˆ–å…³é—­æ—¶ï¼Œåªéœ€è¦è®¾ç½®ç¯å¢ƒå˜é‡å³å¯ï¼Œå¦‚ï¼š\n1 2 3 export DOCKER_BUILDKIT=1 # å½“å‰ä¼šè¯ä¸­ï¼Œå…¨éƒ¨å¼€å¯ # or å•æ¡å‘½ä»¤å¼€å¯ DOCKER_BUILDKIT=1 docker build -t xx . è°ˆåˆ°å¤šæ¶æ„æ„å»ºï¼ŒBuildKit å†…ç½®çš„ buildx å°±å¯ä»¥èƒœä»»ï¼Œä½¿ç”¨æ–¹å¼ä¹Ÿæ¯”è¾ƒç®€å•ã€‚\n3.1 åˆ›å»º container builder é»˜è®¤æƒ…å†µä¸‹ï¼ŒDocker åªæ˜¯å¼€å¯äº† BuildKit ç‰¹æ€§ï¼Œä½†æ˜¯å¹¶ä¸èƒ½ç›´æ¥æ„å»º non-native å¹³å°çš„é•œåƒã€‚æƒ³å¼€å¯è¿™ä¸ªåŠŸèƒ½ï¼Œå°±è¦ä½¿ç”¨ docker-container driverï¼Œæ›´å¤šç»†èŠ‚å¯å‚è€ƒå®˜æ–¹æ–‡æ¡£ã€‚\nä½¿ç”¨ docker-container driver æœ‰ä»¥ä¸‹ä¼˜åŠ¿ï¼š\nèƒ½å¤ŸæŒ‡å®š BuildKit ç‰ˆæœ¬ èƒ½å¤Ÿæ„å»º multi-arch é•œåƒ æœ‰æ›´å¤šçš„ç¼“å­˜åŠŸèƒ½ï¼Œå¦‚ multi caches åˆ›å»º docker-container driver çš„æ–¹å¼ä¹Ÿå¾ˆç®€å•ï¼Œç›´æ¥é€šè¿‡ buildx å‘½ä»¤ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š\n1 2 3 docker buildx create \\ --name container \\ --driver=docker-container åˆ›å»ºåï¼Œé€šè¿‡ docker buildx ls å¯ä»¥æŸ¥çœ‹åˆ›å»ºçš„ç»“æœï¼š 3.2 æ„å»ºå¹¶æ¨é€é•œåƒ åˆ›å»ºäº† docker-container driver åï¼Œå³å¯ä½¿ç”¨ \u0026ndash;platform æŒ‡å®šéœ€è¦æ„å»ºçš„å¹³å°ã€‚æ„å»ºå‘½ä»¤å¦‚ä¸‹ï¼š\n1 2 3 4 5 docker buildx build \\ --tag jackcipher/demo:latest \\ --platform linux/arm/v7,linux/arm64/v8,linux/amd64 \\ --builder container \\ --push . 3.3 å°ç»“ é€šè¿‡ manifest çš„æ–¹å¼å¯ä»¥åˆ›å»ºå¤šæ¶æ„çš„é•œåƒï¼Œè€Œ buildx çš„æ–¹å¼æ›´ç®€å•ã€‚ä¸ç”¨å…ˆåˆ›å»ºä¸¤ä¸ªé•œåƒï¼Œç»„è£…æˆ manifest æ–‡ä»¶å†æ¨é€ manifestï¼Œè€Œæ˜¯ç›´æ¥é€šè¿‡ buildx æŒ‡å®š platform å‚æ•°ï¼Œä¸­é—´çš„è¿‡ç¨‹å…¨éƒ¨éƒ½æ˜¯ç”± buildx è‡ªåŠ¨å®Œæˆã€‚åœ¨å®é™…ä½¿ç”¨ä¸­ï¼Œæ›´æ¨èä½¿ç”¨ buildx çš„æ–¹å¼ã€‚\n4. æ„å»ºå¤šæ¶æ„ Go æœåŠ¡å®è·µ æœ‰äº†å‰é¢çš„åŸºç¡€åï¼Œæ„å»ºå¤šæ¶æ„çš„ Go æœåŠ¡ä¹ä¸€çœ‹å¥½åƒæ¯”è¾ƒç®€å•ï¼šGo åœ¨ç¼–è¯‘æ—¶æä¾›äº† GOOS ä¸ GOARCH å‚æ•°,æ„å»ºçš„æ—¶å€™è®¾ç½®ä¸‹è¿™ä¸¤ä¸ªå‚æ•°å°±å¥½äº†ã€‚\nå¯é—®é¢˜æ˜¯ï¼Œå½“ä½¿ç”¨ buildx åœ¨å¤–å±‚æ„å»ºæ—¶ï¼Œå†…éƒ¨çš„ Dockerfile æ˜¯å¦‚ä½•çŸ¥é“è¦æ„å»ºå“ªä¸ªç›®æ ‡çš„é•œåƒå‘¢ï¼Ÿ\nåœ¨ä»”ç»†æŸ¥é˜…äº†å®˜æ–¹æ–‡æ¡£åï¼Œå¾—çŸ¥åˆ°ï¼Œå½“ä½¿ç”¨ buildx æ„å»ºæ—¶ï¼Œbuildx ä¼šå°†ä¸€äº›ä¿¡æ¯é€šè¿‡ build_arg çš„æ–¹å¼ä¼ é€’åˆ° Dockerfileï¼Œä»¥æ–¹ä¾¿åœ¨ Dockerfile ä¸­ä½¿ç”¨è¿™äº›å˜é‡ã€‚\næ ¹æ® æ–‡æ¡£ å¯çŸ¥ï¼Œä»¥ä¸‹ ARG å˜é‡ä¼šè¢«è‡ªåŠ¨è®¾ç½®ï¼š\nTARGETPLATFORMÂ - æ„å»ºçš„ç›®æ ‡å¹³å°ï¼Œå¦‚ linux/amd64,Â linux/arm/v7,Â windows/amd64. TARGETOSÂ - TARGETPLATFORM å¯¹åº”çš„ OS TARGETARCHÂ - TARGETPLATFORM å¯¹åº”çš„ CPU æ¶æ„ TARGETVARIANTÂ - TARGETPLATFORM å¯¹åº”çš„ variantï¼Œå¦‚æŒ‡å®š platform=linux/arm/v7 é‚£ä¹ˆ arch å°±æ˜¯ arm variant å°±æ˜¯ v7 BUILDPLATFORMÂ - æ„å»ºç¯å¢ƒçš„å¹³å° BUILDOSÂ - BUILDPLATFORM å¯¹åº”çš„ OS BUILDARCHÂ - BUILDPLATFORM å¯¹åº”çš„æ¶æ„ BUILDVARIANTÂ - BUILDPLATFORM å¯¹åº”çš„ variant æœ‰äº†è¿™äº›å˜é‡åï¼Œé‚£ä¹ˆåœ¨ buildx ä¸­æŒ‡å®š platform å‚æ•°åï¼Œå°±å¯ä»¥é€šçŸ¥åˆ° Dockerfile äº†ã€‚\n4.1 ç¼–è¯‘ç›®æ ‡äºŒè¿›åˆ¶æ–‡ä»¶ 1 2 3 4 5 6 7 8 9 10 11 12 FROM --platform=$BUILDPLATFORM golang:1.19 as builder ARG TARGETOS ARG TARGETARCH ARG APP=app RUN GOOS=$TARGETOS GOARCH=$TARGETARCH CGO_ENABLE=0 go build go build -o /build/$APP FROM --platform=$BUILDPLATFORM alpine:3.16.0 COPY --from=builder /build /app WORKDIR /app CMD [\u0026#34;app\u0026#34;] æ ¹æ®ä¸Šä¸€èŠ‚çš„å˜é‡è‡ªåŠ¨æ³¨å…¥çš„çŸ¥è¯†å¯ä»¥å¾—åˆ°ï¼Œå½“æ‰§è¡Œä»¥ä¸‹å‘½ä»¤æ—¶:\n1 2 3 4 5 docker buildx build \\ --tag jackcipher/demo:latest \\ --platform linux/arm/v7,linux/arm64/v8,linux/amd64 \\ --builder container \\ --push . è¿™ä¸ª Dockerfile ä¼šè¢«å¤šæ¬¡æ„å»ºï¼Œæ¯æ¬¡æ„å»ºæ—¶ï¼Œæ‰§è¡Œçš„ go build å‚æ•°åˆä¸åŒã€‚åœ¨è¿™ä¸ª case ä¸­ï¼Œä¼šåˆ†åˆ«æ‰§è¡Œ\n1 2 3 GOOS=linux GOARCH=arm go build GOOS=linux GOARCH=arm64 go build GOOS=linux GOARCH=amd64 go build 5. CI ä¸­å¦‚ä½•ä½¿ç”¨å‘¢ å°†é€‰æ‹© CPU æ¶æ„çš„åœ°æ–¹ï¼Œé€šè¿‡ä¸‹æ‹‰æ¡†çš„å½¢å¼äº¤ç»™ç”¨æˆ·é€‰æ‹©ï¼Œå†å°†å¾—åˆ°çš„å˜é‡ä¼ ç»™ shell ä¸­æ‰§è¡Œå¯¹åº”çš„ç»“æœå³å¯ã€‚\n","permalink":"https://jackcipher.github.io/devops/build-multiarch-go/","summary":"\u003ch2 id=\"èƒŒæ™¯\"\u003eèƒŒæ™¯\u003c/h2\u003e\n\u003cp\u003eè¿‡å»ï¼Œæˆ‘ä¸€ç›´åœ¨ä½¿ç”¨ x86_64 æ¶æ„çš„ MacBook Pro è¿›è¡Œå¼€å‘ï¼ŒæœåŠ¡å™¨ç¯å¢ƒåˆ™æ˜¯ x86_64 æ¶æ„çš„ CentOSï¼Œå› æ­¤ä»æœªæ‹…å¿ƒè¿‡å¤šæ¶æ„çš„ Docker é•œåƒæ„å»ºé—®é¢˜ã€‚\u003c/p\u003e\n\u003cp\u003eç„¶è€Œï¼Œå…¬å¸æœ€è¿‘æ›´æ–°äº†ä¸€æ‰¹ M1 MacBook Proã€‚\u003c/p\u003e","title":"æ„å»ºè·¨å¹³å° Go æœåŠ¡"},{"content":"æ‚¬æŒ‚é•œåƒ sonarnotify åœ¨ CI/CD ä¸­ç”¨åˆ°äº† Docker å¤šé˜¶æ®µæ„å»ºã€‚\nåœ¨æ„å»ºå®Œæˆåï¼Œå³ä½¿æ¯æ¬¡éƒ½åˆ æ‰äº†æ„å»ºåçš„é•œåƒï¼Œé€šè¿‡ docker images è¿˜æ˜¯èƒ½å‘ç°ä¸€äº›æ ‡ç­¾ä¸º çš„é•œåƒã€‚ç»è¿‡æŸ¥é˜…èµ„æ–™å‘ç°ï¼Œè¿™äº›é•œåƒç§°ä¸ºæ‚¬æŒ‚é•œåƒ(dangling image)ã€‚\nåœ¨ sonarnotify ä¸­äº§ç”Ÿæ‚¬æŒ‚é•œåƒçš„åŸå› æ˜¯ç”±äºå¤šé˜¶æ®µä¸­ï¼Œå¼•å…¥äº† golang çš„é•œåƒï¼Œæœ€åç”Ÿæˆçš„é•œåƒå´æ˜¯åŸºäº alpine æ‰“åŒ…çš„ã€‚è€Œä¸­é—´ä¾èµ–çš„ layer æœ€ç»ˆæ²¡æœ‰æ‰“åŒ…åˆ° sonarnotify ä¸­ï¼Œä½œä¸ºæ‚¬æŒ‚é•œåƒè¢«ä¸¢å¼ƒæ‰äº†ã€‚\nç½‘æ®µ å…¬å¸ Docker ç½‘æ®µä¸é˜¿é‡Œäº‘ç½‘æ®µå†²çªï¼Œé€ æˆéƒ¨åˆ†æœåŠ¡æ— æ³•è®¿é—®ã€‚Docker ç½‘æ®µå¦‚ä½•è°ƒæ•´å‘¢ï¼Ÿ\nå…¨å±€è°ƒæ•´ /etc/docker/daemon.json ï¼ˆè¿™é‡Œæ²¡æœ‰è¿™ä¸ªæ–‡ä»¶çš„è¯ï¼Œè‡ªè¡Œåˆ›å»ºï¼‰\n1 2 3 4 { \u0026#34;bip\u0026#34;: \u0026#34;192.168.250.1/24\u0026#34;, \u0026#34;default-address-pools\u0026#34;: [{ \u0026#34;base\u0026#34;: \u0026#34;10.250.0.1/16\u0026#34;, \u0026#34;size\u0026#34;: 24 }] } æ³¨ï¼šbip å’Œ default-address-pools 2 ä¸ªéƒ½è¦é…ç½®\nbip æ§åˆ¶çš„æ˜¯ docker çš„é»˜è®¤ç½‘æ¡¥ docker0 çš„ IP,\ndefault-address-pools æ§åˆ¶çš„æ˜¯ docker network create æ–°åˆ›å»ºçš„è‡ªå®šä¹‰ç½‘æ¡¥çš„ IP\ndocker-compose é»˜è®¤æƒ…å†µå¯åŠ¨çš„æ—¶å€™ï¼Œä¼šå•ç‹¬åˆ›å»ºä¸€ä¸ªæ–°çš„ç½‘æ¡¥\né‡å¯ docker docker-compose\n1 2 3 4 5 6 7 8 // é‡å¯docker systemctl restart docker // å¦‚æœæ˜¯ upstart ç³»ç»Ÿ /etc/init.d/docker restart // åœæ­¢docker-compose docker-compose down // å¯åŠ¨dokcer-compose docker-compose up -d é€šè¿‡ compose è°ƒæ•´ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 services: servername: ... ... networks: - net networks: net: driver: bridge ipam: driver: default config: - subnet: 192.168.249.0/24 æ’æŸ¥ç½‘æ®µå†²çª é€šè¿‡ docker network ls æŸ¥çœ‹å½“å‰ docker åˆ›å»ºçš„æ‰€æœ‰ç½‘ç»œï¼Œç„¶åé€šè¿‡ docker network inspect å‘½ä»¤ï¼Œå¯ä»¥æŸ¥çœ‹å¯ç–‘ç½‘æ®µå®é™…çš„å­ç½‘\nå®šä½åˆ°æœ‰é—®é¢˜çš„ç½‘ç»œåï¼Œå¯ä»¥é€šè¿‡ docker network rm æˆ– å‰å¾€ docker-compose ç›®å½•è¿›è¡Œ docker-compose down ï¼ˆæ¨èï¼‰\n1 docker network ls -q | xargs -r docker network inspect --format=\u0026#39;{{.Name}} {{range .IPAM.Config}}{{.Subnet}}{{end}}\u0026#39; ","permalink":"https://jackcipher.github.io/devops/docker-review/","summary":"\u003ch2 id=\"æ‚¬æŒ‚é•œåƒ\"\u003eæ‚¬æŒ‚é•œåƒ\u003c/h2\u003e\n\u003cp\u003esonarnotify åœ¨ CI/CD ä¸­ç”¨åˆ°äº† Docker å¤šé˜¶æ®µæ„å»ºã€‚\u003c/p\u003e\n\u003cp\u003eåœ¨æ„å»ºå®Œæˆåï¼Œå³ä½¿æ¯æ¬¡éƒ½åˆ æ‰äº†æ„å»ºåçš„é•œåƒï¼Œé€šè¿‡ docker images è¿˜æ˜¯èƒ½å‘ç°ä¸€äº›æ ‡ç­¾ä¸º \u003cnone\u003e çš„é•œåƒã€‚ç»è¿‡æŸ¥é˜…èµ„æ–™å‘ç°ï¼Œè¿™äº›é•œåƒç§°ä¸ºæ‚¬æŒ‚é•œåƒ(dangling image)ã€‚\u003c/p\u003e","title":"Docker ä½¿ç”¨çš„ä¸€äº›æ€»ç»“"},{"content":"ç®€ä»‹ åœ¨å®˜æ–¹æ–‡æ¡£ä¸­ï¼Œå…³äº relabel çš„ä»‹ç»å¹¶ä¸å¤šï¼Œä»‹ç»ä¸‹é…ç½®é¡¹æ ¼å¼å°±ç»“æŸäº†ã€‚ä½†åœ¨å®é™…ä½¿ç”¨ä¸Šï¼Œæˆ‘ä»¬å´ç¦»ä¸å¼€è¿™ä¸ªåˆ©å™¨ã€‚\næœ¬æ–‡å°†ç»“åˆå®é™…ä½¿ç”¨ç»éªŒï¼Œå°† relabel çš„ä½¿ç”¨åœºæ™¯åšä¸€ä¸ªæ€»ç»“ã€‚\nrelabel å­—é¢æ„æ€æ˜¯æŒ‡å¯¹æ ‡ç­¾è¿›è¡Œèµ‹å€¼æ“ä½œã€‚é‡‡é›†ç‚¹é€šè¿‡ metrics æ¥å£å°†æ•°æ®æš´éœ²ç»™ Prometheus, Prometheus å°†æŠ“å–çš„æ•°æ®å­˜å‚¨åˆ°æ—¶è®¸æ•°æ®åº“ä¹‹å‰ï¼Œå°†æ‰§è¡Œ relabel æ“ä½œã€‚\nå¸¸è§ç”¨æ³• relabel å¸¸è§çš„ç”¨æ³•æœ‰ 5 ç§ï¼š\næ·»åŠ æ–°æ ‡ç­¾ æ›´æ–°æ ‡ç­¾å€¼ æ­£åˆ™è¡¨è¾¾å¼æ›¿æ¢ æ›´æ–°æŒ‡æ ‡å åˆ é™¤æ ‡ç­¾å 1. æ·»åŠ æ–°æ ‡ç­¾ é€šè¿‡ relabel æ“ä½œï¼Œå¯ä»¥å¯¹æ‰€æœ‰è¢«é‡‡é›†åˆ°çš„æ•°æ®å¢åŠ æ–°æ ‡ç­¾ã€‚ä»¥æ ‡ç­¾ label_name ä¸ºä¾‹ï¼Œä½¿ç”¨ä»¥ä¸‹é…ç½®ï¼š\n1 2 - target_label: \u0026#34;label_name\u0026#34; replacement: \u0026#34;label_value\u0026#34; é‡‡é›†çš„æ•°æ®ç»è¿‡å¤„ç†åï¼Œmetrics_name{job=\u0026quot;demo_job\u0026quot;} å°†ä¼šå˜æˆ metrics_name{job=\u0026quot;demo_job\u0026quot;, label_name=\u0026quot;label_value\u0026quot;}\n2. æ›´æ–°æ ‡ç­¾å€¼ ä¸ä¸Šè¿°æ·»åŠ æ–°æ ‡ç­¾çš„æ–¹æ³•ç±»ä¼¼ï¼Œå¦‚æœåŸæŒ‡æ ‡ä¸­å·²ç»åŒ…å«ã€‚å¦‚ï¼ŒåŸæŒ‡æ ‡ä¸ºmetrics_name{job=\u0026quot;demo_job\u0026quot;, label_name=\u0026quot;old_name\u0026quot;}, é‚£ä¹ˆåœ¨ relabel åï¼ŒæŒ‡æ ‡åˆ™å˜ä¸º metrics_name{job=\u0026quot;demo_job\u0026quot;, labe_name=\u0026quot;label_value\u0026quot;}\n3. æ­£åˆ™è¡¨è¾¾å¼æ›¿æ¢ é€šè¿‡æ­£åˆ™è¡¨è¾¾å¼ï¼Œå¯ä»¥å°†åŸæœ‰çš„æ ‡ç­¾å€¼æå–è¿›è¡Œå¤„ç†ï¼Œå¹¶æ›¿æ¢æ–°å€¼ã€‚\n1 2 3 4 - source_labels: [instance] regex: \u0026#34;([^:]+):.+\u0026#34; target_label: \u0026#34;instance\u0026#34; replacement: \u0026#34;$1\u0026#34; ä¸Šè¿°è§„åˆ™ä¼šå°† metrics_name{instance=\u0026quot;localhost:1234\u0026quot;} è½¬æ¢ä¸º metrics_name{instance=\u0026quot;localhost\u0026quot;}\n4. æ›´æ–°æŒ‡æ ‡å æŒ‡æ ‡çš„å½¢å¼é™¤äº† metrics_name{job=\u0026quot;demo_job\u0026quot;}å¤–ï¼Œä¹Ÿå¯ä»¥è¡¨ç¤ºä¸º {__name__=\u0026quot;metrics_name\u0026quot;, job=\u0026quot;demo_job\u0026quot;}ã€‚æ‰€ä»¥ï¼Œå¯ä»¥é€šè¿‡ä¿®æ”¹ __name__æ–¹å¼æ¥æ›´æ¢æŒ‡æ ‡åã€‚\n1 2 3 4 - source_labels: [__name__] regex: \u0026#34;(.+)_online\u0026#34; target_label: \u0026#34;__name__\u0026#34; replacement: \u0026#34;online_$1\u0026#34; ä»¥ä¸Šé…ç½®é€šè¿‡æ­£åˆ™ï¼Œå°†ä»¥ online ç»“å°¾çš„æŒ‡æ ‡åæ›´æ–°ä¸ºä»¥ online å¼€å¤´çš„æŒ‡æ ‡åã€‚å› æ­¤ï¼Œmetrics_name_online{job=\u0026quot;demo_job\u0026quot;} å°†ä¼šå˜ä¸º online_metrics_name{job=\u0026quot;demo_job\u0026quot;}\n5. åˆ é™¤æ ‡ç­¾å åˆ é™¤æ ‡ç­¾åæœ‰ä¸‰ç§æ–¹å¼\né€šè¿‡ labeldrop\n1 2 - action: labeldrop regex: \u0026#34;tmp.+\u0026#34; é€šè¿‡æ­£åˆ™è¡¨è¾¾å¼è¿›è¡ŒåŒ¹é…ï¼Œå½“æœ‰ label æ»¡è¶³è¯¥æ­£åˆ™è¡¨è¾¾å¼æ—¶ï¼Œåˆ™ä¼šå¯¹è¯¥æ ‡ç­¾è¿›è¡Œç§»é™¤ã€‚\né€šè¿‡ labelkeep\n1 2 - action: labelkeep regex: \u0026#34;__name__|.*keepme\u0026#34; å¦‚æœæºæ ‡ç­¾æ•°æ®è¾ƒå¤šï¼Œåªéœ€è¦ä¿ç•™è¾ƒå°‘çš„æ ‡ç­¾æ—¶ï¼Œåˆ™å¯ä»¥ä½¿ç”¨ labelkeep å®Œæˆåå‘æ ‡ç­¾åˆ é™¤ã€‚è¿™é‡Œéœ€è¦æ³¨æ„ï¼ŒæŒ‡æ ‡åä¹Ÿæ˜¯ä¸€ä¸ªç‰¹æ®Šçš„æ ‡ç­¾åï¼Œå› æ­¤ä½¿ç”¨ labelkeep æ—¶ï¼Œè¦å¸¦ä¸Š __name__ è¿™ä¸ªç‰¹æ®Šçš„æ ‡ç­¾åã€‚\næ ‡ç­¾å€¼èµ‹ç©ºå€¼\n1 2 3 4 - source_labels: [foo] regex: \u0026#34;bar\u0026#34; target_label: foo replacement: \u0026#34;\u0026#34; åœ¨ Prometheus ä¸­ï¼Œå¦‚æœä¸€ä¸ªæ ‡ç­¾çš„å€¼ä¸ºç©ºï¼Œé‚£ä¹ˆè¿™ä¸ªæ ‡ç­¾åå°±ä¸ä¼šè¢«é‡‡é›†ã€‚å› æ­¤ï¼Œå¯ä»¥é€šè¿‡æ”¹å˜æ ‡ç­¾å€¼çš„æ–¹å¼åˆ é™¤æ ‡ç­¾åã€‚\nåº”ç”¨æ¡ˆä¾‹ åº”ç”¨ï¼šç»™ç›‘æ§å¢åŠ åˆ†ç»„ ç°åœ¨ä½ è´Ÿè´£ä¸€ä¸ªç›‘æ§ç³»ç»Ÿï¼Œä¸šåŠ¡éƒ¨é—¨å·²ç»æŒ‰ç…§äº†ä½ çš„è¦æ±‚æä¾›äº†é‡‡é›†ç‚¹ã€‚ä»¥ node_exporter ä¸ºä¾‹ï¼Œä½ å¾—åˆ°ä¸€æ‰¹é‡‡é›†ç‚¹æˆ–æœåŠ¡å‘ç°çš„ exporterï¼Œç°åœ¨ä¸ºäº†åŒºåˆ†ä¸åŒçš„ä¸šåŠ¡éƒ¨é—¨ï¼Œä¸åŒçš„ç¯å¢ƒï¼Œéœ€è¦ç»™è¿™äº›æŒ‡æ ‡å¢åŠ ä¸šåŠ¡åˆ†ç»„ã€ç¯å¢ƒç­‰ labelã€‚\nå¦‚æœæ˜¯è‡ªå·±å¼€å‘çš„ exporterï¼Œå®Œå…¨å¯ä»¥åœ¨æŒ‡æ ‡æš´éœ²ä¹‹å‰å¢åŠ  labelï¼Œä½†å¼€æºçš„æœåŠ¡æ€ä¹ˆåŠï¼Ÿ\nè¿™ä¸ªæ—¶å€™ï¼Œé€šè¿‡ relabel å³å¯ã€‚\nç›¸å…³é…ç½®å¦‚ä¸‹ï¼š\n1 2 3 4 5 6 7 - job_name: test_bdata_k8s_auto_scraped // ... relabel_configs: - target_label: env replacement: test - target_label: group replacement: xxx_bussiness_group åº”ç”¨ï¼šblackbox æ¢é’ˆ relabel å¯ä»¥å®ç° multi-target æ¨¡å¼ï¼Œåœ¨ä¸€äº›ç‰¹æ®Šçš„ exporter ä¸­éå¸¸æœ‰ç”¨ã€‚\nå½“æƒ³ç›‘æ§ Kafka 9092 ç«¯å£æ˜¯å¦èƒ½è¿é€šæ—¶ï¼Œç”±äº Kafka æœ¬èº«æ²¡æœ‰æä¾›è¯¥ exporterï¼Œæ‰€ä»¥è¦å€ŸåŠ© blackbox è¿™ä¸ªå¼€æºçš„ exporterã€‚blackbox å¯ä»¥æ£€æµ‹å¤šç§åè®®ï¼ŒKafka ç”¨åˆ° 9092 ç«¯å£æ˜¯åŸºäº TCP åè®®ã€‚æ™®é€šçš„ exporterï¼Œéœ€è¦åœ¨å“ªé‡Œç”¨åˆ°æ—¶ï¼Œå°±å»å¯¹åº”çš„æœåŠ¡å™¨ä¸Šè¿›è¡Œå®‰è£…ã€‚ä½†æ˜¯ TCP è¿é€šæ€§éœ€æ±‚æ˜¯é€šç”¨çš„ï¼Œå¦‚æœæ¯æ¬¡éƒ½å»å¯¹åº”çš„æœºå™¨å®‰è£…ï¼Œå°±ä¼šæ¯”è¾ƒéº»çƒ¦ã€‚\nblackbox å®ç°äº†ä¸€ç§è¢«ç§°ä½œ multi-target çš„æ¨¡å¼ï¼Œè¿™ç§æ¨¡å¼çš„å¥½å¤„æ˜¯ï¼š\né€šè¿‡ç½‘ç»œåè®®è·å–æŒ‡æ ‡æ•°æ® ä¸éœ€è¦å»æŒ‡æ ‡æ‰€åœ¨æœºå™¨éƒ¨ç½² exporter exporter æŠŠ target å’Œ query é…ç½®ä½œä¸º Prometheus GET è¯·æ±‚çš„å‚æ•° exporter åœ¨æ”¶åˆ° Prometheus çš„ GET è¯·æ±‚å¹¶å®ŒæˆæŠ“å–åæ‰å¼€å§‹æŠ“å– exporter å¯ä»¥æŸ¥è¯¢å¤šä¸ª target å…¶å®åŸç†ä¹Ÿå¾ˆç®€å•ï¼Œ\nblackbox æœ¬èº«æ˜¯å¯ä»¥å‘èµ·ç±»ä¼¼ telnet è¯·æ±‚åˆ°å¯¹åº”çš„æœåŠ¡çš„ï¼Œè¿™å®Œå…¨å¯ä»¥åœ¨ä¸€ä¸ªä¸­å¿ƒæœåŠ¡å™¨ä¸Šè¿›è¡Œéƒ¨ç½²ï¼Œå¹¶é€šè¿‡é…ç½®å‘Šè¯‰ blackboxï¼Œæˆ‘ç°åœ¨è¦æ¢æµ‹ kafka01 kafka03 çš„ 9092 ç«¯å£æƒ…å†µã€‚è¯·åˆ†åˆ«æ¢æµ‹è¿™ä¸¤å°æœºå™¨ï¼Œå¹¶æŠŠç»“æœé€šè¿‡æŒ‡æ ‡çš„å½¢å¼å‘Šè¯‰æˆ‘ã€‚\nç°åœ¨çš„é—®é¢˜æ˜¯ï¼Œblackbox å¦‚ä½•çŸ¥é“ä½ è¦æ¢æµ‹çš„åœ°å€å‘¢ï¼Ÿç­”æ¡ˆæ˜¯ï¼ŒGet è¯·æ±‚ã€‚\nç°åœ¨æœ€åçš„éš¾ç‚¹å°±æ˜¯ï¼Œå¦‚ä½•è®© Prometheus è®¿é—® blackbox æ—¶å¸¦ä¸Šå‚æ•°å‘¢ï¼Ÿ\nå®Œæ•´é…ç½®å¦‚ä¸‹ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 - job_name: blackbox_probe honor_timestamps: true track_timestamps_staleness: false params: module: - tcp_connect_kafka scrape_interval: 15s scrape_timeout: 3s metrics_path: /probe scheme: http basic_auth: username: node_exporter password: \u0026lt;secret\u0026gt; follow_redirects: true enable_http2: true relabel_configs: - source_labels: [__address__] separator: ; regex: (.*) target_label: __param_target replacement: $1 action: replace - source_labels: [__param_target] separator: ; regex: (.*) target_label: instance replacement: $1 action: replace - separator: ; regex: (.*) target_label: __address__ replacement: 39.105.157.26:9115 action: replace ","permalink":"https://jackcipher.github.io/promethues/prom_relabel/","summary":"\u003ch2 id=\"ç®€ä»‹\"\u003eç®€ä»‹\u003c/h2\u003e\n\u003cp\u003eåœ¨å®˜æ–¹æ–‡æ¡£ä¸­ï¼Œå…³äº \u003ccode\u003erelabel\u003c/code\u003e çš„ä»‹ç»å¹¶ä¸å¤šï¼Œä»‹ç»ä¸‹é…ç½®é¡¹æ ¼å¼å°±ç»“æŸäº†ã€‚ä½†åœ¨å®é™…ä½¿ç”¨ä¸Šï¼Œæˆ‘ä»¬å´ç¦»ä¸å¼€è¿™ä¸ªåˆ©å™¨ã€‚\u003c/p\u003e\n\u003cp\u003eæœ¬æ–‡å°†ç»“åˆå®é™…ä½¿ç”¨ç»éªŒï¼Œå°† \u003ccode\u003erelabel\u003c/code\u003e çš„ä½¿ç”¨åœºæ™¯åšä¸€ä¸ªæ€»ç»“ã€‚\u003c/p\u003e","title":"Prometheus Relabel æ€»ç»“"},{"content":"tcpdump æŠ“åŒ… 1 tcpdump -Xnlps0 -nn -iany port 9001 -w 9001.pcap å‚æ•°è¯´æ˜ï¼š\n-X: æ˜¾ç¤ºåŒ…çš„å†…å®¹ï¼ˆåå…­è¿›åˆ¶å’Œ ASCIIï¼‰ -n: ä¸å°†åœ°å€è½¬æ¢ä¸ºåå­— -l: ä½¿æ ‡å‡†è¾“å‡ºè¡Œç¼“å†² -p: ä¸è®©ç½‘å¡è¿›å…¥æ··æ‚æ¨¡å¼ -s0: æŠ“å–å®Œæ•´çš„æ•°æ®åŒ… -nn: ä¸å°†åè®®å’Œç«¯å£è½¬æ¢ä¸ºåå­— -iany: ç›‘å¬æ‰€æœ‰ç½‘ç»œæ¥å£ -w: å°†åŸå§‹æ•°æ®åŒ…å†™å…¥æ–‡ä»¶ å®¹å™¨ Debug Kubectl Debug 1 kubectl debug -it redis-sentinel-master-ss-0 --image=reg.smvm.cn/appbase/debug-tools:latest --target=redis-master è¿™ä¸ªå‘½ä»¤ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„å®¹å™¨ï¼Œå…±äº«ç›®æ ‡å®¹å™¨çš„ç½‘ç»œã€PID å’Œ IPC å‘½åç©ºé—´ï¼Œæ–¹ä¾¿è¿›è¡Œè°ƒè¯•ã€‚\nnsenter å½“æ— æ³•æ­£å¸¸è·å– debug é•œåƒæ—¶ï¼Œå¯ä»¥ä½¿ç”¨èŠ‚ç‚¹ä¸»æœºä¸Šçš„ nsenter å·¥å…·è¿›å…¥å®¹å™¨å†…éƒ¨æ‰§è¡Œè°ƒè¯•å‘½ä»¤ã€‚\næ­¥éª¤ï¼š\nåœ¨èŠ‚ç‚¹ä¸Šå®‰è£… nsenter å·¥å…·ï¼ˆå¦‚æœå°šæœªå®‰è£…ï¼‰ æŸ¥çœ‹å¾…è°ƒè¯•çš„ä¸šåŠ¡ Pod åå’Œ IPï¼š 1 kubectl get po -owide | grep redis-sentinel-master è·å–å®¹å™¨ IDï¼š 1 docker ps | grep redis-sentinel-master è·å–å®¹å™¨è¿è¡Œçš„ PIDï¼š 1 docker inspect \u0026lt;container_id\u0026gt; | grep -i pid ä½¿ç”¨ nsenter æŸ¥çœ‹å®¹å™¨ IPï¼Œç¡®è®¤æ˜¯å¦ä¸æ­¥éª¤ 2 æŸ¥çœ‹çš„ IP ä¸€è‡´ï¼š 1 nsenter -t \u0026lt;container_pid\u0026gt; -n ip -4 addr ä½¿ç”¨ nsenter è¿›å…¥å®¹å™¨ç½‘ç»œå‘½åç©ºé—´è¿›è¡Œè°ƒè¯•ï¼š 1 nsenter -t \u0026lt;container_pid\u0026gt; -n åœ¨å®¹å™¨å†…æ‰§è¡Œè°ƒè¯•å‘½ä»¤ï¼Œä¾‹å¦‚ï¼š 1 netstat -antp | grep :6379 | wc -l è°ƒè¯•å®Œæ¯•åï¼Œæ‰§è¡Œ exit é€€å‡ºå®¹å™¨å‘½åç©ºé—´ ","permalink":"https://jackcipher.github.io/devops/tcpdump-in-action/","summary":"\u003ch2 id=\"tcpdump-æŠ“åŒ…\"\u003etcpdump æŠ“åŒ…\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003etcpdump -Xnlps0 -nn -iany port 9001 -w 9001.pcap\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eå‚æ•°è¯´æ˜ï¼š\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003e-X\u003c/code\u003e: æ˜¾ç¤ºåŒ…çš„å†…å®¹ï¼ˆåå…­è¿›åˆ¶å’Œ ASCIIï¼‰\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e-n\u003c/code\u003e: ä¸å°†åœ°å€è½¬æ¢ä¸ºåå­—\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e-l\u003c/code\u003e: ä½¿æ ‡å‡†è¾“å‡ºè¡Œç¼“å†²\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e-p\u003c/code\u003e: ä¸è®©ç½‘å¡è¿›å…¥æ··æ‚æ¨¡å¼\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e-s0\u003c/code\u003e: æŠ“å–å®Œæ•´çš„æ•°æ®åŒ…\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e-nn\u003c/code\u003e: ä¸å°†åè®®å’Œç«¯å£è½¬æ¢ä¸ºåå­—\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e-iany\u003c/code\u003e: ç›‘å¬æ‰€æœ‰ç½‘ç»œæ¥å£\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e-w\u003c/code\u003e: å°†åŸå§‹æ•°æ®åŒ…å†™å…¥æ–‡ä»¶\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"å®¹å™¨-debug\"\u003eå®¹å™¨ Debug\u003c/h2\u003e\n\u003ch3 id=\"kubectl-debug\"\u003eKubectl Debug\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-gdscript3\" data-lang=\"gdscript3\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003ekubectl\u003c/span\u003e \u003cspan class=\"n\"\u003edebug\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"n\"\u003eit\u003c/span\u003e \u003cspan class=\"n\"\u003eredis\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"n\"\u003esentinel\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"n\"\u003emaster\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"n\"\u003ess\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"mi\"\u003e0\u003c/span\u003e \u003cspan class=\"o\"\u003e--\u003c/span\u003e\u003cspan class=\"n\"\u003eimage\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003ereg\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003esmvm\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ecn\u003c/span\u003e\u003cspan class=\"o\"\u003e/\u003c/span\u003e\u003cspan class=\"n\"\u003eappbase\u003c/span\u003e\u003cspan class=\"o\"\u003e/\u003c/span\u003e\u003cspan class=\"n\"\u003edebug\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"n\"\u003etools\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"n\"\u003elatest\u003c/span\u003e \u003cspan class=\"o\"\u003e--\u003c/span\u003e\u003cspan class=\"n\"\u003etarget\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eredis\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"n\"\u003emaster\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eè¿™ä¸ªå‘½ä»¤ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„å®¹å™¨ï¼Œå…±äº«ç›®æ ‡å®¹å™¨çš„ç½‘ç»œã€PID å’Œ IPC å‘½åç©ºé—´ï¼Œæ–¹ä¾¿è¿›è¡Œè°ƒè¯•ã€‚\u003c/p\u003e","title":"å®¹å™¨æŠ“åŒ…å®æˆ˜"},{"content":"want to = wanna\ngoing to = gonna\nhave got to = gotta\nout of = outta\nkind of = kinda\na lot of = a lotta\ndon\u0026rsquo;t know = dunno\ngive me = gimme\nwould have = would\u0026rsquo;ve / woulda\nwhat do you = whaddya / waddya\nwhat did you = whadja / wadja\n","permalink":"https://jackcipher.github.io/oral/contraction/","summary":"\u003cp\u003ewant to = wanna\u003c/p\u003e\n\u003cp\u003egoing to = gonna\u003c/p\u003e\n\u003cp\u003ehave got to = gotta\u003c/p\u003e\n\u003cp\u003eout of = outta\u003c/p\u003e\n\u003cp\u003ekind of = kinda\u003c/p\u003e\n\u003cp\u003ea lot of = a lotta\u003c/p\u003e\n\u003cp\u003edon\u0026rsquo;t know = dunno\u003c/p\u003e\n\u003cp\u003egive me = gimme\u003c/p\u003e\n\u003cp\u003ewould have = would\u0026rsquo;ve / woulda\u003c/p\u003e\n\u003cp\u003ewhat do you = whaddya / waddya\u003c/p\u003e\n\u003cp\u003ewhat did you = whadja / wadja\u003c/p\u003e","title":"Contraction"},{"content":"Dark L Background Plenty of non-native speakers from various language backgrounds may have a hard time with dark L.\nVocabulary all\nwell\nfeel\nreal\nkill\nemail\nspecial\nhandle\nit\u0026rsquo;ll\nthat it\u0026rsquo;ll\n","permalink":"https://jackcipher.github.io/oral/dark-l/","summary":"\u003ch2 id=\"dark-l\"\u003eDark L\u003c/h2\u003e\n\u003ch3 id=\"background\"\u003eBackground\u003c/h3\u003e\n\u003cp\u003ePlenty of non-native speakers from various language backgrounds may have a hard time with dark L.\u003c/p\u003e\n\u003ch3 id=\"vocabulary\"\u003eVocabulary\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003eall\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003ewell\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003efeel\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003ereal\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003ekill\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eemail\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003especial\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003ehandle\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eit\u0026rsquo;ll\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003ethat it\u0026rsquo;ll\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ul\u003e","title":"Dark L"},{"content":"ç®€ä»‹ å…ƒéŸ³ä¹‹é—´è¿æ¥ intuitive ruin ","permalink":"https://jackcipher.github.io/oral/linking/","summary":"\u003ch2 id=\"ç®€ä»‹\"\u003eç®€ä»‹\u003c/h2\u003e\n\u003ch2 id=\"å…ƒéŸ³ä¹‹é—´è¿æ¥\"\u003eå…ƒéŸ³ä¹‹é—´è¿æ¥\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003eintuitive\u003c/li\u003e\n\u003cli\u003eruin\u003c/li\u003e\n\u003c/ul\u003e","title":"åº”è¯¥å¦‚ä½•è¿è¯»"},{"content":" you\u0026rsquo;re\nthey\u0026rsquo;re\nthere\u0026rsquo;re\nwhat\u0026rsquo;re you\ngonna\nwanna\nthat\u0026rsquo;ll\nthat it\u0026rsquo;ll\nshoulda,coulda,woulda\nyou\u0026rsquo;ve got\nI got it for you\nIt\u0026rsquo;s for\nJust for fun\nThis medicine is for headaches\nare for\nThese flowers are for the wedding.Lines are for suckers.Coupons are for poor peopel.\nI\u0026rsquo;ll be at\nat æ ‡å‡†å‘éŸ³ [Ã¦t] ä½œä¸º Content Word æ—¶ï¼Œé‡‡ç”¨æ ‡å‡†å‘éŸ³å½¢å¼\nreduce to schwa vowel with stop T consonant: [É™t|]\nå½“ at åé¢çš„éŸ³èŠ‚ä¸ºè¾…éŸ³éŸ³èŠ‚æ—¶ï¼Œat é€€åŒ–ä¸ºéé‡è¯»å¤®å…ƒéŸ³, t åˆ™ä½œä¸º stop T å¤„ç†\nreduce to schwa vowel with flap T vowel or diphthong: [É™dâ€¿]\nå½“ at åé¢çš„éŸ³èŠ‚ä¸ºå•å…ƒéŸ³æˆ–åŒå…ƒéŸ³æ—¶ï¼Œat é€€åŒ–ä¸ºéé‡è¯»å¤®å…ƒéŸ³ï¼Œt ä½œä¸º flap T å¤„ç†\nExamples: at my\n[É™t| mÉ‘Éª]\n** at the**\n[É™t| Ã°É™]\nat a\n[É™dâ€¿É™]\nBegin with consonant\nI\u0026rsquo;ll be at school.\n[É™t| skul]\nBegin with vowel\nI\u0026rsquo;ll be at her house\n[É™dâ€¿É™É¹]\nI\u0026rsquo;m gonna be at Anna\u0026rsquo;s until 6.\n[É™dâ€¿ËˆÃ¦n.É™z]\n","permalink":"https://jackcipher.github.io/oral/phrase-in-common/","summary":"\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003eyou\u0026rsquo;re\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003ethey\u0026rsquo;re\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003ethere\u0026rsquo;re\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003ewhat\u0026rsquo;re you\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003egonna\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003ewanna\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003ethat\u0026rsquo;ll\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003ethat it\u0026rsquo;ll\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eshoulda,coulda,woulda\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eyou\u0026rsquo;ve got\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eI got it for you\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eIt\u0026rsquo;s for\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eJust for fun\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eThis medicine is for headaches\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eare for\u003c/p\u003e\n\u003cp\u003eThese flowers are for the wedding.Lines are for suckers.Coupons are for poor peopel.\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eI\u0026rsquo;ll be at\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"at\"\u003eat\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003eæ ‡å‡†å‘éŸ³ [Ã¦t]\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eä½œä¸º Content Word æ—¶ï¼Œé‡‡ç”¨æ ‡å‡†å‘éŸ³å½¢å¼\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003ereduce to schwa vowel with stop T\nconsonant: [É™t|]\u003c/p\u003e","title":"å£è¯­å¸¸ç”¨çŸ­è¯­"},{"content":"RPC æŠ€æœ¯åˆ†äº« RPC ä»‹ç» è¿œç¨‹è¿‡ç¨‹è°ƒç”¨(Remote Procedure Call ç¼©å†™ RPC)æ˜¯ä¸€ä¸ªè®¡ç®—æœºé€šä¿¡åè®®,é€šä¿—æ¥è®²å°±æ˜¯è°ƒç”¨è¿œç¨‹æœåŠ¡ä¸Šçš„ä¸€ä¸ªå‡½æ•°ï¼Œåœ¨è°ƒç”¨æ—¶å°†å¯¹è±¡åã€å‡½æ•°åã€å‚æ•°ç­‰ä¼ é€’ç»™è¿œç¨‹æœåŠ¡å™¨ï¼ŒæœåŠ¡å™¨å°†å¤„ç†ç»“æœè¿”å›ç»™å®¢æˆ·ç«¯ï¼Œå®¢æˆ·ç«¯è°ƒç”¨ server ç«¯æä¾›çš„æ¥å£å°±åƒæ˜¯è°ƒç”¨æœ¬åœ°çš„å‡½æ•°ä¸€æ ·ã€‚ RPC çš„æ¶ˆæ¯å¯ä»¥é€šè¿‡ TCPã€UDP æˆ–è€… HTTP ç­‰ä¼ è¾“ã€‚\nRPC è°ƒç”¨æµç¨‹ è™½ç„¶è¯´ï¼Œè¿œç¨‹è¿‡ç¨‹è°ƒç”¨å¹¶ä¸éœ€è¦æˆ‘ä»¬å…³å¿ƒå¦‚ä½•ç¼–è§£ç ï¼Œå¦‚ä½•é€šä¿¡ï¼Œä½†æ˜¯æœ€åŸºæœ¬çš„ï¼Œå¦‚æœä¸€ä¸ªæ–¹æ³•éœ€è¦æ”¯æŒè¿œç¨‹è¿‡ç¨‹è°ƒç”¨ï¼Œéœ€è¦æ»¡è¶³ä¸€å®šçš„çº¦æŸå’Œè§„èŒƒã€‚ ä¸åŒ RPC æ¡†æ¶çš„çº¦æŸå’Œè§„èŒƒæ˜¯ä¸åŒçš„ï¼Œå¦‚æœä½¿ç”¨ Golang çš„æ ‡å‡†åº“ net/rpcï¼Œæ–¹æ³•éœ€è¦é•¿è¿™ä¸ªæ ·å­ï¼š\n1 func (t *T) MethodName(argType T1, replyType *T2) error å³éœ€è¦æ»¡è¶³ä»¥ä¸‹ 5 ä¸ªæ¡ä»¶ï¼š\næ–¹æ³•ç±»å‹ï¼ˆTï¼‰æ˜¯å¯¼å‡ºçš„ï¼ˆé¦–å­—æ¯å¤§å†™ï¼‰ æ–¹æ³•åï¼ˆMethodNameï¼‰æ˜¯å¯¼å‡ºçš„ æ–¹æ³•æœ‰ 2 ä¸ªå‚æ•°(argType T1, replyType *T2)ï¼Œå‡ä¸ºå¯¼å‡º/å†…ç½®ç±»å‹ æ–¹æ³•çš„ç¬¬ 2 ä¸ªå‚æ•°ä¸€ä¸ªæŒ‡é’ˆ(replyType *T2) æ–¹æ³•çš„è¿”å›å€¼ç±»å‹æ˜¯ error RPC ç¤ºä¾‹ æˆ‘ä»¬ä½¿ç”¨ golang æä¾› net/rpc åŒ…ï¼Œæˆ‘ä»¬å…ˆæ„é€ ä¸€ä¸ªHelloServiceç±»å‹\n1 2 3 4 5 6 type HelloService struct {} func (p *HelloService) Hello(request string, reply *string) error { *reply = \u0026#34;hello:\u0026#34; + request return nil } å…¶ä¸­ Hello æ–¹æ³•å¿…é¡»æ»¡è¶³ Go è¯­è¨€çš„ RPC è§„åˆ™ï¼šæ–¹æ³•åªèƒ½æœ‰ä¸¤ä¸ªå¯åºåˆ—åŒ–çš„å‚æ•°ï¼Œå…¶ä¸­ç¬¬äºŒä¸ªå‚æ•°æ˜¯æŒ‡é’ˆç±»å‹ï¼Œå¹¶ä¸”è¿”å›ä¸€ä¸ª error ç±»å‹ï¼ŒåŒæ—¶å¿…é¡»æ˜¯å…¬å¼€çš„æ–¹æ³•ã€‚\nç„¶åå°±å¯ä»¥å°† HelloService ç±»å‹çš„å¯¹è±¡æ³¨å†Œä¸ºä¸€ä¸ª RPC æœåŠ¡ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 func main() { rpc.RegisterName(\u0026#34;HelloService\u0026#34;, new(HelloService)) listener, err := net.Listen(\u0026#34;tcp\u0026#34;, \u0026#34;:1234\u0026#34;) if err != nil { log.Fatal(\u0026#34;ListenTCP error:\u0026#34;, err) } conn, err := listener.Accept() if err != nil { log.Fatal(\u0026#34;Accept error:\u0026#34;, err) } rpc.ServeConn(conn) } å…¶ä¸­ rpc.Register å‡½æ•°è°ƒç”¨ä¼šå°†å¯¹è±¡ç±»å‹ä¸­æ‰€æœ‰æ»¡è¶³ RPC è§„åˆ™çš„å¯¹è±¡æ–¹æ³•æ³¨å†Œä¸º RPC å‡½æ•°ï¼Œæ‰€æœ‰æ³¨å†Œçš„æ–¹æ³•ä¼šæ”¾åœ¨ HelloService æœåŠ¡ç©ºé—´ä¹‹ä¸‹ï¼Œé€šè¿‡ rpc.ServeConn å‡½æ•°åœ¨è¯¥ TCP é“¾æ¥ä¸Šä¸ºå¯¹æ–¹æä¾› RPC æœåŠ¡ã€‚\nä¸‹é¢æ˜¯å®¢æˆ·ç«¯è¯·æ±‚ HelloService æœåŠ¡çš„ä»£ç ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 package main func main() { client, err := rpc.Dial(\u0026#34;tcp\u0026#34;, \u0026#34;localhost:1234\u0026#34;) if err != nil { log.Fatal(\u0026#34;dialing:\u0026#34;, err) } var reply string err = client.Call(\u0026#34;HelloService.Hello\u0026#34;, \u0026#34;hello\u0026#34;, \u0026amp;reply) if err != nil { log.Fatal(err) } fmt.Println(reply) } é¦–å…ˆæ˜¯é€šè¿‡rpc.Dialè¿æ¥ RPC æœåŠ¡ï¼Œç„¶åé€šè¿‡client.Callè°ƒç”¨å…·ä½“çš„ RPC æ–¹æ³•ã€‚åœ¨è°ƒç”¨client.Callæ—¶ï¼Œéœ€è¦æŒ‡æ˜è°ƒç”¨çš„ RPC æœåŠ¡åå­—å’Œæ–¹æ³•åå­—ï¼Œç¬¬äºŒå’Œç¬¬ä¸‰ä¸ªå‚æ•°åˆ†åˆ«æˆ‘ä»¬å®šä¹‰ RPC æ–¹æ³•çš„ä¸¤ä¸ªå‚æ•°ã€‚\nProtobuf Protobuf æ˜¯Protocol Buffersçš„ç®€ç§°ï¼Œå®ƒæ˜¯ Google å…¬å¸å¼€å‘çš„ä¸€ç§Interface Definition Language(IDL)æ•°æ®æè¿°è¯­è¨€,Protobufæ˜¯ä¸€å¥—ç±»ä¼¼ Json æˆ–è€… XML çš„æ•°æ®ä¼ è¾“æ ¼å¼å’Œè§„èŒƒã€‚å®ƒéå¸¸è½»ä¾¿é«˜æ•ˆï¼Œå¾ˆé€‚åˆåšæ•°æ®å­˜å‚¨æˆ– RPC æ•°æ®äº¤æ¢æ ¼å¼ã€‚\nprotobuf ä¸ go è¯­è¨€å¸¸è§æ•°æ®ç±»å‹æ˜ å°„è¡¨ï¼š\nprotobuf golang bool bool string string bytes []byte int32 int32 int64 int64 uint32 uint32 uint64 uint64 float float32 double float64 å¤åˆç±»å‹æ˜ å°„è¡¨ï¼š\n(1) æ•°ç»„ç±»å‹\nç­‰ä»· go çš„ []string\n1 2 3 message HelloRequest { repeated string name = 1ï¼› } (2) åµŒå¥—ç±»å‹\nç­‰ä»· go çš„[]User\n1 2 3 4 5 6 7 message User { string name = 1ï¼› } message HelloRequest { repeated User users = 1ï¼› } (3) map\nç­‰ä»· go çš„ map[string]string\n1 2 3 message HelloRequest { map\u0026lt;string, string\u0026gt; names = 1ï¼› } ç®€å•ç¤ºä¾‹ é¦–å…ˆå®‰è£… protobuf ä»£ç å·¥å…· 1 2 brew install protobuf protoc --version å®šä¹‰ hello.proto ç±»å‹\n[src/proto/hello.proto]\n1 2 3 4 5 6 7 8 9 10 11 syntax = \u0026#34;proto3\u0026#34;; option go_package = \u0026#34;.;rpcs\u0026#34;; message Info { string name = 1; } service HelloService { rpc Hello (Info) returns (Info); } å¼€å¤´çš„ syntax è¯­å¥è¡¨ç¤ºé‡‡ç”¨ proto3 çš„è¯­æ³•,go_package å®šä¹‰ server åŒ…å.\nç”Ÿæˆå¯¹åº”çš„ pb.go æ–‡ä»¶\n1 protoc --go_out=src/server src/proto/hello.proto é‡æ–°å®šä¹‰\n1 2 3 4 5 6 type HelloService struct{} func (p *HelloService) Hello(request *Info, reply *Info) error { reply.Name = \u0026#34;hello:\u0026#34; + request.GetName() return nil } ç”Ÿæˆ grpc å¯¹åº”çš„ä»£ç \n1 protoc --go_out=plugins=grpc:src/server src/proto/hello.proto gRPC æ¡†æ¶ google å¼€æºçš„ RPC æ¡†æ¶,æ”¯æŒ Pythonã€Golangã€Java ç­‰ä¼—å¤šå¼€å‘è¯­è¨€ã€‚\ngrpc ä¼˜ç‚¹ï¼š\næ€§èƒ½å¥½ï¼Œæ¯” json ç¼–è§£ç æ•°è¯»å¿«å‡ åå€ã€‚ ä»£ç ç”Ÿæˆæ–¹ä¾¿ï¼Œä½¿ç”¨ proto å·¥å…·è‡ªåŠ¨ç”Ÿæˆå¯¹åº”è¯­è¨€ä»£ç ã€‚ æ”¯æŒå¤šç§æµä¼ è¾“æ–¹å¼ï¼Œæ”¯æŒä¸€å…ƒ RPCã€æœåŠ¡ç«¯æµå¼ RPCã€å®¢æˆ·ç«¯æµå¼ RPCã€åŒæµå‘ RPC å…± 4 ä¸­ä¼ è¾“æµã€‚ æœ‰è¶…æ—¶å’Œå–æ¶ˆå¤„ç†æœºåˆ¶ï¼Œå®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯åœ¨æˆªæ­¢æ—¶é—´åå¯¹å–æ¶ˆäº‹ä»¶è¿›è¡Œç›¸å…³å¤„ç†ã€‚ ç®€å•ç¤ºä¾‹ åˆ›å»ºæœåŠ¡ç«¯\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 func main() { address, err := net.ResolveTCPAddr(\u0026#34;tcp\u0026#34;, fmt.Sprintf(\u0026#34;0.0.0.0:%d\u0026#34;, 8080)) if err != nil { log.Fatal(err) } inbound, err := net.ListenTCP(\u0026#34;tcp\u0026#34;, address) if err != nil { log.Fatal(err) } s := grpc.NewServer() listener := new(types.SimpleServer) rpcs.RegisterSimpleServer(s, listener) _ = s.Serve(inbound) } åˆ›å»ºå®¢æˆ·ç«¯\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 func main() { conn, err := grpc.Dial(fmt.Sprintf(\u0026#34;127.0.0.1:%d\u0026#34;, 8080), grpc.WithTransportCredentials(insecure.NewCredentials())) if err != nil { log.Fatal(err) } c := rpcs.NewSimpleClient(conn) in := bufio.NewReader(os.Stdin) for { line, _, err := in.ReadLine() if err != nil { log.Fatal(err) } reply, err := c.GetLine(context.Background(), \u0026amp;rpcs.SimpleRequest{Data: string(line)}) if err != nil { log.Fatal(err) } log.Printf(\u0026#34;Reply: %v, Data: %v\u0026#34;, reply, reply.Data) } } æµ‹è¯•è¿æ¥\nåœ¨ grpc ä¸­ï¼Œä¸€å…±æœ‰ 4 ç§è°ƒç”¨æ–¹å¼ï¼š\nä¸€å…ƒ RPC: ç§°ä¸ºå•æ¬¡ RPCï¼Œä¹Ÿå°±æ˜¯ä¸€é—®ä¸€ç­” RPC è¯·æ±‚ï¼Œæ˜¯æœ€åŸºç¡€æœ€å¸¸ç”¨çš„è°ƒç”¨æ–¹å¼ã€‚ æœåŠ¡ç«¯æµå¼ RPC: æ˜¯ä¸€ä¸ªå•å‘æµï¼Œå®¢æˆ·ç«¯å‘èµ·ä¸€æ¬¡æ™®é€š RPC è¯·æ±‚ï¼ŒæœåŠ¡ç«¯é€šè¿‡æµå¼è¿”å›æ•°æ®é›†ã€‚ å®¢æˆ·ç«¯æµå¼ RPC: æ˜¯ä¸€ä¸ªå•å‘æµï¼Œå®¢æˆ·ç«¯é€šè¿‡æµå¼å‘é€æ•°æ®é›†ï¼ŒæœåŠ¡ç«¯å›å¤ä¸€æ¬¡æ™®é€š RPC è¯·æ±‚ã€‚ åŒå‘æµå¼ RPC: ç”±å®¢æˆ·ç«¯ä»¥æµå¼å‘èµ·è¯·æ±‚ï¼ŒæœåŠ¡ç«¯åŒæ ·ä»¥æµå¼æ–¹å¼å“åº”è¯·æ±‚ã€‚ä¸€å®šæœ‰å®¢æˆ·ç«¯å‘èµ·ï¼Œä½†äº¤äº’æ–¹å¼(è°å…ˆè°åã€ä¸€æ¬¡å‘å¤šå°‘ã€ç›¸åº”å¤šå°‘ã€ä»€ä¹ˆæ—¶å€™å…³é—­)åˆ™ç”±ç¨‹åºç¼–å†™çš„æ–¹å¼æ¥æ§åˆ¶ã€‚ gRPC è°ƒç”¨æ–¹æ³•\né¦–å…ˆå®šä¹‰ proto æ–‡ä»¶\n[greeter.proto]\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 syntax = \u0026#34;proto3\u0026#34;; option go_package = \u0026#34;.;rpcs\u0026#34;; service Greeter { // ä¸€å…ƒRPC rpc SayUnary (HelloRequest) returns (HelloReply) {} // æœåŠ¡ç«¯æµå¼RPC rpc SayServerStream (HelloRequest) returns (stream HelloReply) {} // å®¢æˆ·ç«¯æµå¼RPC rpc SayClientStream (stream HelloRequest) returns (HelloReply) {} // åŒå‘æµå¼RPC rpc SayBidirectionalStream (stream HelloRequest) returns (stream HelloReply) {} } message HelloRequest { string name = 1; } message HelloReply { string message = 1; } ç”Ÿæˆ gRPC è°ƒç”¨ä»£ç \n1 protoc src/proto/greeter.proto --go_out=plugins=grpc:src/server æœåŠ¡ç«¯ä»£ç \n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 type GreeterServer struct{} func (g *GreeterServer) SayUnary(ctx context.Context, r *rpcs.HelloRequest) (*rpcs.HelloReply, error) { fmt.Println(\u0026#34;\\nSayUnary receive req: \u0026#34; + r.Name) return \u0026amp;rpcs.HelloReply{Message: \u0026#34;hello \u0026#34; + r.Name}, nil } func (g *GreeterServer) SayServerStream(r *rpcs.HelloRequest, stream rpcs.Greeter_SayServerStreamServer) error { var err error fmt.Println(\u0026#34;\\nSayServerStream receive req: \u0026#34; + r.Name) for i := 0; i \u0026lt; 5; i++ { err = stream.Send(\u0026amp;rpcs.HelloReply{Message: \u0026#34;hello \u0026#34; + r.Name + fmt.Sprintf(\u0026#34; %d\u0026#34;, i)}) if err != nil { return err } time.Sleep(time.Second) } return nil } func (g *GreeterServer) SayClientStream(stream rpcs.Greeter_SayClientStreamServer) error { values := []string{} defer func() { fmt.Println(\u0026#34;\\nSayClientStream receive req: \u0026#34;, values) }() for { // é»˜è®¤çš„MaxReceiveMessageSizeå€¼ä¸º1024x1024x4å­—èŠ‚ resp, err := stream.Recv() if err != nil { // åˆ¤æ–­æ˜¯å¦æ•°æ®æµç»“æŸ if err == io.EOF { break } return err } values = append(values, resp.Name) } time.Sleep(10 * time.Millisecond) return stream.SendAndClose(\u0026amp;rpcs.HelloReply{ Message: \u0026#34;hello \u0026#34; + strings.Join(values, \u0026#34;,\u0026#34;), }) } func (g *GreeterServer) SayBidirectionalStream(stream rpcs.Greeter_SayBidirectionalStreamServer) error { sendValues := []string{} receiveValues := []string{} defer func() { fmt.Println(\u0026#34;SayBidirectionalStream send req: \u0026#34;, sendValues) fmt.Println(\u0026#34;SayBidirectionalStream receive req: \u0026#34;, receiveValues) }() for { resp, err := stream.Recv() if err != nil { // åˆ¤æ–­æ˜¯å¦æ•°æ®æµç»“æŸ if err == io.EOF { break } return err } err = stream.Send(\u0026amp;rpcs.HelloReply{Message: \u0026#34;hello \u0026#34; + resp.Name}) if err != nil { return err } sendValues = append(sendValues, resp.Name) receiveValues = append(receiveValues, resp.Name) } return nil } å®¢æˆ·ç«¯ä»£ç \n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 func SayUnary(client rpcs.GreeterClient) error { resp, err := client.SayUnary(context.Background(), \u0026amp;rpcs.HelloRequest{Name: \u0026#34;CallUnary.0\u0026#34;}) if err != nil { return err } fmt.Println(\u0026#34;resp:\u0026#34;, resp.Message) return nil } func SayServerStream(client rpcs.GreeterClient) error { stream, err := client.SayServerStream(context.Background(), \u0026amp;rpcs.HelloRequest{Name: \u0026#34;CallServerStream.0\u0026#34;}) if err != nil { return err } for { // é»˜è®¤çš„MaxReceiveMessageSizeå€¼ä¸º1024x1024x4å­—èŠ‚ resp, err := stream.Recv() if err != nil { // åˆ¤æ–­æ˜¯å¦æ•°æ®æµç»“æŸ if err == io.EOF { break } return err } fmt.Println(\u0026#34;resp:\u0026#34;, resp.Message) } time.Sleep(10 * time.Millisecond) return stream.CloseSend() } func SayClientStream(client rpcs.GreeterClient) error { stream, err := client.SayClientStream(context.Background()) if err != nil { return err } names := []string{\u0026#34;CallClientStream:1\u0026#34;, \u0026#34;CallClientStream:2\u0026#34;, \u0026#34;CallClientStream:3\u0026#34;} for _, name := range names { err := stream.Send(\u0026amp;rpcs.HelloRequest{Name: name}) if err != nil { return err } time.Sleep(time.Second) } resp, err := stream.CloseAndRecv() if err != nil { return err } fmt.Println(\u0026#34;resp:\u0026#34;, resp.Message) return nil } func SayBidirectionalStream(client rpcs.GreeterClient) error { stream, err := client.SayBidirectionalStream(context.Background()) if err != nil { return err } names := []string{\u0026#34;CallBidirectionalStream:1\u0026#34;, \u0026#34;CallBidirectionalStream:2\u0026#34;, \u0026#34;CallBidirectionalStream:3\u0026#34;, \u0026#34;CallBidirectionalStream:4\u0026#34;} for _, name := range names { err := stream.Send(\u0026amp;rpcs.HelloRequest{Name: name}) if err != nil { return err } resp, err := stream.Recv() if err != nil { if err == io.EOF { break } return err } fmt.Println(\u0026#34;resp:\u0026#34;, resp.Message) } time.Sleep(10 * time.Millisecond) return stream.CloseSend() } å¯åŠ¨æœåŠ¡ç«¯æœåŠ¡\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 func main() { s := grpc.NewServer() rpcs.RegisterGreeterServer(s, new(types.GreeterServer)) reflection.Register(s) list, err := net.Listen(\u0026#34;tcp\u0026#34;, \u0026#34;127.0.0.1:8080\u0026#34;) if err != nil { panic(err) } err = s.Serve(list) if err != nil { panic(err) } } å¯åŠ¨å®¢æˆ·ç«¯æœåŠ¡\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 func main() { conn, err := grpc.Dial(\u0026#34;127.0.0.1:8080\u0026#34;, grpc.WithTransportCredentials(insecure.NewCredentials())) if err != nil { panic(err) } client := rpcs.NewGreeterClient(conn) fmt.Println(\u0026#34;ä¸€å…ƒRPCè°ƒç”¨ç¤ºä¾‹ï¼šSayUnary\u0026#34;) if err := rpcs.SayUnary(client); err != nil { panic(err) } fmt.Println(\u0026#34;\u0026#34;) fmt.Println(\u0026#34;æœåŠ¡ç«¯æµå¼RPCï¼šSayServerStream\u0026#34;) if err := rpcs.SayServerStream(client); err != nil { panic(err) } fmt.Println(\u0026#34;\u0026#34;) fmt.Println(\u0026#34;å®¢æˆ·ç«¯æµå¼RPCï¼šSayClientStream\u0026#34;) if err := rpcs.SayClientStream(client); err != nil { panic(err) } fmt.Println(\u0026#34;\u0026#34;) fmt.Println(\u0026#34;åŒå‘æµå¼RPCï¼šSayBidirectionalStream\u0026#34;) if err := rpcs.SayBidirectionalStream(client); err != nil { panic(err) } } å¯ä»¥çœ‹åˆ°,ä½¿ç”¨ gRpc ä½¿ç”¨æµå¼è°ƒç”¨å¯ä»¥æ›´çµæ´»çš„æ”¯æŒå¦‚æ•°æ®å®æ—¶æŸ¥è¯¢åŒæ­¥èƒ½ä¸šåŠ¡åœºæ™¯ã€‚\ngrpc æ‹¦æˆªå™¨ grpc æ‹¦æˆªå™¨(Interceptor)å¯ä»¥åœ¨æ¯ä¸€ä¸ª RPC æ–¹æ³•çš„å‰é¢æˆ–åé¢åšç»Ÿä¸€çš„ç‰¹æ®Šå¤„ç†ï¼Œå¹¶ä¸”ä¸ç›´æ¥ä¾µå…¥ä¸šåŠ¡ä»£ç ï¼Œ ä¾‹å¦‚é‰´æƒæ ¡éªŒã€è¶…æ—¶æ§åˆ¶ã€æ—¥å¿—è®°å½•ã€é“¾è·¯è·Ÿè¸ªç­‰ã€‚\næ‹¦æˆªå™¨çš„ç±»å‹åˆ†ä¸ºä¸¤ç§ï¼š\nä¸€å…ƒæ‹¦æˆªå™¨(UnaryInterceptor)ï¼šæ‹¦æˆªå’Œå¤„ç†ä¸€å…ƒ RPC è°ƒç”¨ã€‚ æµæ‹¦æˆªå™¨(StreamInterceptor)ï¼šæ‹¦æˆªå’Œå¤„ç†æµå¼ RPC è°ƒç”¨ã€‚ åˆ›å»ºä¸€ä¸ªä¸€å…ƒæ‹¦æˆªå™¨æ–¹æ³•\n1 2 3 4 func UnaryServerLoggingInterceptor(ctx context.Context, req interface{}, info *grpc.UnaryServerInfo, handler grpc.UnaryHandler) (interface{}, error) { resp, err := handler(ctx, req) return resp, err } ä½¿ç”¨æ–¹æ³•\n1 2 3 4 5 6 7 func main(){ opts := []grpc.ServerOption{ grpc.UnaryInterceptor(middlewares.UnaryServerLoggingInterceptor), } s := grpc.NewServer(opts...) } go-grpc-middleware æ‹¦æˆªåº“ å› ä¸º grpc æ‹¦æˆªå™¨ç±»å‹ä¸èƒ½é‡å¤ï¼Œå½“éœ€è¦å¤šä¸ªæ‹¦æˆªå™¨æ—¶ï¼Œå€ŸåŠ© go-grpc-middleware åº“æ¥å®ç°\nå®‰è£…åº“\n1 go get -u github.com/grpc-ecosystem/go-grpc-middleware å®šä¹‰ä¸¤ä¸ªä¸€å…ƒæœåŠ¡ç«¯æ‹¦æˆªå™¨\n1 2 3 4 5 6 7 8 9 func UnaryServerInterceptor1(ctx context.Context, req interface{}, info *grpc.UnaryServerInfo, handler grpc.UnaryHandler) (interface{}, error) { resp, err := handler(ctx, req) return resp, err } func UnaryServerInterceptor2(ctx context.Context, req interface{}, info *grpc.UnaryServerInfo, handler grpc.UnaryHandler) (interface{}, error) { resp, err := handler(ctx, req) return resp, err } ä½¿ç”¨æ–¹æ³•\n1 2 3 4 5 6 7 func main() { opts := []grpc.ServerOption{ grpc.UnaryInterceptor(grpc_middleware.ChainUnaryServer(middlewares.UnaryServerInterceptor1, middlewares.UnaryServerInterceptor2)), } s := grpc.NewServer(opts...) } proto ç¼–è¯‘å¼•ç”¨å¤–éƒ¨åŒ…é—®é¢˜\nè°ƒè¯• grpc å·¥å…· grpcurl grpcurl æ˜¯ä¸€ä¸ªå‘½ä»¤è¡Œå·¥å…·ï¼Œå¯è®©æ‚¨ä¸ gRPC æœåŠ¡å™¨è¿›è¡Œäº¤äº’ï¼ŒåŸºæœ¬ä¸Šæ˜¯ curl é’ˆå¯¹ gRPC æœåŠ¡å™¨çš„ã€‚\ngrpcurl\n1 2 brew install grpcurl grpcurl --version æŸ¥çœ‹ grpc æœåŠ¡æä¾›å“ªäº›æ¥å£åˆ—è¡¨ 1 grpcurl -plaintext 127.0.0.1:8080 list æŸ¥çœ‹ grpc æœåŠ¡æä¾›æ¥å£çš„æ–¹æ³•åˆ—è¡¨ 1 grpcurl -plaintext 127.0.0.1:8080 list Greeter æŸ¥çœ‹ grpc æœåŠ¡æä¾›æ¥å£çš„æ–¹æ³•è¯¦æƒ… 1 grpcurl -plaintext 127.0.0.1:8080 describe Greeter è°ƒç”¨æ–¹æ³• 1 2 grpcurl -plaintext -d \u0026#39;{\u0026#34;name\u0026#34;:\u0026#34;grpc\u0026#34;}\u0026#39; 127.0.0.1:8080 Greeter.SayUnary grpcurl -plaintext -d @ 127.0.0.1:8080 Greeter.SayUnary å‚è€ƒ åœ¨ Golang ä¸­å®ç° RPC RPC å…¥é—¨ Google Protobuf ç®€æ˜æ•™ç¨‹ RPC æ•™ç¨‹ ","permalink":"https://jackcipher.github.io/go-in-action/go-rpc/","summary":"\u003ch1 id=\"rpc-æŠ€æœ¯åˆ†äº«\"\u003eRPC æŠ€æœ¯åˆ†äº«\u003c/h1\u003e\n\u003ch2 id=\"rpc-ä»‹ç»\"\u003eRPC ä»‹ç»\u003c/h2\u003e\n\u003cp\u003eè¿œç¨‹è¿‡ç¨‹è°ƒç”¨(Remote Procedure Call ç¼©å†™ RPC)æ˜¯ä¸€ä¸ªè®¡ç®—æœºé€šä¿¡åè®®,é€šä¿—æ¥è®²å°±æ˜¯è°ƒç”¨è¿œç¨‹æœåŠ¡ä¸Šçš„ä¸€ä¸ªå‡½æ•°ï¼Œåœ¨è°ƒç”¨æ—¶å°†å¯¹è±¡åã€å‡½æ•°åã€å‚æ•°ç­‰ä¼ é€’ç»™è¿œç¨‹æœåŠ¡å™¨ï¼ŒæœåŠ¡å™¨å°†å¤„ç†ç»“æœè¿”å›ç»™å®¢æˆ·ç«¯ï¼Œå®¢æˆ·ç«¯è°ƒç”¨ server ç«¯æä¾›çš„æ¥å£å°±åƒæ˜¯è°ƒç”¨æœ¬åœ°çš„å‡½æ•°ä¸€æ ·ã€‚ RPC çš„æ¶ˆæ¯å¯ä»¥é€šè¿‡ TCPã€UDP æˆ–è€… HTTP ç­‰ä¼ è¾“ã€‚\u003c/p\u003e","title":"Go RPC åˆæ¢"},{"content":"å¦‚ä½•æ§åˆ¶ Prometheus ä¿ç•™å¤šå°‘å†å²è®°å½•ï¼Ÿ\nPrometheus å°†æ—¶é—´åºåˆ—åŠå…¶æ ·æœ¬å­˜å‚¨åœ¨ç£ç›˜ä¸Šã€‚é‰´äºç£ç›˜ç©ºé—´æ˜¯ä¸€ç§æœ‰é™èµ„æºï¼Œæˆ‘ä»¬å¸Œæœ›å¯¹ Prometheus ä½¿ç”¨çš„ç£ç›˜ç©ºé—´è¿›è¡Œä¸€äº›é™åˆ¶ã€‚åœ¨ä»¥å‰çš„ç‰ˆæœ¬ä¸­ï¼Œä½¿ç”¨ --storage.tsdb.retention å‚æ•°å³å¯å®Œæˆé…ç½®ã€‚è¿™ä¸ªå‚æ•°æŒ‡å®š Prometheus å°†ä¿æŒå¯ç”¨çš„æ—¶é—´èŒƒå›´ã€‚è¿™æ˜¯æœ€ä½è¦æ±‚ï¼Œå› æ­¤å¦‚æœå…¶ä¸­ä¸€äº›ä»åœ¨ä¿ç•™çª—å£å†…ï¼Œå®ƒå°†ä¿ç•™æ•´ä¸ªå—ã€‚å¦‚æœæ‚¨çŸ¥é“æ¯ç§’æ ·æœ¬çš„æ‘„å–ç‡ï¼Œé‚£ä¹ˆæ‚¨å¯ä»¥å°†å…¶ä¹˜ä»¥æ¯ä¸ªæ ·æœ¬çš„å­—èŠ‚æ•°ï¼ˆ1.5ishï¼Œä¸ºäº†å®‰å…¨èµ·è§ä¸º 2ï¼‰å’Œä¿ç•™æ—¶é—´ï¼Œä»¥äº†è§£å°†ä½¿ç”¨å¤šå°‘ç£ç›˜ç©ºé—´ã€‚\nä» Prometheus 2.7 å’Œ 2.8 å¼€å§‹ï¼Œretention å°†ä½¿ç”¨æ–°çš„å‚æ•°ã€‚ 2.7 å¼•å…¥äº†åŸºäºå¤§å°çš„ä¿ç•™é€‰é¡¹ --storage.tsdb.retention.sizeï¼Œå³æŒ‡å®šå—ä½¿ç”¨çš„æœ€å¤§ç£ç›˜ç©ºé—´é‡ã€‚è¿™ä»ç„¶æ˜¯ä¸€ä¸ªç†æƒ³çš„æŒ‡æ ‡ï¼Œå› ä¸ºå®ƒè¿˜ä¸åŒ…æ‹¬ WAL å ç”¨çš„ç©ºé—´æˆ–é€šè¿‡å‹ç¼©å¡«å……çš„å—ã€‚ä¸ºäº†å®‰å…¨èµ·è§ï¼Œä¸º WAL ç•™å‡ºç©ºé—´å’Œä¸€ä¸ªæœ€å¤§å¤§å°çš„å—ï¼ˆè¿™æ˜¯ä¿ç•™æ—¶é—´çš„ 10% å’Œä¸€ä¸ªæœˆä¸­è¾ƒå°çš„ä¸€ä¸ªï¼‰ã€‚\næ‰€æœ‰è¿™äº›æ ‡å¿—å¦‚ä½•ç›¸äº’ä½œç”¨ï¼Ÿè¿™ç§è¡Œä¸ºåœ¨ 2.8 ä¸­å˜å¾—æ›´åŠ æ˜æ˜¾ã€‚å…±æœ‰ä¸‰ä¸ªæ ‡å¿—ï¼š--storage.tsdb.retention.sizeã€--storage.tsdb.retention.time å’Œ --storage.tsdb.retentionã€‚ `\n\u0026ndash;storage.tsdb.retentionå·²å¼ƒç”¨ï¼Œç”±\u0026ndash;storage.tsdb.retention.time`å–ä»£ã€‚ä¸‹è¡¨æ€»ç»“äº†å®ƒä»¬å åŠ åˆ°ä¸€èµ·æ—¶æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼š\n--storage.tsdb. retention.size --storage.tsdb. retention.time --storage.tsdb. retention ç»“æœ ä¸è®¾ç½® ä¸è®¾ç½® ä¸è®¾ç½® é»˜è®¤ä¿ç•™ 15 å¤© ä¸è®¾ç½® 20d ä¸è®¾ç½® ä¿ç•™ 20 å¤© ä¸è®¾ç½® Not set 10d ä¿ç•™ 10 å¤© ä¸è®¾ç½® 20d 10d ä¿ç•™ 20 å¤© 1TB ä¸è®¾ç½® ä¸è®¾ç½® ä¿ç•™ 1TB å¤§å°ï¼Œæ—¶é—´ä¸é™åˆ¶ 1TB 20d ä¸è®¾ç½® ä¿ç•™ 1TB å¤§å°æˆ– 20 å¤©ï¼Œä»¥å…ˆåˆ°ä¸ºå‡† 1TB 20d 10d ä¿ç•™ 1TB å¤§å°æˆ– 20 å¤© ï¼Œä»¥å…ˆåˆ°ä¸ºå‡† å¦‚è¡¨æ ¼æ‰€ç¤ºï¼Œ--storage.tsdb.retention.time è¦†ç›–äº†å·²å¼ƒç”¨çš„ --storage.tsdb.retentionï¼Œå¹¶ä¸”åŸºäºæ—¶é—´å’Œå¤§å°çš„ä¿ç•™å¯ä»¥åŒæ—¶ç”Ÿæ•ˆã€‚ æˆ‘è¿˜æƒ³è¯´æ˜ä¸€ä¸ªå¸¸è§çš„æ··æ·†æ˜¯ Prometheus å­˜å‚¨ä¿ç•™æœŸä¸é™äº 15 å¤©ã€‚è¿™åªæ˜¯å¤šå¹´å‰é€‰æ‹©çš„é»˜è®¤è®¾ç½®ï¼Œå®Œå…¨å¯ä»¥å°†å…¶è®¾ç½®å¾—æ›´é«˜ã€‚\n","permalink":"https://jackcipher.github.io/promethues/prometheus-retention/","summary":"\u003cp\u003eå¦‚ä½•æ§åˆ¶ Prometheus ä¿ç•™å¤šå°‘å†å²è®°å½•ï¼Ÿ\u003c/p\u003e\n\u003cp\u003ePrometheus å°†æ—¶é—´åºåˆ—åŠå…¶æ ·æœ¬å­˜å‚¨åœ¨ç£ç›˜ä¸Šã€‚é‰´äºç£ç›˜ç©ºé—´æ˜¯ä¸€ç§æœ‰é™èµ„æºï¼Œæˆ‘ä»¬å¸Œæœ›å¯¹ Prometheus ä½¿ç”¨çš„ç£ç›˜ç©ºé—´è¿›è¡Œä¸€äº›é™åˆ¶ã€‚åœ¨ä»¥å‰çš„ç‰ˆæœ¬ä¸­ï¼Œä½¿ç”¨ \u003ccode\u003e--storage.tsdb.retention\u003c/code\u003e å‚æ•°å³å¯å®Œæˆé…ç½®ã€‚è¿™ä¸ªå‚æ•°æŒ‡å®š Prometheus å°†ä¿æŒå¯ç”¨çš„æ—¶é—´èŒƒå›´ã€‚è¿™æ˜¯æœ€ä½è¦æ±‚ï¼Œå› æ­¤å¦‚æœå…¶ä¸­ä¸€äº›ä»åœ¨ä¿ç•™çª—å£å†…ï¼Œå®ƒå°†ä¿ç•™æ•´ä¸ªå—ã€‚å¦‚æœæ‚¨çŸ¥é“æ¯ç§’æ ·æœ¬çš„æ‘„å–ç‡ï¼Œé‚£ä¹ˆæ‚¨å¯ä»¥å°†å…¶ä¹˜ä»¥æ¯ä¸ªæ ·æœ¬çš„å­—èŠ‚æ•°ï¼ˆ1.5ishï¼Œä¸ºäº†å®‰å…¨èµ·è§ä¸º 2ï¼‰å’Œä¿ç•™æ—¶é—´ï¼Œä»¥äº†è§£å°†ä½¿ç”¨å¤šå°‘ç£ç›˜ç©ºé—´ã€‚\u003c/p\u003e","title":"Prometheus æ•°æ®ä¿ç•™æ—¶é—´"},{"content":"å‡†å¤‡å·¥ä½œ å®‰è£… delve é¡¹ç›®ä»£ç  1 2 git clone git@git.baijiashilian.com:web/demo/go-debug-demo.git git clone git@git.baijiashilian.com:web/gotools/gitlab-tools.git è°ƒè¯•å·¥å…· delve delve å®‰è£… https://github.com/go-delve/delve/tree/master/Documentation/installation 1 go install github.com/go-delve/delve/cmd/dlv@latest dlv é…ç½® 1 ~/.dlv/config.yml è°ƒè¯•æ–¹å¼ æœ¬åœ°è°ƒè¯• ä»æºç å¼€å§‹ç¼–è¯‘å¹¶å¼€å§‹è°ƒè¯• 1 dlv debug [package] [flags] è°ƒè¯•å·²ç»ç¼–è¯‘å¥½çš„äºŒè¿›åˆ¶æ–‡ä»¶ 1 dlv exec ./hello -- args1 args2 ç¼–è¯‘çš„æ—¶å€™éœ€è¦ç¦ç”¨ç¼–è¯‘å™¨ä¼˜åŒ–ï¼šgo build -gcflags=\u0026quot;-N -l\u0026quot; ç¼–è¯‘é€‰é¡¹æœ‰å“ªäº›ï¼šgo tool compile -h è°ƒè¯•æ­£åœ¨è¿è¡Œçš„è¿›ç¨‹ 1 dlv attach pid [executable] [flags] è°ƒè¯•å•å…ƒæµ‹è¯• 1 dlv test [package] [flags] è¿œç¨‹è°ƒè¯• JSON-RPC \u0026amp; DAP 1 dlv --headless --listen 0.0.0.0:2345 \u0026lt;command\u0026gt; \u0026lt;target\u0026gt; \u0026lt;args\u0026gt; å…¼å®¹dlv connectã€VS Code Goã€GoLand\nä½¿ç”¨ DAP(Debugger Adapter Protocol) å¼€å¯ä¸€ä¸ª DAP Serverï¼Œåªæ”¯æŒ DAP åè®®\n1 dlv dap --listen 0.0.0.0:2345 [flags] åªæ”¯æŒVS Codeï¼Œä¸æ”¯æŒGoLandã€dlv connect\nå®¢æˆ·ç«¯ dlv connect 1 dlv connect \u0026lt;addr\u0026gt; å®è·µæ“ä½œ æœ¬åœ°è°ƒè¯• - dlv å‘½ä»¤è¡Œ å‡†å¤‡æºç  1 git clone git@git.baijiashilian.com:web/gotools/gitlab-tools.git å¯åŠ¨ dlv 1 dlv debug -- project ls åŠ æ–­ç‚¹ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 âœ gitlab-tools git:(master) dlv debug -- project ls //ç¼–è¯‘å¹¶å¼€å§‹è¿è¡Œç¨‹åºï¼Œå‘½ä»¤è¡Œå‚æ•° project ls Type \u0026#39;help\u0026#39; for list of commands. (dlv) c /*****è¿è¡Œç¨‹åºåˆ°ä¸‹ä¸€ä¸ªæ–­ç‚¹å¤„ï¼Œå› ä¸ºæ²¡åŠ è¿‡æ–­ç‚¹ï¼Œæ‰€ä»¥ç¨‹åºç›´æ¥è¿è¡Œç»“æŸäº†*****/ Warning: load config failed! error:config file:/Users/caiyili/.gitlab/config not exists! 254 android/maven https://git.baijiashilian.com/android/maven Process 81002 has exited with status 0 (dlv) b root.go:53 /*****å°è¯•ç»™room.goç¬¬53è¡ŒåŠ æ–­ç‚¹ï¼Œå¤±è´¥äº†ï¼Œæç¤ºè¿›ç¨‹å·²ç»ç»“æŸ*****/ Process 81002 has exited with status 0 (dlv) r /*****é‡å¯ç¨‹åº*****/ Process restarted with PID 81007 (dlv) b root.go:53 /*****å†æ¬¡æµ“åº¦ç»™room.goç¬¬53è¡ŒåŠ æ–­ç‚¹ï¼Œæç¤ºè¿™ä¸ªroom.goæ–‡ä»¶æœ‰æ­§ä¹‰*****/ Command failed: Location \u0026#34;root.go:53\u0026#34; ambiguous: /Users/caiyili/Code/gitlab-tools/cmd/root.go, /usr/local/go/src/crypto/x509/root.goâ€¦ (dlv) b cmd/root.go:53 /*****ç»™cmd/root.go:53åŠ æ–­ç‚¹*****/ Breakpoint 1 set at 0x104899fb0 for gitlab-tools/cmd.onInit() ./cmd/root.go:53 (dlv) bp /****æŸ¥çœ‹æ‰€æœ‰æ–­ç‚¹*****/ Breakpoint runtime-fatal-throw (enabled) at 0x10448e2b0 for runtime.throw() /usr/local/go/src/runtime/panic.go:982 (0) Breakpoint unrecovered-panic (enabled) at 0x10448e5c0 for runtime.fatalpanic() /usr/local/go/src/runtime/panic.go:1065 (0) print runtime.curg._panic.arg Breakpoint 1 (enabled) at 0x104899fb0 for gitlab-tools/cmd.onInit() ./cmd/root.go:53 (0) (dlv) c /*****è¿è¡Œç¨‹åºåˆ°ä¸‹ä¸€ä¸ªæ–­ç‚¹å¤„******/ \u0026gt; gitlab-tools/cmd.onInit() ./cmd/root.go:53 (hits goroutine(1):1 total:1) (PC: 0x104899fb0) 48: 49:\tfunc onInit() { 50:\tif cfgPath == \u0026#34;\u0026#34; { 51:\tcfgPath = config.GetDefaultCfgPath() 52:\t} =\u0026gt; 53:\tif err := config.LoadConfig(cfgPath); err != nil { 54:\tfmt.Fprintf(os.Stderr, \u0026#34;Warning: load config failed! error:%v \\n\\n\u0026#34;, err) 55:\t} 56:\tcfg = config.Cfg() 57:\tif verbose { 58:\tprintJson(cfg) (dlv) locals (no locals) (dlv) p cfgPath \u0026#34;/Users/caiyili/.gitlab/config\u0026#34; (dlv) vars cmd.cfg* gitlab-tools/cmd.cfgCmd = (\u0026#34;*github.com/spf13/cobra.Command\u0026#34;)(0x104bc79a0) gitlab-tools/cmd.cfgShowCmd = (\u0026#34;*github.com/spf13/cobra.Command\u0026#34;)(0x104bc7c20) gitlab-tools/cmd.cfgSetCmd = (\u0026#34;*github.com/spf13/cobra.Command\u0026#34;)(0x104bcb0a0) gitlab-tools/cmd.cfgPath = \u0026#34;/Users/caiyili/.gitlab/config\u0026#34; gitlab-tools/cmd.cfg = *gitlab-tools/config.Config nil (dlv) l \u0026gt; gitlab-tools/cmd.onInit() ./cmd/root.go:53 (hits goroutine(1):1 total:1) (PC: 0x104899fb0) 48: 49:\tfunc onInit() { 50:\tif cfgPath == \u0026#34;\u0026#34; { 51:\tcfgPath = config.GetDefaultCfgPath() 52:\t} =\u0026gt; 53:\tif err := config.LoadConfig(cfgPath); err != nil { 54:\tfmt.Fprintf(os.Stderr, \u0026#34;Warning: load config failed! error:%v \\n\\n\u0026#34;, err) 55:\t} 56:\tcfg = config.Cfg() 57:\tif verbose { 58:\tprintJson(cfg) (dlv) s /*****step ä¸‹ä¸€æ­¥ï¼Œä¼šè¿›åˆ°è°ƒç”¨å‡½æ•°é‡Œ****/ \u0026gt; gitlab-tools/config.LoadConfig() ./config/config.go:28 (PC: 0x1045d5f30) 23: 24:\tfunc (c *Config) GetApiHost() string { 25:\treturn c.Host 26:\t} 27: =\u0026gt; 28:\tfunc LoadConfig(cfgPath string) (err error) { 29:\tvar c = cfg 30:\tc.path = cfgPath 31:\tif !fileExist(cfgPath) { 32:\treturn fmt.Errorf(\u0026#34;config file:%s not exists!\u0026#34;, cfgPath) 33:\t} (dlv) n /*****ä¸‹ä¸€è¡Œæºç *****/ \u0026gt; gitlab-tools/config.LoadConfig() ./config/config.go:32 (PC: 0x1045d61a4) 27: 28:\tfunc LoadConfig(cfgPath string) (err error) { 29:\tvar c = cfg 30:\tc.path = cfgPath 31:\tif !fileExist(cfgPath) { =\u0026gt; 32:\treturn fmt.Errorf(\u0026#34;config file:%s not exists!\u0026#34;, cfgPath) 33:\t} 34:\tfile, err := os.OpenFile(cfgPath, os.O_RDONLY, 0644) 35:\tif err != nil { 36:\treturn fmt.Errorf(\u0026#34;read config file \u0026#39;%s\u0026#39; error: %w\u0026#34;, cfgPath, err) 37:\t} (dlv) stepout /*****æŠŠå½“å‰å‡½æ•°æ‰§è¡Œå®Œï¼Œå›åˆ°ä¸Šä¸€å±‚å‡½æ•°*****/ \u0026gt; gitlab-tools/cmd.onInit() ./cmd/root.go:53 (PC: 0x104899fc4) Values returned: err: error(*errors.errorString) *{ s: \u0026#34;config file:/Users/caiyili/.gitlab/config not exists!\u0026#34;,} 48: 49:\tfunc onInit() { 50:\tif cfgPath == \u0026#34;\u0026#34; { 51:\tcfgPath = config.GetDefaultCfgPath() 52:\t} =\u0026gt; 53:\tif err := config.LoadConfig(cfgPath); err != nil { 54:\tfmt.Fprintf(os.Stderr, \u0026#34;Warning: load config failed! error:%v \\n\\n\u0026#34;, err) 55:\t} 56:\tcfg = config.Cfg() 57:\tif verbose { 58:\tprintJson(cfg) (dlv) è¿œç¨‹è°ƒè¯• - VSCode 1 git@git.baijiashilian.com:web/demo/go-debug-demo.git è¿œç¨‹æœºå™¨å¯åŠ¨ dlv 1 2 3 cd /apps/home/caiyili/baijiayun/go-debug-demo dlv debug -l 0.0.0.0:2345 --headless --api-version=2 --log --log-output=dap,rpc VSCode é…ç½® launch.json 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 { \u0026#34;version\u0026#34;: \u0026#34;0.2.0\u0026#34;, \u0026#34;configurations\u0026#34;: [ { \u0026#34;name\u0026#34;: \u0026#34;remote-debug-demo\u0026#34;, \u0026#34;type\u0026#34;: \u0026#34;go\u0026#34;, \u0026#34;request\u0026#34;: \u0026#34;attach\u0026#34;, \u0026#34;mode\u0026#34;: \u0026#34;remote\u0026#34;, \u0026#34;remotePath\u0026#34;: \u0026#34;/apps/home/caiyili/baijiayun/go-debug-demo\u0026#34;, \u0026#34;port\u0026#34;: 2345, \u0026#34;substitutePath\u0026#34;: [{ \u0026#34;from\u0026#34;: \u0026#34;/apps/home/caiyili/baijiayun/go-debug-demo\u0026#34;, \u0026#34;to\u0026#34;: \u0026#34;/Users/caiyili/Code/go-debug-demo\u0026#34; }], \u0026#34;host\u0026#34;: \u0026#34;test-www.baijiayun.com\u0026#34; }, { \u0026#34;name\u0026#34;: \u0026#34;launch-debug-demo\u0026#34;, \u0026#34;type\u0026#34;: \u0026#34;go\u0026#34;, \u0026#34;request\u0026#34;: \u0026#34;launch\u0026#34;, \u0026#34;mode\u0026#34;: \u0026#34;auto\u0026#34;, \u0026#34;program\u0026#34;: \u0026#34;${fileDirname}\u0026#34; } ] } VSCode Launch é…ç½®å‚è€ƒhttps://code.visualstudio.com/docs/editor/debugging#_launch-configurations\ndlv connect 1 dlv connect test-www.baijiayun.com:2345![image.png] ç‚¹å‡»å¼€å§‹è°ƒè¯• æœåŠ¡ç«¯æ—¥å¿—\næ·»åŠ æ–­ç‚¹ è®¿é—®é¡µé¢ 1 curl http://test-www.baijiayun.com:8088/view å¸¸ç”¨å‘½ä»¤ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 (dlv) help The following commands are available: Running the program: continue (alias: c) --------- Run until breakpoint or program termination. next (alias: n) ------------- Step over to next source line. restart (alias: r) ---------- Restart process. step (alias: s) ------------- Single step through program. step-instruction (alias: si) Single step a single cpu instruction. stepout (alias: so) --------- Step out of the current function. Manipulating breakpoints: break (alias: b) ------- Sets a breakpoint. breakpoints (alias: bp) Print out info for active breakpoints. clear ------------------ Deletes breakpoint. Viewing program variables and memory: args ----------------- Print function arguments. locals --------------- Print local variables. print (alias: p) ----- Evaluate an expression. vars ----------------- Print package variables. whatis --------------- Prints type of an expression. Listing and switching between threads and goroutines: goroutine (alias: gr) -- Shows or changes current goroutine goroutines (alias: grs) List program goroutines. Other commands: list (alias: ls | l) ------- Show source code. FAQ è¿œç¨‹è°ƒè¯•éœ€è¦åšä»£ç è·¯å¾„æ˜ å°„ dlv å‘½ä»¤ä¸­æ˜ å°„ 1 (dlv) config substitute-path /apps/home/caiyili/baijiayun/go-debug-demo /Users/caiyili/Code/go-debug-demo vscode launch é…ç½® 1 2 3 4 5 6 \u0026#34;substitutePath\u0026#34;: [ { \u0026#34;from\u0026#34;: \u0026#34;/apps/home/caiyili/baijiayun/go-debug-demo\u0026#34;, \u0026#34;to\u0026#34;: \u0026#34;/Users/caiyili/Code/go-debug-demo\u0026#34; } ] dlv é…ç½®æ–‡ä»¶ä¸­é…ç½®æ˜ å°„ ~/.dlv/config 1 2 3 4 # commands. substitute-path: - {from: /apps/home/caiyili/baijiayun/prometheus-demo , to: /Users/caiyili/Code/prometheus-demo } # - {from: path, to: path} https://github.com/go-delve/delve/blob/master/Documentation/faq.md DAP ç›¸å…³èµ„æ–™ DAP: Debug Adapter Protocol LSP: Language Server Protocol VSCode Launch é…ç½® go compile å‘½ä»¤é€‰é¡¹ï¼šhttps://pkg.go.dev/cmd/compile gdb set-substitute ","permalink":"https://jackcipher.github.io/go-in-action/go-delve/","summary":"\u003ch2 id=\"å‡†å¤‡å·¥ä½œ\"\u003eå‡†å¤‡å·¥ä½œ\u003c/h2\u003e\n\u003col\u003e\n\u003cli\u003eå®‰è£… delve\u003c/li\u003e\n\u003cli\u003eé¡¹ç›®ä»£ç \u003c/li\u003e\n\u003c/ol\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egit clone git@git.baijiashilian.com:web/demo/go-debug-demo.git\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egit clone git@git.baijiashilian.com:web/gotools/gitlab-tools.git\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch2 id=\"è°ƒè¯•å·¥å…·-delve\"\u003eè°ƒè¯•å·¥å…· delve\u003c/h2\u003e\n\u003ch3 id=\"delve-å®‰è£…\"\u003edelve å®‰è£…\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/go-delve/delve/tree/master/Documentation/installation\"\u003ehttps://github.com/go-delve/delve/tree/master/Documentation/installation\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ego install github.com/go-delve/delve/cmd/dlv@latest\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"dlv-é…ç½®\"\u003edlv é…ç½®\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e~/.dlv/config.yml\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch2 id=\"è°ƒè¯•æ–¹å¼\"\u003eè°ƒè¯•æ–¹å¼\u003c/h2\u003e\n\u003ch3 id=\"æœ¬åœ°è°ƒè¯•\"\u003eæœ¬åœ°è°ƒè¯•\u003c/h3\u003e\n\u003ch4 id=\"ä»æºç å¼€å§‹ç¼–è¯‘å¹¶å¼€å§‹è°ƒè¯•\"\u003eä»æºç å¼€å§‹ç¼–è¯‘å¹¶å¼€å§‹è°ƒè¯•\u003c/h4\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003edlv debug \u003cspan class=\"o\"\u003e[\u003c/span\u003epackage\u003cspan class=\"o\"\u003e]\u003c/span\u003e \u003cspan class=\"o\"\u003e[\u003c/span\u003eflags\u003cspan class=\"o\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch4 id=\"è°ƒè¯•å·²ç»ç¼–è¯‘å¥½çš„äºŒè¿›åˆ¶æ–‡ä»¶\"\u003eè°ƒè¯•å·²ç»ç¼–è¯‘å¥½çš„äºŒè¿›åˆ¶æ–‡ä»¶\u003c/h4\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003edlv \u003cspan class=\"nb\"\u003eexec\u003c/span\u003e ./hello -- args1 args2\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cblockquote\u003e\n\u003col\u003e\n\u003cli\u003eç¼–è¯‘çš„æ—¶å€™éœ€è¦ç¦ç”¨ç¼–è¯‘å™¨ä¼˜åŒ–ï¼š\u003ccode\u003ego build -gcflags=\u0026quot;-N -l\u0026quot;\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003eç¼–è¯‘é€‰é¡¹æœ‰å“ªäº›ï¼š\u003ccode\u003ego tool compile -h\u003c/code\u003e\u003c/li\u003e\n\u003c/ol\u003e\u003c/blockquote\u003e\n\u003ch4 id=\"è°ƒè¯•æ­£åœ¨è¿è¡Œçš„è¿›ç¨‹\"\u003eè°ƒè¯•æ­£åœ¨è¿è¡Œçš„è¿›ç¨‹\u003c/h4\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003edlv attach pid \u003cspan class=\"o\"\u003e[\u003c/span\u003eexecutable\u003cspan class=\"o\"\u003e]\u003c/span\u003e \u003cspan class=\"o\"\u003e[\u003c/span\u003eflags\u003cspan class=\"o\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch4 id=\"è°ƒè¯•å•å…ƒæµ‹è¯•\"\u003eè°ƒè¯•å•å…ƒæµ‹è¯•\u003c/h4\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003edlv \u003cspan class=\"nb\"\u003etest\u003c/span\u003e \u003cspan class=\"o\"\u003e[\u003c/span\u003epackage\u003cspan class=\"o\"\u003e]\u003c/span\u003e \u003cspan class=\"o\"\u003e[\u003c/span\u003eflags\u003cspan class=\"o\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"è¿œç¨‹è°ƒè¯•\"\u003eè¿œç¨‹è°ƒè¯•\u003c/h3\u003e\n\u003ch4 id=\"json-rpc--dap\"\u003eJSON-RPC \u0026amp; DAP\u003c/h4\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003edlv --headless --listen 0.0.0.0:2345 \u0026lt;command\u0026gt; \u0026lt;target\u0026gt; \u0026lt;args\u0026gt;\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cblockquote\u003e\n\u003cp\u003eå…¼å®¹\u003ccode\u003edlv connect\u003c/code\u003eã€\u003ccode\u003eVS Code Go\u003c/code\u003eã€\u003ccode\u003eGoLand\u003c/code\u003e\u003c/p\u003e","title":"Go ä¹‹ Delve è°ƒè¯•"},{"content":"åœ¨ Alertmanager ä¸­æœ‰ä¸‰ä¸ªè·Ÿå‘¨æœŸç›¸å…³çš„å‚æ•°ï¼Œåˆ†åˆ«æ˜¯ group_wait, group_interval, repeat_intervalã€‚åˆç†åœ°é…ç½®å‚æ•°ï¼Œæœ‰åˆ©äºé™ä½å‘Šè­¦é¢‘ç‡ï¼Œé¿å…å‘Šè­¦é£æš´äº§ç”Ÿã€‚\nåœ¨æ·±å…¥äº†è§£è¿™ä¸‰ä¸ªå‚æ•°ä¹‹å‰ï¼Œé¦–å…ˆéœ€è¦å…³æ³¨åˆ° Prometheus ä¸­ä¹Ÿæœ‰ä¸¤ä¸ªå‘¨æœŸå‡½æ•°ï¼Œscrape_interval ä¸ evaluation_intervalã€‚\nPrometheus æ¯é—´éš”ä¸€ä¸ª scrape_interval å®Œæˆä¸€æ¬¡æŒ‡æ ‡çš„æ‹‰å–ï¼Œå¹¶å°†æŒ‡æ ‡æ•°æ®å­˜å‚¨åˆ° TSDB æ•°æ®åº“ï¼Œå¹¶ä¸”åœ¨å¦å¤–ä¸€ä¸ªåç¨‹é‡Œï¼Œæ¯é—´éš”ä¸€ä¸ª evaluation_interval å®Œæˆä¸€æ¬¡å‘Šè­¦è¯„ä¼°ã€‚å…·ä½“æµç¨‹å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š\nå½“å®Œæˆä¸€æ¬¡è§„åˆ™è¯„ä¼°åï¼Œå®ƒçš„çŠ¶æ€ä¼šå˜æˆ inactive, pending, firing ä¸‰ç§ä¸­çš„ä¸€ç§ã€‚å¹¶ä¸”å®ƒçš„çŠ¶æ€ä¼šå‘é€åˆ° Alertmanager ç”¨äºå¼€å¯æˆ–ç»ˆæ­¢å‘Šè­¦é€šçŸ¥ã€‚\nä¸ºäº†é¿å…æŒç»­å‘é€ç›¸ä¼¼çš„å‘Šè­¦ä¿¡æ¯ï¼ŒAlertmanager å¯¹ç›¸å…³çš„å‘Šè­¦è¿›è¡Œäº†åˆ†ç»„ã€‚\n1 group_by: [\u0026#39;alertname\u0026#39;, \u0026#39;job\u0026#39;] ä¸Šè¿°é…ç½®ï¼Œä¼šå°†å…·æœ‰ç›¸åŒçš„ alertname åŠ job çš„å‘Šè­¦ä¿¡æ¯æ”¾åˆ°ä¸€ä¸ªç»„é‡Œï¼Œä¸€æ¬¡æ€§åœ°æ¨é€å‡ºæ¥ã€‚group_wait å°±æ˜¯ç”¨æ¥ç­‰å¾…åˆ†ç»„çš„æ—¶é—´ã€‚ä¸€ä¸ªç»„å°±ç›¸å½“äºä¸€è¶Ÿç­è½¦ï¼Œåªè¦è¶…è¿‡äº† group_wait ä¸ç®¡è½¦é‡Œé¢è£…äº†å¤šå°‘äººï¼Œéƒ½è¦è¿›è¡Œå‘è½¦ã€‚ç›¸åï¼Œå¦‚æœ group_wait é…ç½®çš„æ—¶é—´å¤ªé•¿ï¼Œå³ä½¿è½¦è£…æ»¡äº†ï¼Œè¿˜éœ€è¦ç­‰å¾…åˆ«äººä¸Šè½¦ã€‚å› æ­¤ï¼Œåˆç†åœ°é…ç½® group_wait æœ‰åˆ©äºå‘Šè­¦çš„ç®¡ç†ã€‚\nå®Œæˆåˆ†ç»„ä¹‹åï¼Œå‘Šè­¦æ¨é€ç»™ä¸‹æ¸¸ç¯èŠ‚ã€‚å¦‚æœä¸€ä¸ªå‘Šè­¦ä¹‹å‰å·²ç»åŠ åˆ°åˆ†ç»„å†…äº†ï¼Œé‚£ä¹ˆè¯¥å‘Šè­¦ä¸æ˜¯ç«‹å³è¿›è¡Œæ¨é€çš„ï¼Œè€Œæ˜¯ç­‰å¾… group_interval åï¼Œæ‰ä¼šè¿›è¡Œæ¨é€ã€‚è¿™è¿›ä¸€æ­¥åœ°å»¶é•¿äº†å‘Šè­¦æ—¶é—´ï¼Œé™ä½äº†å‘Šè­¦é£æš´çš„é£é™©ã€‚\næ¨é€å‘Šè­¦æ—¶ï¼Œæœ‰çš„å‘Šè­¦ä¼šæ¨é€å¤±è´¥ï¼Œæœ‰çš„ä¼šæˆåŠŸã€‚å¦‚æœæ¨é€æˆåŠŸäº†ä¹‹åï¼Œåœ¨å¾ˆçŸ­çš„æ—¶é—´åˆæ”¶åˆ°äº†ç›¸åŒçš„å‘Šè­¦ï¼Œé‚£ä¹ˆåˆ™éœ€è¦ä½¿ç”¨ repeat_interval è¿›è¡ŒæŠ‘åˆ¶ã€‚é¿å…ç›¸åŒçš„å‘Šè­¦é‡å¤æ¨é€ã€‚\næ€»ç»“ group_wait åœ¨æœ€åˆå‘é€é€šçŸ¥ä¹‹å‰ç­‰å¾…ç¼“å†²åŒä¸€ç»„çš„è­¦æŠ¥çš„æ—¶é—´ã€‚\ngroup_interval åœ¨å‘é€å·²æ·»åŠ åˆ°å·²ç»æœ‰é€šçŸ¥çš„ç»„ä¸­çš„è­¦æŠ¥ä¹‹å‰ç­‰å¾…å¤šé•¿æ—¶é—´ã€‚\nrepeat_interval åœ¨é‡æ–°å‘é€å·²åœ¨é€šçŸ¥ä¸­å‘é€çš„ç»™å®šè­¦æŠ¥ä¹‹å‰ç­‰å¾…å¤šé•¿æ—¶é—´ã€‚\n","permalink":"https://jackcipher.github.io/promethues/alertmanager-duration-args/","summary":"\u003cp\u003eåœ¨ Alertmanager ä¸­æœ‰ä¸‰ä¸ªè·Ÿå‘¨æœŸç›¸å…³çš„å‚æ•°ï¼Œåˆ†åˆ«æ˜¯ group_wait, group_interval, repeat_intervalã€‚åˆç†åœ°é…ç½®å‚æ•°ï¼Œæœ‰åˆ©äºé™ä½å‘Šè­¦é¢‘ç‡ï¼Œé¿å…å‘Šè­¦é£æš´äº§ç”Ÿã€‚\u003c/p\u003e\n\u003cp\u003eåœ¨æ·±å…¥äº†è§£è¿™ä¸‰ä¸ªå‚æ•°ä¹‹å‰ï¼Œé¦–å…ˆéœ€è¦å…³æ³¨åˆ° Prometheus ä¸­ä¹Ÿæœ‰ä¸¤ä¸ªå‘¨æœŸå‡½æ•°ï¼Œscrape_interval ä¸ evaluation_intervalã€‚\u003c/p\u003e","title":"Alertmanager ä¸­çš„å‘¨æœŸå‚æ•°"},{"content":"Prometheus é™¤äº†æä¾›æ—¶åºæ•°æ®åº“å’Œç›‘æ§ç³»ç»Ÿå­˜åœ¨ï¼Œå…¶æœ¬èº«ä¹Ÿå¯¹å¤–æä¾›äº† Web æœåŠ¡ï¼Œç”¨äºæä¾›æŠ¥è¡¨å±•ç¤ºåŠè¡¨è¾¾å¼è®¡ç®—ï¼Œä»¥åŠç”¨äºæ›´æ–°é…ç½®æ–‡ä»¶ç­‰åŠŸèƒ½çš„ APIã€‚\nå¤„äºå®‰å…¨è€ƒè™‘ï¼Œåœ¨å¯¹å¤–çš„ Web æœåŠ¡é‡Œï¼Œæˆ‘ä»¬éœ€è¦å¢åŠ èº«ä»½è®¤è¯ã€‚Prometheus æä¾› Basic Auth èº«ä»½è®¤è¯ã€‚\nè®¡ç®— Hash Prometheus å®˜ç½‘æä¾›äº†ä¸¤ç§æ–¹å¼è®¡ç®— Hash:ä¸€ç§æ˜¯ç›´æ¥è®¿é—® bcrypt, åœ¨çº¿ç”Ÿæˆã€‚å¦ä¸€ç§åˆ™æ˜¯é€šè¿‡ Python è„šæœ¬å®Œæˆ hash è®¡ç®—ã€‚\nå…·ä½“ä»£ç å¦‚ä¸‹ï¼š\n1 2 3 4 5 6 import getpass import bcrypt password = getpass.getpass(\u0026#34;password: \u0026#34;) hashed_password = bcrypt.hashpw(password.encode(\u0026#34;utf-8\u0026#34;), bcrypt.gensalt()) print(hashed_password.decode()) åˆ›å»ºé…ç½®æ–‡ä»¶ åœ¨ /etc/prometheus ç›®å½•ä¸‹ï¼Œåˆ›å»º config.yml æ–‡ä»¶ã€‚æ–‡ä»¶å†…å®¹å¦‚ä¸‹ï¼š\n1 2 basic_auth_users: admin: $2b$12$hNf2lSsxfm0.i4a.1kVpSOVyBCfIB51VRjgBUyv6kdnyTlgWj81Ay ä½¿ç”¨ prometheus è‡ªå¸¦çš„ promtool è¿›è¡Œé…ç½®æ–‡ä»¶æ ¡éªŒ:\n1 2 $ promtool check web-config web.yml web.yml SUCCESS å¯åŠ¨æœåŠ¡ å®Œæˆé…ç½®æ–‡ä»¶åˆ›å»ºåï¼Œä½¿ç”¨ web.config.file å‚æ•°è¿›è¡Œé…ç½®æ–‡ä»¶åŠ è½½ï¼š\n1 $ prometheus --web.config.file=web.yml å½“ prometheus æœåŠ¡å¯åŠ¨åï¼Œå¯ä»¥é€šè¿‡ curl è¿›è¡ŒéªŒè¯ï¼š\n1 curl --head http://localhost:9090/graph åœ¨æœªå¢åŠ  Basic Auth è¯·æ±‚å¤´çš„æƒ…å†µä¸‹ï¼ŒæœåŠ¡è¿”å› 401 ä¸æˆ‘ä»¬é¢„æœŸä¸€è‡´ã€‚\n","permalink":"https://jackcipher.github.io/promethues/prom_with_auth/","summary":"\u003cp\u003ePrometheus é™¤äº†æä¾›æ—¶åºæ•°æ®åº“å’Œç›‘æ§ç³»ç»Ÿå­˜åœ¨ï¼Œå…¶æœ¬èº«ä¹Ÿå¯¹å¤–æä¾›äº† Web æœåŠ¡ï¼Œç”¨äºæä¾›æŠ¥è¡¨å±•ç¤ºåŠè¡¨è¾¾å¼è®¡ç®—ï¼Œä»¥åŠç”¨äºæ›´æ–°é…ç½®æ–‡ä»¶ç­‰åŠŸèƒ½çš„ APIã€‚\u003c/p\u003e\n\u003cp\u003eå¤„äºå®‰å…¨è€ƒè™‘ï¼Œåœ¨å¯¹å¤–çš„ Web æœåŠ¡é‡Œï¼Œæˆ‘ä»¬éœ€è¦å¢åŠ èº«ä»½è®¤è¯ã€‚Prometheus æä¾› Basic Auth èº«ä»½è®¤è¯ã€‚\u003c/p\u003e","title":"Prometheus å¢åŠ èº«ä»½è®¤è¯"},{"content":"æ¦‚å¿µ Kubernetes ä¸­ï¼ŒPod å†…éƒ¨è¿›ç¨‹æƒ³è¦è®¿é—® API Serverï¼Œå°±éœ€è¦ç”¨åˆ° ServiceAccountã€‚ServiceAccount ç±»ä¼¼ä¸šåŠ¡ç³»ç»Ÿé‡Œçš„è´¦æˆ·ï¼Œç”¨äºä¸º Pod æä¾›èº«ä»½ã€‚\né»˜è®¤æƒ…å†µä¸‹ï¼Œåº”ç”¨ç¨‹åºå°†ä½¿ç”¨ä»–ä»¬ namespace ä¸­çš„ default è´¦å·è¿›è¡Œèº«ä»½è®¤è¯ã€‚ä¾‹å¦‚ï¼Œä¸€ä¸ªåº”ç”¨ç¨‹åºåœ¨ kube-ops ä¸­è¿è¡Œï¼Œåœ¨æ²¡æœ‰ä»»ä½•æ˜¾å¼é…ç½®çš„æƒ…å†µä¸‹ï¼Œè¿™ä¸ªåº”ç”¨ç¨‹åºå°†ä¼šåŠ è½½ default è¿™ä¸ªè´¦å·ã€‚å¦‚æœ default è´¦å·ä¸å­˜åœ¨ï¼Œåˆ™èº«ä»½è®¤è¯å°†ä¼šå¤±è´¥ã€‚\né…ç½®åˆ›å»º åœ¨å‘½åç©ºé—´ä¸­åˆ›å»º ServiceAccount æœ‰ä¸¤ç§æ–¹å¼ï¼Œä¸€ç§æ˜¯é€šè¿‡ kubectl åœ¨å‘½ä»¤è¡Œä¸­åˆ›å»ºã€‚å¦ä¸€ç§åˆ™æ˜¯é€šè¿‡ yaml æ–‡ä»¶è¿›è¡Œå£°æ˜ï¼Œå¹¶é€šè¿‡ apply -f çš„æ–¹å¼åº”ç”¨åˆ° Pod ä¸­ã€‚\nä¾‹å¦‚ï¼Œåœ¨ Prometheus ä¸­ï¼Œè¦è¯·æ±‚ prometheus è®¿é—®æƒé™ï¼Œéœ€è¦åˆ›å»ºä»¥ä¸‹ SeriviceAccount:\n1 2 3 4 5 apiVersion: v1 kind: ServiceAccount metadata: name: prometheus namespace: kube-ops é…ç½®å¼•ç”¨ åˆ›å»ºå®Œ ServiceAccount åï¼Œéœ€è¦æ˜¾ç¤ºåœ°é€šè¿‡ serviceAccountName è¿›è¡ŒæŒ‡å®šï¼Œå¦åˆ™ Kubernetes ä¼šåŠ è½½ default è´¦å·ã€‚ç›¸å…³é…ç½®å¦‚ä¸‹ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 apiVersion: apps/v1 kind: Deployment metadata: name: prometheus namespace: kube-ops spec: selector: matchLabels: app: prometheus template: metadata: labels: app: prometheus spec: serviceAccountName: prometheus containers: - name: prometheus image: prom/prometheus:v2.33.5 command: - \u0026#34;/bin/prometheus\u0026#34; ","permalink":"https://jackcipher.github.io/devops/service-account/","summary":"\u003ch3 id=\"æ¦‚å¿µ\"\u003eæ¦‚å¿µ\u003c/h3\u003e\n\u003cp\u003eKubernetes ä¸­ï¼ŒPod å†…éƒ¨è¿›ç¨‹æƒ³è¦è®¿é—® API Serverï¼Œå°±éœ€è¦ç”¨åˆ° ServiceAccountã€‚ServiceAccount ç±»ä¼¼ä¸šåŠ¡ç³»ç»Ÿé‡Œçš„è´¦æˆ·ï¼Œç”¨äºä¸º Pod æä¾›èº«ä»½ã€‚\u003c/p\u003e","title":"ServiceAccount çš„ä½¿ç”¨"},{"content":"èƒŒæ™¯ PaperMod ä¸»é¢˜é»˜è®¤ä½¿ç”¨çš„æ˜¯ highlight.js, è¿™æ˜¯ä¸€ç§ç”± js ç”Ÿæˆçš„é«˜äº®æ–¹æ¡ˆã€‚ç›¸æ¯” highlight.js, Hugo å®˜æ–¹æ›´å€¾å‘ä½¿ç”¨ Chroma æ¥ç”Ÿæˆä»£ç é«˜äº®ã€‚\nChroma æ˜¯ç”± Go å†™çš„è¯­æ³•é«˜äº®å·¥å…·ï¼Œå…¶ç¼–è¯‘é€Ÿåº¦æ›´å¿«ï¼Œä¸” Hugo å†…ç½®äº† Chroma å·¥å…·ã€‚Hugo å…³äº Chroma çš„æ–‡æ¡£åœ¨ Syntax Highlighting\nç¦ç”¨ Highlight.js highlight.js ä¸ Chroma çš„æ ·å¼æ˜¯å†²çªçš„ã€‚\næŒ‰ç…§ FAQs æåˆ°çš„æ–¹æ¡ˆï¼Œæˆ‘ä»¬é¦–å…ˆéœ€è¦é€šè¿‡ params.assets.disableHLJS ç¦ç”¨ Highlight.js. å…·ä½“é…ç½®ä¸ºï¼š\n1 2 3 params: assets: disableHLJS: true é«˜äº®é…ç½® åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹é¢æ‰¾åˆ°é…ç½®æ–‡ä»¶ config.ymlï¼Œå¢åŠ ä»¥ä¸‹é…ç½®:\n1 2 3 4 5 6 7 markup: highlight: codeFences: true guessSyntax: true lineNos: true noClasses: false style: monokai å…¶ä¸­ï¼ŒlineNosçš„å«ä¹‰ä¸ºæ˜¯å¦æ˜¾ç¤ºè¡Œå·ï¼Œä¸€èˆ¬å»ºè®®å¼€å¯ã€‚noClassesè¿™ä¸ªé…ç½®é¡¹çš„å«ä¹‰å¹¶ä¸é‚£ä¹ˆæ¸…æ™°ï¼Œåœ¨æŸ¥é˜…äº†èµ„æ–™åå¾—çŸ¥ï¼šç”Ÿæˆä»£ç é«˜äº®æœ‰ä¸¤ç§æ–¹å¼ï¼Œä¸€ç§æ˜¯ç›´æ¥åœ¨ä»£ç å—ä¸Šè¿›è¡Œæ ·å¼å†…è”ï¼Œç¬¬äºŒç§å°±æ˜¯åœ¨ä»£ç å—ä¸Šé¢å¢åŠ  CSS ç±»ã€‚è¯¥é…ç½®é¡¹çš„æ„æ€æ˜¯è¯´æ˜¯å¦ä¸ç”Ÿæˆ CSS ç±»ï¼Œå³ç›´æ¥åµŒå¥— CSS å†…è”æ ·å¼ã€‚\næ˜¾ç„¶ï¼Œä½¿ç”¨ CSS ç±»åï¼Œç”Ÿæˆçš„ HTML ä¼šæ›´åŠ ç®€çŸ­ã€ç¾è§‚ã€‚æ‰€ä»¥åœ¨è¿™é‡Œæˆ‘å°±è®¾ç½®ä¸ºäº† false.\nè®¾ç½® false æ„å‘³ç€ï¼Œæœ¬æ¥ä»–åœ¨æŠŠæ ·å¼ç›´æ¥å†™åˆ° HTML ä¸­ï¼Œä½†ä½ å…³é—­äº†è¿™ä¸ªåŠŸèƒ½ï¼Œé‚£ä¹ˆå°±éœ€è¦ä½ è‡ªå·±ç”Ÿæˆä»£ç é«˜äº®çš„æ ·å¼ã€‚\nç”Ÿæˆ CSS ç±» 1 hugo gen chromastyles --style=\u0026#34;dracula\u0026#34; \u0026gt; assets/css/extended/chroma.css é€šè¿‡ hugo gen å‘½ä»¤å¯ä»¥ç”Ÿæˆ Chroma çš„æ ·å¼ï¼Œåœ¨ PaperMod Wiki ä¸­ä¹Ÿæœ‰æåˆ°ï¼Œå‡¡æ˜¯åœ¨ assets/css/extended ä¸‹çš„ css æ–‡ä»¶ï¼Œéƒ½ä¼šè¢«è‡ªåŠ¨åŠ è½½ã€‚å…·ä½“æè¿°å‚è€ƒ FAQs\nHugo æ”¯æŒçš„ä»£ç é«˜äº®æ ·å¼å¯ä»¥[ç‚¹å‡»è¿™é‡Œ](Chroma Style Gallery)\nè¦†ç›–ç³»ç»Ÿæ ·å¼ è‡³æ­¤ï¼ŒChroma çš„æ ·å¼å…¶å®å·²ç»ç”Ÿæˆå¥½äº†ï¼ŒæŒ‰ç†è¯´åº”è¯¥ä¸ä¼šæœ‰é—®é¢˜æ‰å¯¹ã€‚äº‹å®ä¸Šï¼Œè¿™é‡Œæœ‰ä¸€ä¸ªæ¯”è¾ƒå‘çš„åœ°æ–¹åœ¨äºï¼ŒPaperMod å°†ä»£ç å—çš„èƒŒæ™¯é¢œè‰²å†™æ­»äº†ã€‚è¿™æ„å‘³ç€ä¸ç®¡ä½ ä½¿ç”¨ä»€ä¹ˆæ ·å¼çš„é«˜äº®ä»£ç ï¼Œç”Ÿæˆçš„ä»£ç çš„èƒŒæ™¯é¢œè‰²éƒ½ä¼šè¢«ç³»ç»Ÿé…ç½®æ‰€è¦†ç›–ã€‚\nä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬éœ€è¦ unset æ‰ hljs-bg è¿™ä¸ªå˜é‡ã€‚\nåœ¨ assets/css/extend/custom.css ä¸­æ·»åŠ ä»¥ä¸‹æ ·å¼ï¼š\n1 2 3 4 5 6 :root { --hljs-bg: unset; } .dark { --hljs-bg: unset; } è¿™æ ·ç³»ç»Ÿé»˜è®¤çš„æ ·å¼å°±è¢«æ¸…ç†æ‰ï¼Œé¡µé¢ä¸Šæ˜¾ç¤ºçš„å°±æ˜¯é€šè¿‡ hugo genç”Ÿæˆçš„é…è‰²ã€‚\n","permalink":"https://jackcipher.github.io/posts/papermod-highlight/","summary":"\u003ch3 id=\"èƒŒæ™¯\"\u003eèƒŒæ™¯\u003c/h3\u003e\n\u003cp\u003ePaperMod ä¸»é¢˜é»˜è®¤ä½¿ç”¨çš„æ˜¯ highlight.js, è¿™æ˜¯ä¸€ç§ç”± js ç”Ÿæˆçš„é«˜äº®æ–¹æ¡ˆã€‚ç›¸æ¯” highlight.js, Hugo å®˜æ–¹æ›´å€¾å‘ä½¿ç”¨ \u003ca href=\"https://github.com/alecthomas/chroma\"\u003eChroma\u003c/a\u003e æ¥ç”Ÿæˆä»£ç é«˜äº®ã€‚\u003c/p\u003e\n\u003cp\u003eChroma æ˜¯ç”± Go å†™çš„è¯­æ³•é«˜äº®å·¥å…·ï¼Œå…¶ç¼–è¯‘é€Ÿåº¦æ›´å¿«ï¼Œä¸” Hugo å†…ç½®äº† Chroma å·¥å…·ã€‚Hugo å…³äº Chroma çš„æ–‡æ¡£åœ¨ \u003ca href=\"https://gohugo.io/content-management/syntax-highlighting/\"\u003eSyntax Highlighting\u003c/a\u003e\u003c/p\u003e","title":"PaperMod ä¸»é¢˜ä¸‹ä»£ç é«˜äº®æœ€ä½³å®è·µ"},{"content":"èƒŒæ™¯ åœ¨æ”¶é›†æœåŠ¡ç«¯èŠå¤©æ¶ˆæ¯æ—¥å¿—æ—¶ï¼Œç”¨åˆ°äº† Filebeat dissect è¯­æ³•ï¼Œè€Œè¿™ä¸ªè¯­æ³•æ˜¯ Filebeat 6.4 åŠä¹‹åçš„ç‰ˆæœ¬æ”¯æŒã€‚æœåŠ¡ç«¯éƒ¨åˆ†æœºå™¨çš„ Filebeat ç‰ˆæœ¬ä¸º 6.3\nè€ƒè™‘åˆ°æ—¥å¿—æ”¶é›†å·¥ä½œçš„æ™®éæ€§ï¼Œä¸ºäº†ä¿æŒç‰ˆæœ¬ç»Ÿä¸€å‡å°‘è¿ç»´æˆæœ¬ï¼Œç‰¹å¢åŠ ä¸€ç§åŸºäº Docker å®ç°çš„é€šç”¨ Filebeat æ—¥å¿—æ”¶é›†æ–¹æ¡ˆã€‚\nç›®å½•ç»“æ„ æœ€ä½³å®è·µ å»ºè®®å°† docker-compose æ–‡ä»¶å­˜æ”¾è‡³ /apps/srv/filebeat_xxx ç›®å½•ä¸­ã€‚ å¦‚æœæœ‰å…¶ä»–ä¹ æƒ¯ç”¨æ³•ï¼Œä¹Ÿå¯ä»¥æ”¾è‡³å…¶ä»–åœ°æ–¹ï¼Œæ€»çš„åŸåˆ™æ˜¯å°½é‡æ”¾åˆ°ä¸€ä¸ªçˆ¶ç›®å½•ï¼Œæ–¹ä¾¿ç®¡ç†ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 â”œâ”€â”€ data (è‡ªåŠ¨ç”Ÿæˆ) â”‚Â â”œâ”€â”€ meta.json â”‚Â â””â”€â”€ registry â”œâ”€â”€ docker-compose.yml (å¿…é¡») â”œâ”€â”€ Filebeat.yml (å¿…é¡») â”œâ”€â”€ inputs.d (å¿…é¡») â”‚Â â”œâ”€â”€ chat_history_20220111.yml (å¿…é¡», è§†ä¸šåŠ¡æƒ…å†µè€Œå®š) â”‚Â â”œâ”€â”€ chat_history.yml.template (å¯é€‰) â”‚Â â””â”€â”€ history (å¯é€‰) â”‚Â â”œâ”€â”€ chat_history_20211224.yml â”‚Â â”œâ”€â”€ chat_history_20211225.yml â””â”€â”€ log (è‡ªåŠ¨ç”Ÿæˆ) docker-compose é…ç½® 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 version: \u0026#34;2\u0026#34; services: filebeat7: image: harbor.baijiayun.com/elk/filebeat_7.5.0:latest container_name: \u0026#34;Filebeat-chat\u0026#34; restart: always user: root volumes: # Filebeat åœ¨å®¹å™¨ä¸­é»˜è®¤è¯»å– /usr/share/Filebeat/Filebeat.yml - ./Filebeat.yml:/usr/share/Filebeat/Filebeat.yml # å…·ä½“çš„é…ç½®æ–‡ä»¶å¤¹ ç±»ä¼¼ Nginx çš„ conf.d - ./inputs.d:/usr/share/Filebeat/inputs.d # Filebeat é»˜è®¤æ—¥å¿—è¾“å‡ºç›®å½• - ./log:/opt # registry ç­‰æ ¸å¿ƒæ•°æ® - ./data:/usr/share/Filebeat/data # â­ï¸ éœ€è¦æ”¶é›†çš„ä¸šåŠ¡æ—¥å¿—ç›®å½•ï¼Œæ ¹æ®ä¸šåŠ¡æƒ…å†µè°ƒæ•´ - /mydata:/mydata - /this/is/a/deep/path:/this/is/a/deep/path æœ€ä½³å®è·µ åœ¨ä¸Šè¿° docker-compose ä¸­ï¼Œå‰é¢éƒ¨åˆ†æ˜ å°„çš„ç›®å½•å¯ä»¥ä¿æŒä¸å˜ï¼Œæœ€åéœ€è¦æ”¶é›†çš„ä¸šåŠ¡æ—¥å¿—æ ¹æ®ä¸šåŠ¡æƒ…å†µè°ƒæ•´ã€‚è¯·æ³¨æ„ï¼Œæœ€åéœ€è¦æ”¶é›†çš„ä¸šåŠ¡æ—¥å¿—, å°½é‡æ˜ å°„åˆ°ç›¸åŒçš„ä½ç½®ï¼Œå¦‚ /this/is/a/deep/path æ˜ å°„åˆ°å®¹å™¨æ—¶ä¹Ÿè¦ä¿æŒè¯¥ç›®å½•å±‚çº§ï¼Œæ–¹ä¾¿åç»­é—®é¢˜æ’æŸ¥ã€‚\né…ç½®æ–‡ä»¶ cat /apps/srv/filebeat_chat/inputs.d/chat_history_20220111.yml æœ¬æ¡ˆä¾‹ä¸­çš„é…ç½®æ–‡ä»¶ç”±æ¨¡ç‰ˆäº§ç”Ÿ\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 - enabled: true type: log ignore_older: 24h fields_under_root: true json.add_error_key: true json.keys_under_root: true paths: - /mydata/chatHistory/20220111/*.txt tail_files: false fields: special_env: \u0026#34;latest\u0026#34; logtype: \u0026#34;chat-message\u0026#34; processors: - dissect: tokenizer: \u0026#34;/mydata/chatHistory/%{date}/%{rnum}.txt\u0026#34; field: \u0026#34;log.file.path\u0026#34; target_prefix: \u0026#34;\u0026#34; æ¨¡ç‰ˆæ–‡ä»¶(optional) èŠå¤©æ¶ˆæ¯æ—¥å¿—æ–‡ä»¶è¾ƒå¤šï¼Œå¦‚æœå…¨ç›˜æ‹›æ”¶ï¼Œä¼šå ç”¨è¾ƒå¤§çš„ CPUã€å†…å­˜èµ„æºã€‚\nèŠå¤©æ¶ˆæ¯æ¯å¤©éƒ½ä¼šæ›´æ–°ï¼Œæ ¹æ®è¿™ä¸ªç‰¹æ€§ï¼Œæˆ‘ä»¬ä½¿ç”¨äº†æ¨¡ç‰ˆæ–‡ä»¶ï¼Œæ¯å¤©é€šè¿‡å®šæ—¶ä»»åŠ¡ä»æ¨¡ç‰ˆä¸­ç”Ÿæˆæ–°çš„é…ç½®æ–‡ä»¶ï¼Œå¹¶å°†å†å²çš„é…ç½®æ–‡ä»¶ç§»å‡º inputs.d ç›®å½•ã€‚\næ¨¡ç‰ˆæ–‡ä»¶å¦‚ä¸‹\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 - enabled: true type: log ignore_older: 24h fields_under_root: true json.add_error_key: true json.keys_under_root: true paths: - /mydata/chatHistory/{DATE}/*.txt tail_files: false fields: special_env: \u0026#34;latest\u0026#34; logtype: \u0026#34;chat-message\u0026#34; processors: - dissect: tokenizer: \u0026#34;/mydata/chatHistory/%{date}/%{rnum}.txt\u0026#34; field: \u0026#34;log.file.path\u0026#34; target_prefix: \u0026#34;\u0026#34; å®šæ—¶ä»»åŠ¡(optional) cat /apps/scripts/generate_chat_filebeat_config.sh\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 #!/bin/bash #ç”Ÿæˆæ–°æ–‡ä»¶ today=$(date +\u0026#34;%Y%m%d\u0026#34;) yesterday=$(date -d \u0026#34;yesterday\u0026#34; +\u0026#34;%Y%m%d\u0026#34;) cd /apps/srv/filebeat_chat/inputs.d #çœ‹å½“æ—¥çš„èŠå¤©é…ç½®æ–‡ä»¶æ˜¯å¦å·²ç»å­˜åœ¨ #test -f \u0026#34;user_report_$today.yml\u0026#34; || cat user_report.yml.template | sed \u0026#34;s/{DATE}/$today/\u0026#34; \u0026gt; user_report_$today.yml test -f \u0026#34;chat_history_$today.yml\u0026#34; || cat chat_history.yml.template | sed \u0026#34;s/{DATE}/$today/\u0026#34; \u0026gt; chat_history_$today.yml #ç§»é™¤æ˜¨å¤©çš„ #test -f user_report_$yesterday.yml \u0026amp;\u0026amp; mv user_report_$yesterday.yml ./history/ test -f chat_history_$yesterday.yml \u0026amp;\u0026amp; mv chat_history_$yesterday.yml ./history/ é…ç½®å®šæ—¶ä»»åŠ¡è§„åˆ™\n1 15 0 * * * sh /apps/scripts/generate_chat_filebeat_config.sh \u0026amp;\u0026gt;\u0026gt; /tmp/generate_chat_filebeat_config.log ","permalink":"https://jackcipher.github.io/devops/docker-filebeat/","summary":"\u003ch2 id=\"èƒŒæ™¯\"\u003eèƒŒæ™¯\u003c/h2\u003e\n\u003cp\u003eåœ¨æ”¶é›†æœåŠ¡ç«¯èŠå¤©æ¶ˆæ¯æ—¥å¿—æ—¶ï¼Œç”¨åˆ°äº† Filebeat \u003ca href=\"https://www.elastic.co/guide/en/beats/filebeat/current/dissect.html\"\u003edissect\u003c/a\u003e è¯­æ³•ï¼Œè€Œè¿™ä¸ªè¯­æ³•æ˜¯ Filebeat 6.4 åŠä¹‹åçš„ç‰ˆæœ¬æ”¯æŒã€‚æœåŠ¡ç«¯éƒ¨åˆ†æœºå™¨çš„ Filebeat ç‰ˆæœ¬ä¸º 6.3\u003c/p\u003e\n\u003cp\u003eè€ƒè™‘åˆ°æ—¥å¿—æ”¶é›†å·¥ä½œçš„æ™®éæ€§ï¼Œä¸ºäº†ä¿æŒç‰ˆæœ¬ç»Ÿä¸€å‡å°‘è¿ç»´æˆæœ¬ï¼Œç‰¹å¢åŠ ä¸€ç§åŸºäº Docker å®ç°çš„é€šç”¨ Filebeat æ—¥å¿—æ”¶é›†æ–¹æ¡ˆã€‚\u003c/p\u003e","title":"Docker ä¸‹ Filebeat æ—¥å¿—æ”¶é›†"},{"content":"About Me Hi, I am Jack.\nI am a software engineer passionate about \u0026hellip;\nInterests: Coding, Reading, traveling. Tech Stack: Go, Python, React. Contact Email GitHub ","permalink":"https://jackcipher.github.io/about/","summary":"about","title":"About"}]