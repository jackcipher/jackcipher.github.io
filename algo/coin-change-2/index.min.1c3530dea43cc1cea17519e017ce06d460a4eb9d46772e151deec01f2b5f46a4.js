(function(){const t=document.getElementById("algo-coin-change-2");if(!t)return;const d=t.querySelector("#coin-denominations"),a=t.querySelector("#coin-amount"),c=t.querySelector("#coin-start"),u=t.querySelector("#coin-reset"),s=t.querySelector("#coin-status"),o=t.querySelector("#coin-explanation"),l=t.querySelector("#dp-header-row"),i=t.querySelector("#dp-body");let n=[],r=[],e=0;function h(){const n=d.value.split(/[,，\s]+/).map(e=>parseInt(e.trim())).filter(e=>!(e!=e)&&e>0),t=parseInt(a.value);return n.length===0||t!=t||t<=0?(alert("请输入有效的硬币面额和正整数金额。"),!1):(r=n,e=Math.min(t,20),a.value=e,!0)}function m(){l.innerHTML="<th>Coin \\ Amount</th>";for(let t=0;t<=e;t++){const n=document.createElement("th");n.textContent=t,l.appendChild(n)}i.innerHTML="",n=new Array(e+1).fill(0),n[0]=1;const t=document.createElement("tr");t.innerHTML="<td><strong>Initial</strong></td>";for(let s=0;s<=e;s++){const o=document.createElement("td");o.textContent=n[s],o.className="dp-cell-initial-"+s,t.appendChild(o)}i.appendChild(t)}async function f(){if(!h())return;c.disabled=!0,d.disabled=!0,a.disabled=!0,m(),s.textContent="初始化：dp[0] = 1 (金额为0有一种凑法：全不选)",await new Promise(e=>setTimeout(e,1e3));let t=[...n];for(let l=0;l<r.length;l++){const a=r[l],d=document.createElement("tr");d.innerHTML=`<td><strong>Coin: ${a}</strong></td>`;const c=[];for(let n=0;n<=e;n++){const s=document.createElement("td");s.textContent=t[n],d.appendChild(s),c.push(s)}i.appendChild(d),s.textContent=`Processing Coin: ${a}`,o.textContent=`遍历每个金额 j (从 ${a} 到 ${e})，累加 dp[j - ${a}] 到 dp[j]`,await new Promise(e=>setTimeout(e,1e3));for(let n=a;n<=e;n++){const r=t[n],i=n-a,l=t[i];c[n].classList.add("target-cell"),c[i].classList.add("source-cell");const d=r+l;s.textContent=`j = ${n}, coin = ${a}`,o.innerHTML=`
                    计算 dp[${n}]: <br>
                    不选硬币${a}：保持旧值 ${r}<br>
                    选一枚硬币${a}：剩余金额 ${n-a} 的方案数是 ${l} (dp[${i}])<br>
                    <strong>新值 = ${r} + ${l} = ${d}</strong>
                `,await new Promise(e=>setTimeout(e,1200)),t[n]=d,c[n].textContent=d,c[n].classList.add("cell-updated"),await new Promise(e=>setTimeout(e,800)),c[n].classList.remove("target-cell","cell-updated"),c[i].classList.remove("source-cell")}n=t}s.textContent="计算完成！",o.textContent=`最终答案：使用硬币 [${r}] 凑出金额 ${e} 的组合数为 ${n[e]}。`,c.disabled=!1,d.disabled=!1,a.disabled=!1}c.addEventListener("click",f),u.addEventListener("click",()=>{i.innerHTML="",l.innerHTML="",s.textContent="已重置",o.textContent=""})})()